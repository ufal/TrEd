<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN" "http://www.oasis-open.org/docbook/xml/4.4/docbookx.dtd">
<?xml-stylesheet href="docbook-css-0.4/driver.css" type="text/css"?>
<article lang="en">
  <articleinfo>
    <title>TrEd User's Manual</title>
    <author>
      <firstname>Petr</firstname>
      <surname>Pajas</surname>
      <affiliation>
	<address format="linespecific"><email>pajas@ckl.mff.cuni.cz</email></address>
      </affiliation>
    </author>
  </articleinfo>
  <section id="intro">
    <title>Introduction</title> <para><application moreinfo="none">TrEd</application> is a fully customizable and
      programmable graphical editor and viewer of tree-like structures
      such as dependency trees.  Among other projects, it was used as
      the main annotation tool for syntactical and tectogrammatical
      annotations of 
      <ulink url="http://shadow.ms.mff.cuni.cz/pdt/index.html">The Prague Dependency Treebank</ulink>, as well as for
      decision-tree based morphological annotation of
      <ulink url="http://ckl.mff.cuni.cz/padt/">The Prague Arabic Dependency Treebank</ulink>.
    </para>
    <para>
      TrEd provides various ways to customize the tree layout and
      appearance. It's functionality may be further extended by
      user-defined macros (small program subroutines written in Perl)
      associated with keyboard shortcuts and/or menu items. TrEd also
      provides wide range of pre-defined macros, which greatly
      simplifies writing new macros. By writing a suitable set of
      macros, TrEd may be easily turned from a general-purpose software
      into a specialized tool for a particular purpose.
    </para>
    <para>
      TrEd supports various input and output formats. Some of them
      are of general nature (one of them is <ulink url="http://ufal.mff.cuni.cz/pdt/Corpora/PDT_1.0/Doc/fs.html">FS-format</ulink>
      developed by Michal Kren and sufficient enough for most purposes),
      while other are bound to a particular project. Support for other
      formats can be added by writing a custom I/O Backend (a Perl
      module able to convert data from their format-specific
      representation into the internal representation used by TrEd,
      and save them back in the original format).
    </para>
    <para>There is also a non-graphical (off-line) variant of TrEd,
      usefull for batch processing of tree-like data. It is called
      <command moreinfo="none">btred</command> &#8212;
      <quote>Batch-mode Tree Editor</quote> and allows users to apply
      TrEd macros on trees without having to enter the graphical
      interface.  This tool is further acompanied by another tool,
      named <command moreinfo="none">ntred</command>. NTrEd allows for parallelizing
      btred processing over a cluster of networked machines.  In
      combination with TrEd, it can also be used as an extremely
      powerful search engine over large base of data.
    </para>
    <figure float="0">
      <title>TrEd's main window with two views highly customized for
	visual comparison of trees of the Prague Dependency Treebank
	project.
      </title>
      <mediaobject>
	<imageobject>
	  <imagedata fileref="pics/treddiff.png" format="PNG" role="html"/>
	</imageobject>
	<imageobject>
	  <imagedata fileref="pics/treddiff.eps" format="EPS" role="latex" width="13cm"/>
	</imageobject>
	<imageobject>
	  <imagedata fileref="pics/treddiff" format="linespecific"/>
	</imageobject>
      </mediaobject>
    </figure>
    <para>
      <application moreinfo="none">TrEd</application> runs on the following platforms (see <xref linkend="installation"/> for details):
    </para>
    <orderedlist continuation="restarts" inheritnum="ignore">
      <listitem>
	<para><productname class="trade">Windows 95/98/ME</productname> or
	<productname class="trade">Windows NT/2000/XP</productname></para></listitem>
      <listitem>
	<para><productname class="trade">Linux</productname></para></listitem>
      <listitem>
	<para>
	    <productname class="trade">MacOS X</productname> (X11),
	    <productname class="trade">BSD</productname>,
	    <productname class="trade">UNIX</productname>,
	    <productname class="trade">Solaris</productname> and other UNIX-based systems
									     </para>
    </listitem>
    </orderedlist>
  </section>
  <section id="installation">
    <title>Installation and start up instructions</title>    
    <para>
      On all supported platforms, <application moreinfo="none">TrEd</application> requires a Perl language
      interpreter, the Perl-Tk module (a GUI library for Perl), and
      depending on the I/O Backends used also various XML related
      modules. Installation of all these tools differs on Unix-like
      and Windows platforms.
    </para>
    <para>
      To install TrEd on your system follow the instructions specific
      for your platform below:
    </para>
    <section id="install-windows">
      <title>Windows</title>
      <section>
	<title>Step 1: installation of <application>ActivePerl for Windows</application></title>
      <para>
	<application>TrEd</application> for Windows requires
	<ulink url="http://www.activestate.com/Products/ActivePerl/">ActivePerl</ulink>.
	Due to its re-distribution restrictions, the tool cannot be 
	bundled with <application>TrEd</application> and you have to
	download and install it separately from:
      </para>
      <itemizedlist>
	<listitem>
	  <para><ulink url="http://www.activestate.com/Products/Download/Download.plex?id=ActivePerl">http://www.activestate.com/Products/Download/Download.plex?id=ActivePerl</ulink></para>
	</listitem>
      </itemizedlist>
      </section>
      <section>
	<title>Step 2: installation of <application>TrEd</application></title>
	<para>
	  To finish the installation, obtain an up-to-date
	  windows-specific installation package from <ulink
	  url="http://pajas.matfyz.cz/tred">the project's
	  homepage</ulink>.  This single package contains
	  <application>TrEd</application> as well as all required Perl
	  modules.  Unzip the installation package if necessary, run
	  <command moreinfo="none">setup.bat</command>, and follow the
	  instructions in the command-shell window (you may safely
	  ignore the very first message which asks you about creating
	  <filename moreinfo="none">/tmp</filename> directory).
	</para>
	<note role="PDT20">
	  <para>
	    If you have the <productname class="trade">Prague Dependency Treebank 2.0</productname> CD-ROM, you may
	    start the installation directly from the CD-ROM
	    by clicking <command moreinfo="none">setup.bat</command> in the
	    <filename moreinfo="none">tools/tred/setup</filename> directory.
	  </para>
	</note>
	<para>
	  The installation is
	  completely text-based and you will mostly be confronted with
	  only simple yes/no questions. The setup script will
	  safely guide you through the following steps:
	</para>
	<orderedlist inheritnum="ignore" continuation="restarts">
	<listitem>
	  <para>
	    Checking if a suitable version ActivePerl is available on your
	    system.
	  </para>
	</listitem>
	  <!--
	<listitem>
	  <para>
	    Starting the ActivePerl installer if no suitable Perl
	    installation was found.
	  </para>
	</listitem>
	  -->
	<listitem>
	  <para>
	    Installing all necessary Perl modules using the ActiveState's
	    PPM packaging system.
	  </para>
	</listitem>
	<listitem>
	  <para>
	    Detecting if TrEd is already installed on your system and
	    offering either an upgrade or a completely new
	    installation in a directory you select.
	  </para>
	</listitem>
	<listitem>
	  <para>
	    Creating a data directory where you can place your
	    TrEd-specific data files (this is optional).
	  </para>
	</listitem>
	<listitem>
	  <para>
	    Creating a desktop and Start Menu shortcuts for TrEd.
	  </para>
	</listitem>
      </orderedlist>
      <warning>
	<para>
	  Although the TrEd setup program is CygWin-based, it is not
	  recommended to run TrEd with the CygWin Perl (it is of
	  course possible to use both TrEd+ActivePerl and CygWin
	  separately on a single machine). The reason si firstly
	  because this setup is not being tested and secondly because
	  Perl/Tk for CygWin Perl requires CygWin XFree86 and
	  according to author's opinion these don't play togheter well
	  yet. It is therefore recommended that you install
	  ActiveState Perl, even if you already have a Perl installation
	  in CygWin. If you really must try running TrEd in CygWin,
	  follow the instructions for setup on <link linkend="install-unix">UNIX-like systems</link>
	  (but you have been warned).
	</para>
      </warning>
      </section>
    </section>
    <section id="install-unix">
      <title>Linux and UNIX-based systems</title>
      <para>
	Almost every today's <application moreinfo="none">UNIX/Linux</application> system contains a
	<application moreinfo="none">Perl</application> installation,
	so we expect that you already have a working <application moreinfo="none">Perl</application> setup (version &gt;= 5.8.2 is
	recommended). 
      </para>
      <para>
	<application moreinfo="none">TrEd</application> further requires the following Perl
	modules and their dependencies:
	<itemizedlist>
	  <listitem><simpara><literal>File-Temp</literal></simpara></listitem>
	  <listitem><simpara><literal>File-Spec</literal></simpara></listitem>
	  <listitem><simpara><literal>Text-Iconv</literal></simpara></listitem>
	  <listitem><simpara><literal>Tie-IxHash</literal></simpara></listitem>
	  <listitem><simpara><literal>Tk</literal> (for GUI)</simpara></listitem>
	  <listitem><simpara><literal>Compress-Zlib</literal> (for printing to PDF)</simpara></listitem>
	  <listitem><simpara><literal>XML-LibXML</literal> (for various I/O backends)</simpara></listitem>
	  <listitem><simpara><literal>XML-Simple</literal></simpara></listitem>	  
	  <listitem><simpara><literal>XML-Writer</literal></simpara></listitem>
	</itemizedlist>
	All the above modules and their dependencies can be obtained
	and installed in a single step using the
	<command moreinfo="none">./install</command> script of the <ulink url="http://ckl.mff.cuni.cz/pajas/tred/tred-dep-unix.tar.gz">tred-dep-unix.tar.gz</ulink>
	package as described below.
	<note role="PDT20">
	  <para>
	    If you have the <productname class="trade">Prague
	      Dependency Treebank 2.0</productname> CD-ROM, you may
	    start the installation of these modules directly from
	    the CD-ROM by running <command moreinfo="none">./install</command> in
	    the <filename moreinfo="none">tools/tred/unix_packages</filename>
	    directory. In this case you may skip steps
	    1. and 2.
	  </para>
	</note>
      </para>
      <orderedlist continuation="restarts" inheritnum="ignore">
	<listitem>
	  <para>
	    Fetch the  <ulink url="http://ckl.mff.cuni.cz/pajas/tred/tred-dep-unix.tar.gz">tred-dep-unix.tar.gz</ulink>
	    package</para>
	</listitem>
	<listitem>
	  <para>
	    Unzip the package with
	    <programlisting format="linespecific">$ <userinput moreinfo="none">tar xzvf tred-dep-unix.tar.gz</userinput></programlisting>
	  </para>
	  <para>
	    Change to the <literal moreinfo="none">tred-dep-unix</literal> directory:
	    <programlisting format="linespecific">$ <userinput moreinfo="none">cd tred-dep-unix</userinput></programlisting>
	  </para>
	</listitem>
	<listitem>
	  <para>
	    If you have a root account on the machine, switch to it, e.g.
	    by issuing
	    <programlisting format="linespecific">$ <userinput moreinfo="none">su root</userinput>
Password:
</programlisting>

	    If not, you may continue, but read carefully the following
	    step.
	  </para>
	</listitem>
	<listitem>
	  <para>
	    Run the module installation script (you'll need a
	    functional C compiler, <literal moreinfo="none">make</literal>, etc., e.g. tools
	    available on most Linux/UNIX setups):

	    <programlisting format="linespecific">$ <userinput moreinfo="none">./install</userinput></programlisting>


	    This scripts compiles and installs all required modules to the
	    directory prefix where the Perl installation resides. If
	    you'd like to use a different prefix (e.g. because you
	    don't have root permissions on the box), use
	    
	    <programlisting format="linespecific">$ <userinput moreinfo="none">./install --prefix=<replaceable>directory-prefix</replaceable></userinput></programlisting>

	    and ensure the environment variable settings suggested by
	    the installation script at the end of the installation.
	    You can review all options of the installation script with
	    <command moreinfo="none">./install --help</command>.
	  </para>
	</listitem>
 	<listitem>
 	  <para>
	    The last few and steps describe the installation of
	    <application moreinfo="none">TrEd</application> itself.
	    Start by fetching the latest <application moreinfo="none">TrEd</application>
	    distribution package <ulink url="http://ckl.mff.cuni.cz/pajas/tred/tred-current.tar.gz">tred-current.tar.gz</ulink>,
	    unpack the package it using
	    <programlisting format="linespecific">$ <userinput moreinfo="none">tar xzvf tred-current.tar.gz</userinput></programlisting>
	    and copy the resulting <filename moreinfo="none">tred</filename> directory
	    to a suitable locatoin on your system, e.g. with
	    <programlisting format="linespecific">$ <userinput moreinfo="none">cp -R tred /opt</userinput></programlisting>
	    or 
	    <programlisting format="linespecific">$ <userinput moreinfo="none">cp -R tred /home/<replaceable>yourname</replaceable></userinput></programlisting>
	    <note role="PDT20">
	      <para>
		If you have the <productname class="trade">Prague
		  Dependency Treebank 2.0</productname> CD-ROM, you'll find the
		unpacked installation package in the directory
		<filename moreinfo="none">tools/tred/tred</filename>
		on the CD-ROM.
	      </para>
	    </note>
	    Finally, create symlinks to <command moreinfo="none">tred</command>,
	    <command moreinfo="none">btred</command>, and <command moreinfo="none">ntred</command>
	    executables from the destination directory you have chosen to
	    some directory in your path, e.g.
	    <programlisting format="linespecific">$ <userinput moreinfo="none">ln -s <replaceable>/opt/tred</replaceable>/*tred <replaceable>/usr/local/bin</replaceable> </userinput></programlisting>
 	  </para>
	</listitem>
	<listitem>
	  <para>
	    Check your installation with:
	    <programlisting format="linespecific">$ <userinput moreinfo="none">tred -v</userinput>
TrEd Id: tred,v 1.337 2005/04/13 18:17:08 pajas Exp
Perl: 5.008002
Platform: linux
Tk: 804.027
</programlisting>
	    If you get a similar output, you have successfully installed <application moreinfo="none">TrEd</application> 
	    on your system.
	  </para>
	  <note>
 	    <para>
	      Unfortunatelly, another commonly used package contains
	      an executable named <command moreinfo="none">tred</command>, namely the
	      <application moreinfo="none">GraphViz</application> package by AT&amp;T.
	      Although we think we used the name first, we do not see
	      much reason in arguing with them about renaming
	      their program to something else. If you are affected
	      by this name collision, simply rename one of the
	      executables (either the one of
	      <application moreinfo="none">TrEd</application> of the one of
	      <application moreinfo="none">GraphViz</application>) to something else.
 	    </para>
 	  </note>
	  <note>
	    <para>If the <command moreinfo="none">tred</command>
	      executable fails to start at all, try changing the first line
	      (<command moreinfo="none">#!/usr/bin/env perl</command>) so
	      that it points directly to your Perl executable. 
	      If you find <application moreinfo="none">TrEd</application> halting immediately,
	      complaining about not finding <filename moreinfo="none">Tk.pm</filename> or some
	      other Perl module, make sure that the installation went fluently.
	      You may also try to setup the environment variable <varname>PERLLIB</varname>
	      to point to the directory/directories where the modules
	      were installed.
	    </para>
	  </note>
	</listitem>
      </orderedlist>
    </section>
  </section>
  <section id="terminology">
    <title>Basic concepts and terminology</title>
    <para>In this section we list and describe several concepts often used in this
      manual without a further reference.</para>
    <variablelist>
      <varlistentry>
	<term>file</term>
	<listitem>
	  <para>Files is a collections of trees (possibly acompanied with some
	    meta data common to all trees). Although the in-memory
	    representation of a file has always the same form,
	    its <quote>physical representation</quote>  (called
	    <firstterm>format</firstterm>) may vary. 
	    The part of <application>TrEd</application> program
	    responsible for reading and writing files in a specific
	    format is called a <firstterm>I/O Backend</firstterm>.
	    Depending on a format, files may differ in some features.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>I/O backend</term>
	<listitem>
	  <para>
	    <firstterm>I/O backend</firstterm> is a module
	    of <application>TrEd</application> responsible for
	    reading and writing files in some particular data format.
	    Thus, adding support for a new data format only requires
	    writing a corresponding I/O backend.
	    Different data formats not only represent the data (trees, nodes,
	    meta data) differently, but often differ in the ability
	    to interchange data with other I/O backends because of
	    the nature of the data. For example, while some I/O backends
	    are rather generic, other are tightly bound to the actual
	    content of the data (hence loading a file using one I/O backend and
	    saving it in another may not work as expected in all cases). 
	    Nonetheless, most of the
	    I/O backends used in <application>TrEd</application>
	    are able to read the data and save them back without
	    any loss of information. Detailed discussion of
	    I/O backends can be found in <xref linkend="backends"/>.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>tree</term>
	<listitem>
	  <para>
	    A trees in this context is a rooted oriented cycle-free graph of nodes.
	    In other words: it is a finite ordered set of objects called nodes (sometimes, but
	    not in this manual, also called <firstterm>verteces</firstterm>),  
	    each of the nodes but one is connected to another node
	    called it's <firstterm>parent</firstterm>-node. This connection
	    is called an <firstterm>edge</firstterm>. Such a structure is then called a tree if edges
	    never form a cycle, i.e.
	    by following an edge-path (e.g. a sequence of adjacent edges
	    leading from a node to its parent-node) we
	    never return to the node where we
	    started. There is exactly one node without a parent-node,
	    called the <firstterm>root</firstterm> of the tree.
	    Every edge-path in the tree leads to this node.
	    If <replaceable>A</replaceable> is a parent-node of
	    <replaceable>B</replaceable>, then 
	    <replaceable>B</replaceable> is a <firstterm>child-node</firstterm>
	    of <replaceable>A</replaceable>. Nodes having the same
	    node as their parent-node are called <firstterm>siblings</firstterm>.
	    In <application>TrEd</application>'s internal
	    representation of a tree, there are the following additional
	    links between nodes:
	    <itemizedlist>
	      <listitem>
		<para>
		  a link from a parent-node to one of its child-nodes (usually but not necessarily this is the
		  first of its child-nodes in the linear ordering
		  of the tree). This child-node is called the
		  <firstterm>first-son</firstterm> of the parent-node.</para>
	      </listitem>
	      <listitem>
		<para>
		  First son is linked with its next sibling (if any),
		  called it's right-sibling node (or <firstterm>lbrother</firstterm>).
		  This sibling is again connected to another
		  sibling, etc, so that all siblings are connected and
		  this connection contains no cycle.
		  Hence child-nodes of each node form a (possibly empty) chain
		  originating on the first-son and connecting all its
		  siblings one after another. The last sibling in the chain
		  is called the <firstterm>last-sibling</firstterm> or
		  <firstterm>last-son</firstterm>.
		</para>
	      </listitem>
	      <listitem>
		<para>
		  For easier tree traversal, nodes in
		  <application>TrEd</application>
		  also contain link representing a reversed version of the
		  previous <quote>right-sibling</quote> relation,
		  called left-sibling (or <firstterm>lbrother</firstterm>).
		  So, if a node <replaceable>A</replaceable> is the
		  right-sibling of <replaceable>B</replaceable>, then
		  <replaceable>B</replaceable> is the
		  left-sibling of <replaceable>A</replaceable>.
		</para>
	      </listitem>
	    </itemizedlist>
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>node</term>
	<listitem>
	  <para>
	    We have already describe a node as an object occuring in a tree and
	    possibly connected to other nodes in the tree. Apart from that,
	    every node may be associated with some data represented in form of
	    an <firstterm>attribute-value structure</firstterm> (AVS or
	    feature-structure if you like). Each members of this structure
	    (also called an attribute) has a name and value. Each name
	    may occure in AVS only once. The names of node's attributes and types
	    of their values are file-specific (or in some cases I/O-backend
	    specific). Generally, a value of an
	    attribute may be of one of the following types (it must be noted that
	    not all of the types are supported by the I/O backends equally):
	    <itemizedlist>
	      <listitem>
		<para>string</para></listitem>
	      <listitem>
		<para>enumerated type (a string value from a pre-defined
		  list)</para></listitem>
	      <listitem>
		<para><quote>flat</quote> list of values of one of the above types,
		  i.e. a string of <literal>|</literal>-separated items.
		  This type is used e.g. by FS-backend. 
		</para>
	      </listitem>
	      <listitem>
		<para>constant (usually not very useful, but sometimes handy)</para>
	      </listitem>
	      <listitem>
		<para>attribute-value stucture (implemented as a Perl hash reference,
		  fully supported by PML-backend and
		  partially emulated by FS-backend)</para>
	      </listitem>
	      <listitem>
		<para>ordered list of values of any type except list
		  (implemented as a Perl array reference of the
		  <literal>Fslib::List</literal> class). Currently
		  only supported by PML-backend.
		</para>
	      </listitem>
	      <listitem>
		<para>unordered list of values of any type except list
		  (implemented and supported likewise).
		</para>
	      </listitem>
	      <listitem>
		<para>alternative of values of any type except alternative
		  (implemented as a Perl array reference of the
		  <literal>Fslib::Alt</literal> class).
		  Alternative is very similar to unordered list but as long
		  as it has only one single value,
		  it is represented by that value (rather
		  than a <literal>Fslib::Alt</literal> array reference containing that value).
		  Alternatives are currently supported by PML-backend.
		</para>
	      </listitem>
	    </itemizedlist>
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>file-list</term>
	<listitem>
	  <para>Files in <application>TrEd</application> are further
	    organized into collections called
	    <firstterm>file-lists</firstterm>.
	    A file-list is basically a list of filenames of files
	    belonging to the collection.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>view</term>
	<listitem>
	  <para>
	    A view is the part of <application>TrEd</application> window where
	    a tree is displayed. <application>TrEd</application> allows for
	    multiple views (created by splitting a view in half either along
	    the horizontal or vertical axis). Always, one of the views is
	    focused. This view is called the <firstterm>active view</firstterm>
	    (also the current view). All commands related to a file, tree and
	    node usually only apply to the active view (or more specifically,
	    to the objects it displays). The active view is visually
	    distinguishable from the other views by its thick black border.
	    Optionally, inactive views may also be stippled (see <xref
	      linkend="stippleinactivewindows" />). Views can display trees from one file but also from several
	    unrelated files. It is also possible to display a single tree in
	    several views simultaneously. Each view is associated with a
	    file-list and a in-memory representation of a single 
	    file from that file-list (in case of the active
	    view called the <firstterm>current file-list</firstterm>
	    and the <firstterm>current file</firstterm>).
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>active (or current) node</term>
	<listitem>
	  <para>
	    The <firstterm>active node</firstterm> plays a similar role to that
	    of a cursor in a text editor. Each view remembers its active node.
	    In general, if we refer to the active or current node, we usually
	    mean the active node of the active view. In the default setup, the
	    active node is by default visually differentiated from other nodes
	    by its red color (other nodes are displayed as yellow or black).
	    However, it must be noted that a stylesheet can (and often does)
	    change the coloring of the tree, including definin its own way
	    to distinguish the active node.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>macro</term>
	<listitem>
	  <para><application>TrEd</application> by default offers only a small
	    set of fundamental and generic tree-editing commands.
	    Commands specific to certain purpose or data are typically
	    implemented as user-defined macros. A <firstterm>macro</firstterm> is
	    a small program (more specifically a Perl subroutine), typically
	    associated with a keyboard shortcut or a menu item.
	    See <xref linkend="macros"/> for details.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>hook</term>
	<listitem>
	  <para>
	    <firstterm>Hooks</firstterm> are similar to macros but
	    they are called indirectly by <application>TrEd</application> 
	    rather directly by the user, although they also 
	    in a way response to a particular
	    event or action performed by the user. For example, every time
	    the user performs an action resulting in
	    a file being opened, <application>TrEd</application>
	    tries to locate and call a user-defined function
	    named <link linkend="file_opened_hook"><literal>file_opened_hook</literal></link>
	    in the current binding context (described below).
	    See <xref linkend="hooks"/> for details.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>binding context</term>
	<listitem>
	  <para>
	    Macros serving similar purpose and often related to
	    some specific data may be organized to sets
	    called <firstterm>binding context</firstterm>.
	    Each view is associated with a binding context (called the
	    <firstterm>current context</firstterm>) and
	    the user may easilly switch from one context to another.
	    If the user presses a keyboard shortcut,
	    <application>TrEd</application> tries to find
	    a binding for that shortcut in the current
	    binding context. If it fails, tries the same
	    with a default context called <literal>TredMacro</literal>.
	    Similar lookup applies when the user performs an
	    action which requires a <firstterm>hook</firstterm>
	    to be called.
	    See <xref linkend="contexts"/> for details.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>stylesheet</term>
	<listitem>
	  <para>
	    A stylesheet is a set of rules (called
	    <firstterm>patterns</firstterm>) modifying the default appearance
	    of trees in a view. Each view initially uses a stylesheet provided
	    by the data file (which may be empty), but the user may instruct
	    the view to use another stylesheet. The same tree may be viewed
	    simultaneously in different views with completely different
	    stylesheets. If a very 
	    complex visual presentation is required, stylesheet rules may be accompanied by
	    some further presentational code defined in a
	    <link
	      linkend="node_style_hook"><literal>node_style_hook</literal></link>.
	    For more information see <xref linkend="stylesheets"/>.
	  </para>
	</listitem>
      </varlistentry>
    </variablelist>
  </section>
  <section id="overview">
    <title>Overview of <application>TrEd's</application> user
    interface</title>
    
    <mediaobject>
      <imageobject>
	<imagedata fileref="pics/tred_overview.png" format="PNG"
	  role="html"/>
      </imageobject>
      <imageobject>
	<imagedata fileref="pics/tred_overview.eps" format="EPS"
	  role="latex"/>
      </imageobject>
      <imageobject>
	  <imagedata fileref="pics/tred_overview" format="linespecific"/>
      </imageobject>
    </mediaobject>
    <para>
      The picture above shows the <application>TrEd</application>'s
      main window. The most importatnt elements of the user interface
      are marked by numbers in the picture and briefly introducted
      below:
      <orderedlist>
	<listitem>
	  <para>
	    This part of the window contains one or more views.
	    Each view displays one tree. The black border
	    distinguishes the active view (there is only one view
	    pictured here).
	  </para>
	</listitem>
	<listitem>
	  <para>
	    This part of the window displays additional textual
	    information associated with the tree displayed in the
	    active view (e.g. the <quote>sentence</quote> represented by the tree).
	  </para>
	</listitem>
	<listitem>
	  <para>
	    Status line. It displays various information provided by
	    the current binding context.
	  </para>
	</listitem>
	<listitem>
	  <para>
	    Current binding context. You can change the context by clicking on this
	    menu button and selecting a different one from the list.
	  </para>
	</listitem>
	<listitem>
	  <para>
	    Current style-sheet. It can be changed in the similar way as the
	    context.
	  </para>
	</listitem>
	<listitem>
	  <para>Click here to edit the current stylesheet.</para>
	</listitem>
	<listitem>
	  <para>
	    Click here to get the list of all <quote>sentences</quote>
	    associated with trees in the current file. Above this
	    button, you also see the index of the current tree in the
	    current file.
	  </para>
	</listitem>
	<listitem>
	  <para>
	    Toolbar buttons provide shortcuts for the following
	    actions:
	    Open file, Save file, Reload file,
	    Undo, Redo, Previous File, Next File, Print, Find, Find Next, Find Previous.
	  </para>
	</listitem>
	<listitem>
	  <para>
	    These two buttons move view to the previous and next tree
	    in the current file.
	    The four buttons that follow are used for view management. 
	  </para>
	</listitem>
      </orderedlist>
    </para>
  </section>
  <section id="menu">
    <title>Menu commands</title>    
    <para>
      The following paragraphs describe menu commands. Each submenu in
      <application moreinfo="none">TrEd</application> has as its first item a tear-off
      line (<guimenuitem moreinfo="none">- - - - -</guimenuitem>)
      which can be used to tear the menu off and place it as a
      separate window anywhere on your desktop.
    </para>
    <section id="file">
      <title><guimenu moreinfo="none">File</guimenu></title>
      <variablelist>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Open ...</guimenuitem></term>
	  <listitem>
	    <para>
	      Opens an existing file that the user chooses in the
	      <guilabel moreinfo="none">Open</guilabel> dialog box.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Open URL ...</guimenuitem></term>
	  <listitem>
	    <para>
	      Displays a dialog window with an entry into which the
	      user can enter a URL or a
	      filename. <application moreinfo="none">TrEd</application> can
	      downloading and open files at least using <literal moreinfo="none">http</literal>, <literal moreinfo="none">ftp</literal>, and <literal moreinfo="none">file</literal> protocols. Network
	      protocols (<literal moreinfo="none">http</literal> and
	      <literal moreinfo="none">ftp</literal>) are read-only.  On UNIX systems,
	      <application moreinfo="none">TrEd</application> also supports the SSH
	      protocol with URLs of the form
	      <literal moreinfo="none">ssh://<optional><replaceable>user@</replaceable></optional><replaceable>host</replaceable>/<replaceable>remote-filename</replaceable></literal>.
	    </para>
	    <note>
	      <para>
		Since the current implementation of SSH remote file transfer
		requires several subsequent login sessions each time a
		remote file is accessed, it is highly recommended that a
		password-less access (e.g. using Kerberos or SSH keys)
		is set up before remote files are opened in TrEd using
		the SSH protocol.</para>
	    </note> 
	    <para>Additionally to the
	      protocols already mentioned, TrEd supports a special
	      protocol indicated by the URL prefix <literal moreinfo="none">ntred://</literal> used for
	      communication with BTrEd servers. This protocol allows
	      to inspect and change trees stored in memory of BTrEd
	      servers.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><menuchoice moreinfo="none">
	      <guimenuitem moreinfo="none">New</guimenuitem>
	      <guimenuitem moreinfo="none">From Template</guimenuitem>
	    </menuchoice></term>
	  <listitem>
	    <para>
	      Creates a new empty file with the same set of attributes as
	      the file that the user chooses in the
	      <guilabel moreinfo="none">Open</guilabel> dialog box.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><menuchoice moreinfo="none">
	      <guimenuitem moreinfo="none">New</guimenuitem>
	      <guimenuitem moreinfo="none">From Current</guimenuitem>
	    </menuchoice></term>
	  <listitem>
	    <para>
	      Creates a new empty file with the same set of attributes as
	      the current open file. The command does nothing if no file is open.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Close</guimenuitem></term>
	  <listitem>
	    <para>Closes current file. If the file is modified but not
	      saved, the user is allowed to save it.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Close in Window</guimenuitem></term>
	  <listitem>
	    <para>Closes the view on the file in the current
	      window. All other views on the file remain untouched.
	      If no other view on the file exists, the file is closed.
	      If the file is modified but not saved, the user is allowed
	      to save it.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Close and remove from filelist</guimenuitem></term>
	  <listitem>
	    <para>Closes the current file and removes it from
	      the current file-list. If the file is modified but not saved, the user is allowed
	      to save it.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Filelist</guimenuitem></term>
	  <listitem>
	    <para>Opens a <guilabel moreinfo="none">Filelist</guilabel> dialog window which
	      allows the user to manage lists of files used for easy
	      file-to-file navigation.  See more detail in <xref linkend="filelists"/>.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Save</guimenuitem></term>
	  <listitem>
	    <para>
	      Saves the active file to the disk.  The previous version
	      of the file on the disk is renamed by appending `~' to
	      the filename (according to the well-known UNIX convention for
	      naming of backup files).
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Save As ...</guimenuitem></term>
	    <listitem>
	    <para>This command first asks the user to choose a desired
	      output format, then opens the standard file dialog where
	      new name and location of the file can be specified, and
	      finally runs the <guimenuitem moreinfo="none">Save</guimenuitem>
	      command.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Recent Files</guimenuitem></term>
	  <listitem>
	    <para>
	      This submenu displays 10 most recently opened
	      files. User may quickly reopen any of them by clicking
	      on the corresponding item.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Previous File</guimenuitem></term>
	  <listitem>
	    <para>
	      Opens the previous file of the current filelist in the current view, if any 
	      (see <xref linkend="filelists"/>).
	      Unless displayed in some other view, the active file is closed
	      (the user may be asked to save possible changes).
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Next File</guimenuitem></term>
	  <listitem>
	    <para>
	      Opens the next file of the current filelist in the current view, if any 
	      (see <xref linkend="filelists"/>).
	      Unless displayed in some other view, the active file is closed
	      (the user may be asked to save possible changes).
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="print_command">
	  <term><guimenuitem moreinfo="none">Print ...</guimenuitem></term>
	  <listitem>
	    <para>
	      Opens the Print Dialog. See <xref linkend="printing"/> for
	      a detailed information.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Edit config ...</guimenuitem></term>
	  <listitem>
	    <para>
	      Opens the configuration file in a simple text editor
	      (see <xref linkend="configuration"/> for the details
	      about configuration options).  To apply the new
	      configuration, save the configuration file to disk and
	      leave the editor press the <guibutton moreinfo="none">Save and Apply</guibutton> button. To
	      apply changes without saving them, press <guibutton moreinfo="none">Apply</guibutton>. The <guibutton moreinfo="none">Close</guibutton> button closes the
	      editor without making any changes to the present
	      configuration.  A search entry on the bottom of the
	      dialog window can be used for fast case-insensitive
	      searches. When editing the configuration file, make sure
	      you only define each configuration option once, since
	      TrEd doesn't give you any warning about duplicated
	      configuration entries. If an option occurs in the
	      configuration file more than once, the latter occurrence
	      has precedence.
	    </para>
	    <note>
	      <para>
		Some configuration options even if applied take effect only
		after restarting <application moreinfo="none">TrEd</application>.
	      </para>
	    </note>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Reload config ...</guimenuitem></term>
	  <listitem>
	    <para>
	      Use this command to reload the configuration file from
	      disk and apply the new options. This command is useful
	      if you have changed the configuration file in a text
	      editor or in an another running instance of
	      <application moreinfo="none">TrEd</application>. As above, note that
	      some configuration changes still take effect only after
	      restarting <application moreinfo="none">TrEd</application>.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Reload stylesheets ...</guimenuitem></term>
	  <listitem>
	    <para>
	      Reloads display stylesheets from the file
	      <filename moreinfo="none">~/.tred-stylesheets</filename>.
	      This command is useful
	      if you have changed the stylesheets in a text
	      editor or in an another running instance of
	      <application moreinfo="none">TrEd</application>.
	      For more information about stylesheets,
	      see <xref linkend="stylesheets"/>.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Quit</guimenuitem></term>
	  <listitem>
	    <para>Quit TrEd.  The the user is allowed to save all open
	      files containing unsaved changes.
	    </para>
	  </listitem>
	</varlistentry>
      </variablelist>
    </section>
    <section id="view">
      <title><guimenu moreinfo="none">View</guimenu></title>
      <variablelist>
	<varlistentry>
	  <term><guisubmenu moreinfo="none">Previous Tree</guisubmenu></term>
	  <listitem>
	    <para>View the previous tree in the current file.
	    </para>    
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Next Tree</guimenuitem></term>
	  <listitem>
	    <para>View the next tree in the current file.</para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Stipple Inactive Views</guimenuitem></term>
	  <listitem>
	    <para>If this item is checked, inactive views are covered
	      with a semi-transparent stipple pattern. This may
	      improve orientation if working with more than one view,
	      but also slightly reduces the clarity of trees displayed
	      in the inactive views.
	      (See also <link linkend="stippleinactivewindows">StippleInactiveWindows</link>
	      configuration option).
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Draw boxes around labels</guimenuitem></term>
	  <listitem>
	    <para>If this item is checked, square boxes are drawn
	      around groups of node labels.</para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term>
	    <guimenuitem moreinfo="none">Draw boxes around edge labels</guimenuitem></term>
	  <listitem>
	    <para>If this item is checked, square boxes are drawn
	      around groups of edge attributes.</para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Show Hidden Nodes</guimenuitem></term>
	  <listitem>
	    <para>
	      Toggle visibility the ``hidden'' subtrees of the tree.
	      If this item is checked, subtrees of nodes makred as hidden
	      using a special FS-attribute (see 
	      <ulink url="http://quest.ms.mff.cuni.cz/pdt/Corpora/PDT_1.0/Doc/fs.html">FS-format description</ulink>
	      for details) and displayed. By default subtrees of 
	      hidden nodes including the nodes themselves are not
	      displayed.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Highlight Attributes</guimenuitem></term>
	  <listitem>
	    <para>
	      Toggle highlighting certain attributes with
	      user-definable set of colors. See <xref linkend="configuration"/> for details on customizing
	      colors and <ulink url="http://quest.ms.mff.cuni.cz/pdt/Corpora/PDT_1.0/Doc/fs.html">FS-format
	      description</ulink> to learn about how to specify which
	      attributes are highlighted. In general, it is better to
	      avoid this approach of changing tree appearance in favor
	      of stylesheets (see <xref linkend="stylesheets"/>).
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Sort Attributes in Dialogs</guimenuitem></term>
	  <listitem>
	    <para>
	      Toggle sorting attributes by name in all dialog windows
	      displaying any form of a list of attributes or attribute
	      values. By default, sorting is turned on. If turned off,
	      depending on the format, attributes may be displayed in
	      order of their declaration in the file. When this option
	      is on, sorting of attributes may be further altered by
	      the <link linkend="sort_attrs_hook"><literal moreinfo="none">sort_attrs_hook</literal></link>.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Close current view</guimenuitem></term>
	  <listitem>
	    <para>
	      Closes the focused view if more than one views are present.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Split view horizontally</guimenuitem></term>
	  <listitem>
	    <para>
	      Create and focus a new view by splitting the current
	      view horizontally. Sizes of the new and old view may be
	      adjusted by dragging the bar between them. The user may
	      focus a view by clicking into it.  Most keyboard
	      shorcuts as well as menu and button commands only apply
	      to the focused view. The focused view is distinguished
	      from other views by black border drawn around it (both
	      color and width of this border may be customized, see
	      <link linkend="highlightwindowcolor"><varname>HighlightWindowColor</varname></link>
	      and <link linkend="highlightwindowwidth"><varname>HighlightWindowWidth</varname></link>
	      configuration options described below).  Inactive views
	      may be further distiguished using a stipple pattern (see
	      <link linkend="stippleinactivewindows">StippleInactiveWindows</link>
	      configuration option).
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Split view vertically</guimenuitem></term>
	  <listitem>
	    <para>
	      Create and focus a new view by splitting the current
	      view vertically. Sizes of the new and old view may be
	      adjusted by dragging the bar between them.  See also
	      little more detailed description of <guimenuitem moreinfo="none">Split view horizontally</guimenuitem>
	      above.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="list_of_sentences">
	  <term><guimenuitem moreinfo="none">List of sentences ...</guimenuitem></term>
	  <listitem>
	    <para>
	      Display a window containing a list of
	      <quote>sentences</quote> of all trees in a current
	      file. These <quote>sentences</quote> are computed in the
	      same way as the content of the text line above the tree,
	      e.g.  using a <link linkend="get_value_line_hook"><literal moreinfo="none">get_value_line_hook</literal></link>
	      or the <literal moreinfo="none">text:</literal> stylesheet pattern (see
	      <xref linkend="stylesheets"/>), or as a concatenation of
	      special attribute values (i.e. attributes declared
	      as <literal moreinfo="none">@V</literal> in the FS
	      format).
	      In the list, buttons <inlinemediaobject><imageobject><imagedata fileref="pics/1rightarrow.png" format="PNG" role="html"/></imageobject><imageobject><imagedata fileref="pics/1rightarrow.eps" format="EPS" role="latex"/></imageobject><imageobject><imagedata fileref="pics/1rightarrow" format="linespecific"/></imageobject></inlinemediaobject>
	      display the corresponding sentence in the current TrEd view.
	      Buttons <inlinemediaobject><imageobject><imagedata fileref="pics/gray_belly3.png" format="PNG" role="html"/></imageobject><imageobject><imagedata fileref="pics/gray_belly3.eps" format="EPS" role="latex"/></imageobject><imageobject><imagedata fileref="pics/gray_belly3" format="linespecific"/></imageobject></inlinemediaobject>
	      are used to select sentences. Selected sentences may be later inserted to tree
	      selection fields, e.g. in the <link linkend="print_command">Print dialog</link> and
	      in the <link linkend="copytrees_command">Copy trees
	      dialog</link>, by pressing the button <inlinemediaobject><imageobject><imagedata fileref="pics/1leftarrow.png" format="PNG" role="html"/></imageobject><imageobject><imagedata fileref="pics/1leftarrow.eps" format="EPS" role="latex"/></imageobject><imageobject><imagedata fileref="pics/1leftarrow" format="linespecific"/></imageobject>
		<textobject>
		  <phrase>with an arrow</phrase>
		</textobject>
	      </inlinemediaobject>.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Select context ...</guimenuitem></term>
	  <listitem>
	    <para>
	      Open a dialog window where the user can select a binding
	      context. Binding contexts are groups of user defined
	      macro-bindings, usually identified with macro
	      packages. See also <xref linkend="macros"/>.  The
	      current context can also be selected from the first list
	      in the top right corner of the main window, but this
	      makes changing contexts fully keyboard accessible.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Select stylesheet ...</guimenuitem></term>
	  <listitem>
	    <para>
	      Open a dialog window where the user can select a display
	      stylesheet. See <xref linkend="stylesheets"/>.  A
	      stylesheet can also be selected from the second list in
	      the top right corner of the main window, but this
	      menu makes changing stylesheets fully keyboard accessible.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Edit stylesheet ...</guimenuitem></term>
	  <listitem>
	    <para>
	      Open a dialog box with a stylesheet editor for the
	      currently selected stylesheet. A styleseet defines which
	      attributes should be displayed and defines the tree's
	      overall appearance. See <xref linkend="stylesheets"/>
	      for more detail.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">List of Named Macros...</guimenuitem></term>
	  <listitem>
	    <para>
	      Display a window listing all user-defined
	      menu-bindings (macros) in a selected context and their
	      keyboard shortcuts. 
	      User may run a macro
	      by double-clicking on a corresponding item in the list, or
	      by pressing the <guibutton moreinfo="none">Run and Close</guibutton>
	      button. In the latter case, the window is closed.  Two
	      buttons (
	      <guilabel moreinfo="none">Sort by name</guilabel> and <guilabel moreinfo="none">Sort by
	      keyboard shortcuts</guilabel>) control the order in which
	      macros are listed. The button <guibutton moreinfo="none">Export as HTML</guibutton>
	      creates a handy reference from the listing in form of a a HTML document.
	    </para>
	  </listitem>
	</varlistentry>
      </variablelist>
    </section>
    <section id="node">
      <title><guimenu moreinfo="none">Node</guimenu></title>
      <variablelist>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">New Node</guimenuitem></term>
	  <listitem>
	    <para>Creates a new node and connects it as a child of the
	      active node. Initially, all attributes of the new node are empty.</para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Remove Active Node</guimenuitem></term>
	  <listitem>
	    <para>Passes all children of the active node to its parent and
	      deletes the active node. This command is ignored if the active node is
	      the root of the tree.</para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Insert New Tree</guimenuitem></term>
	  <listitem>
	    <para>Inserts a new tree <emphasis>before</emphasis> the current
	      tree. The new tree consists of a root-node only. Initially, attributes of
	      this node are empty.</para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Insert New Tree After</guimenuitem></term>
	  <listitem>
	    <para>Inserts a new tree <emphasis>after</emphasis> the current
	      tree. The new tree consists of a root-node only. Initially, attributes of
	      this node are empty.</para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Remove Whole Current Tree</guimenuitem></term>
	  <listitem>
	    <para>
	      Removes the current tree from the file and displays the
	      following tree (or the preceding tree, in case the
	      current tree was the last one in the file). The memory
	      representation of the removed tree is destroyed.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="copytrees_command">
	  <term><guimenu moreinfo="none">Copy Trees</guimenu></term>
	  <listitem>
	    <para>
	      Displays a dialog allowing user to copy trees from the
	      current file into another file currently opened in TrEd.
	      The trees are selected by a comma separated list of
	      ranges. The format of the list is the same as in the
	      <link linkend="print_command">Print dialog</link>.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Edit Node ...</guimenuitem></term>
	  <listitem>
	    <para>
	      Displays the 
	      dialog box <guilabel moreinfo="none">Edit
	      Node</guilabel>, which is in detail described in 
	      <xref linkend="editnode"/>.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="find">
	  <term><guimenuitem moreinfo="none">Find ...</guimenuitem></term>
	  <listitem>
	    <para>
	      This command displays a dialog box in which the user may
	      specify a search criterion for a node search. The
	      criterion is based on regular expressions, wild-card
	      patterns or literal strings matches for attribute
	      values. In the dialog, every permittable node attribute
	      has an editable entry where the user specifies search
	      criterion for the particular attribute.  The user may
	      choose the type of the search criterions to be a <ulink url="regexps.html">regular expressions</ulink>,
	      exhaustive regular expressions (when the whole value
	      must match), wild-card pattern (where <literal moreinfo="none">?</literal> matches any character and
	      <literal moreinfo="none">*</literal> matches any number
	      of any characters) or a literal string. The type of the
	      criterion is selected in the <guilabel moreinfo="none">Search method</guilabel> option-menu and
	      applies to all entries.
	    </para>
	    <para>
	      In the <guilabel moreinfo="none">Search file-list</guilabel> option-menu, 
	      the user may choose a file-list to search through. By
	      default, this menu displays entry <guilabel moreinfo="none">[Current file only]</guilabel>,
	      which is a virtual file-list containing just the current file.
	    </para>
	    <para>
	      When user presses <guibutton moreinfo="none">Find</guibutton> button, <application moreinfo="none">TrEd</application> searches for the
	      first matching node in the selected file-list. A node
	      matches the criterion if and only if every attribute of
	      the node matches the criterion in the corresponding
	      entry (empty criterions always match).  If a matching
	      node is found, the search stops and the matching node is
	      displayed and made active.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Find Next ...</guimenuitem></term>
	  <listitem>
	    <para>
	      Finds a next node matching criteria specified in the
	      previous use of the <guimenuitem moreinfo="none">Find
	      ...</guimenuitem> command.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Find Previous ...</guimenuitem></term>
	  <listitem>
	    <para>
	      Finds a preceding node matching the criterion specified
	      in a previous use of the <guimenuitem moreinfo="none">Find ...</guimenuitem> command.
	    </para>
	  </listitem>
	</varlistentry>
      </variablelist>
    </section>
    <section>
      <title>Session</title>
      <para>
	This menu lets user switch between currently open files,
	change current file-list and toggle some file-related
	options.</para>
      <section>
	<title>Options</title>
	<variablelist id="dontcloseonopen">
	  <varlistentry>
	    <term><guimenuitem moreinfo="none">Don't close on open</guimenuitem></term>
	    <listitem>
	      <para>
		Do not close current file when opening a new one.
	      </para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term><guimenuitem moreinfo="none">Add open files to default file-list</guimenuitem></term>
	    <listitem>
	      <para>
		If this option is on, all opened files are added to
		the file-list <literal moreinfo="none">Default</literal> so that the user
		could easily go back and forth using
		<menuchoice moreinfo="none">
		  <guimenu moreinfo="none">File</guimenu>
		  <guimenuitem moreinfo="none">Previous File</guimenuitem>
		</menuchoice> and
		<menuchoice moreinfo="none">
		  <guimenu moreinfo="none">File</guimenu>
		  <guimenuitem moreinfo="none">Next File</guimenuitem>
		</menuchoice>.
	      </para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term><guimenuitem moreinfo="none">Preserve patterns on reload</guimenuitem></term>
	    <listitem>
	      <para>
		If this option is checked, current attribute pattern setting is not
		replaced with the one from the file when current file
		is reloaded with by pressing the
		<inlinemediaobject><imageobject><imagedata fileref="pics/reload.png" format="PNG" role="html"/></imageobject><imageobject><imagedata fileref="pics/reload.eps" format="EPS" role="latex"/></imageobject><imageobject><imagedata fileref="pics/reload" format="linespecific"/></imageobject></inlinemediaobject>
		(see also the <xref linkend="reloadpreservespatterns"/>
		configuration option).
	      </para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term><guimenuitem moreinfo="none">Build TGTS from CSTS</guimenuitem></term>
	    <listitem>
	      <para>
		This CSTS-backend specific option allows to choose
		which of the two tree structures stored in a CSTS file
		should be presented as trees (the other is encoded in
		node attributes as child-to-parent node references).
	      </para>
	    </listitem>
	  </varlistentry>
	</variablelist>
      </section>
      <section>
	<title>Open Files</title>
	<para>
	  <application moreinfo="none">TrEd</application> allows
	  having multiple files open simultaneously. If the user
	  tries to open a file while another file is already open,
	  modified, and yet not saved (and the <link linkend="dontcloseonopen">Don't close on open</link> option
	  is not checked) <application moreinfo="none">TrEd</application> offers the user to save
	  changes in the current file and close it, close it withought
	  saving or to <emphasis>keep</emphasis> the file open. In the
	  latter case, the file is not closed nor any changes are
	  discarded. The file remains open even if not displayed
	  by any view. Kept files can be viewed instantly in the
	  active view by selecting the corresponding item in the
	  <guimenu moreinfo="none">Session</guimenu> menu under the
	  <guimenuitem moreinfo="none">Open files</guimenuitem>
	  label. Any number of files can be simultaneously open in
	  this way. 
	</para>
      </section>
      <section>
	<title>File Lists</title>
	<para>
	  The bottom part of the <guimenu moreinfo="none">Session</guimenu> menu
	  contains a section labeled <guimenuitem moreinfo="none">File
	  lists</guimenuitem>, where file-list currently known to
	  <application moreinfo="none">TrEd</application> are listed. User may switch
	  to another file-list by choosing the corresponding item.
	  If the file-list was not accessed during the session,
	  the first file on the list is opened and displayed.
	  Otherwise, the file last accessed on that list
	  is re-opened and displayed.
	  See detailed information about file-lists
	  in <xref linkend="filelists"/>.
	</para>
      </section>
    </section>
    <section>
      <title><guimenu moreinfo="none">Bookmarks</guimenu></title>
      <para>
	This menu contains user's bookmarks. Bookmarks are filenames
	with tree-number and node position attached. The list
	of user's bookmarks is maintained in a special file-list named <literal moreinfo="none">Bookmarks</literal>. 
      </para>
      <para>
	<guimenuitem moreinfo="none">Add to Bookmars</guimenuitem>
	menu command adds bookmark for the current node.
      </para>
      <para>
	The <guimenuitem moreinfo="none">Last action</guimenuitem>
	menu command automatically opens and shows the file tree and
	node where the user made a last change to the tree structure
	or a node attribute. This is extra position is stored in
	TrEd's configuration file and does not appear among bookmarks.
      </para>
      <para>
	The rest of the <guimenu moreinfo="none">Bookmarks</guimenu>
	menu lists all defined bookmarks. User may follow a bookmark
	by choosing the corresponding menu item.
      </para>
    </section>
    <section id="usercommands">
      <title><guimenu moreinfo="none">User-defined</guimenu></title>
      <para>
	This menu contains user-defined commands in separate sub-menus
	for every binding context. New commands may be defined as macros
	(see <xref linkend="macros"/>).  Beside each menu entry is
	shown the default keyboard short-cut for the corresponding
	macro in the particular context. Here we give only a brief
	description of the few macros defined by default in the
	<application moreinfo="none">TredMacro</application> context
	in the base macro file <filename moreinfo="none">tred.mac</filename>.
      </para>
      <note>
	<para>
	  Note that, only a few of non-macro commands in TrEd are
	  associated with a keyboard shortcut (other than the standard
	  menu navigation using <keycode>Alt</keycode> and the
	  underlined letter). The aim is to give the user maximum
	  freedom of choice of available shortcuts for his or her own
	  macro commands.
	</para>
      </note>
      <variablelist>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Save File</guimenuitem>
	  (<keycap moreinfo="none">F2</keycap>)</term> 
	  <listitem>
	    <para>Provides a keyboard shortcut for the Save command.</para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Save and Go to Previous File</guimenuitem>
	  (<keycap moreinfo="none">F11</keycap>)</term> 
	  <listitem>
	    <para>Save the current file and open the previous file on the
	      current file-list.</para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Save and Go to Next File</guimenuitem>
	  (<keycap moreinfo="none">F12</keycap>)</term> 
	  <listitem>
	    <para>Save the current file and open the next file on the
	      current file-list.</para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Go to Previous File</guimenuitem>
	  (<keycap moreinfo="none">Shift+F11</keycap>)</term> 
	  <listitem>
	    <para>Close the current file and open the previous file on the current
	      file-list. If the current file contains unsaved changes,
	      the user is allowed to save them.</para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Go to Next File</guimenuitem>
	  (<keycap moreinfo="none">Shift+F12</keycap>)</term> 
	  <listitem>
	    <para>Close the current file and open the next file on the current
	      file-list. If the current file contains unsaved changes,
	      the user is allowed to save them.</para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Find</guimenuitem>
	  (<keycap moreinfo="none">F3</keycap>)</term>
	  <listitem>
	    <para>
	      Invoke <menuchoice moreinfo="none">
		<guimenu moreinfo="none">Node</guimenu>
		<guimenuitem moreinfo="none">Find ...</guimenuitem>
	      </menuchoice>.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Find Next</guimenuitem>
	  (<keycap moreinfo="none">F4</keycap>)</term>
	  <listitem>
	    <para>
	      Invoke <menuchoice moreinfo="none">
		<guimenu moreinfo="none">Node</guimenu>
		<guimenuitem moreinfo="none">Find Next</guimenuitem>
	      </menuchoice>.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Copy Values</guimenuitem>
	  (<keycap moreinfo="none">F5</keycap>)</term> 
	  <listitem>
	    <para>
	      Copies all values of the active node to an internal
	      clipboard. These values may be pasted to any other node using
	      the <guimenuitem moreinfo="none">Paste Values</guimenuitem> command.
	    </para>    
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Paste Values</guimenuitem>
	  (<keycap moreinfo="none">F8</keycap>)</term>
	  <listitem>
	    <para>
	      Assignes the active nodes attribute values stored in an internal
	      clipboard during the last call of the <guimenuitem moreinfo="none">Copy Values</guimenuitem> command.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Cut Subtree</guimenuitem> (<keycombo moreinfo="none" action="simul"><keycap moreinfo="none">Ctrl</keycap><keycap moreinfo="none">Insert</keycap></keycombo>)</term>
	  <listitem>
	    <para>Cuts off a subtree of the active node and stores
	      it in an iternal clipboard. The cut subtree may be attached later
	      to another node using the <guimenuitem moreinfo="none">Paste Subtree</guimenuitem>
	      command.
	      </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Paste Subtree</guimenuitem>
	    (<keycombo moreinfo="none" action="simul">
	      <keycap moreinfo="none">Shift</keycap>
	      <keycap moreinfo="none">Insert</keycap></keycombo>)</term>
	  <listitem>
	    <para>
	      Ataches a previously cut subtree to the active node.      
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Delete Node</guimenuitem>
	  (<keycap moreinfo="none">F8</keycap>)</term> 
	  <listitem>
	    <para>
	      Deletes active node. The node must be a leaf and must
	      not be the root of the tree, otherwise this command is
	      ignored.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Go to first tree</guimenuitem>
	    (<keycap moreinfo="none">Home</keycap> or
	    <keycombo moreinfo="none" action="simul">
	      <keycap moreinfo="none">Shift</keycap>
	      <keycap moreinfo="none">&lt;</keycap></keycombo>)</term> 
	  <listitem>
	    <para>
	      Displays the first tree in the file.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Go to first tree</guimenuitem>
	    (<keycombo moreinfo="none" action="simul">
	      <keycap moreinfo="none">Shift</keycap>
	      <keycap moreinfo="none">Home</keycap></keycombo>)</term> 
	  <listitem>
	    <para>
	      Like <guimenuitem moreinfo="none">Go to first tree</guimenuitem>,
	      only applies to all views, if <inlinemediaobject>
		<imageobject>
		  <imagedata fileref="pics/lock.png" format="PNG" role="html"/>
		</imageobject>
		<imageobject>
		  <imagedata fileref="pics/lock.eps" format="EPS" role="latex"/>
		</imageobject><imageobject>
		  <imagedata fileref="pics/lock" format="linespecific"/>
		</imageobject>
	      </inlinemediaobject>
	      is pressed.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Go to last tree</guimenuitem>
	    (<keycap moreinfo="none">End</keycap> or
	    <keycombo moreinfo="none" action="simul">
	      <keycap moreinfo="none">Shift</keycap>
	      <keycap moreinfo="none">&gt;</keycap></keycombo>)</term>  
	  <listitem>
	    <para>
	      Displays the last tree in the file.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Go to to last tree (tied)</guimenuitem>
	    (<keycombo moreinfo="none" action="simul">
	      <keycap moreinfo="none">Shift</keycap>
	      <keycap moreinfo="none">End</keycap></keycombo>)</term>  
	  <listitem>
	    <para>
	      Like <guimenuitem moreinfo="none">Go to last tree</guimenuitem>,
	      only applies to all views, if <inlinemediaobject>
		<imageobject>
		  <imagedata fileref="pics/lock.png" format="PNG" role="html"/>
		</imageobject>
		<imageobject>
		  <imagedata fileref="pics/lock.eps" format="EPS" role="latex"/>
		</imageobject><imageobject>
		  <imagedata fileref="pics/lock" format="linespecific"/>
		</imageobject>
	      </inlinemediaobject>
	      is pressed.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Go to...</guimenuitem> (<keycombo moreinfo="none" action="simul">
	      <keycap moreinfo="none">Alt</keycap>
	      <keycap moreinfo="none">g</keycap></keycombo>)</term> 
	  <listitem>
	    <para>
	      Promts the user to enter an ordinal number of a tree in
	      the file and displays that tree.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Go to...(tied)</guimenuitem> (<keycombo moreinfo="none" action="simul">
	      <keycap moreinfo="none">Alt</keycap>
	      <keycap moreinfo="none">Shift</keycap>
	      <keycap moreinfo="none">G</keycap></keycombo>)</term> 
	  <listitem>
	    <para>
	      Promts the user to enter an ordinal number of a tree in
	      the file and displays that tree (depending
	      on the status of the button 
	      <inlinemediaobject>
		<imageobject>
		  <imagedata fileref="pics/lock.png" format="PNG" role="html"/>
		</imageobject>
		<imageobject>
		  <imagedata fileref="pics/lock.eps" format="EPS" role="latex"/>
		</imageobject><imageobject>
		  <imagedata fileref="pics/lock" format="linespecific"/>
		</imageobject>
	      </inlinemediaobject>
	      either in the current view only or in all views).
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">New Node (r-brother)</guimenuitem>
	  (<keycap moreinfo="none">F7</keycap>)</term> 
	  <listitem>
	    <para>
	      Creates a new node as a right sibling of the active node
	      (this command is ignored if the active node is the root-node).
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">New Node (son)</guimenuitem> (<keycombo moreinfo="none" action="simul">
	      <keycap moreinfo="none">Shift</keycap>
	      <keycap moreinfo="none">F7</keycap></keycombo>)</term>
	  <listitem>
	    <para>
	      Creates a new child-node of the active node.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Perl-Search</guimenuitem> (<keycombo moreinfo="none" action="simul">
	      <keycap moreinfo="none">Alt</keycap>
	      <keycap moreinfo="none">H</keycap></keycombo>)</term>
	  <listitem>
	    <para>
	      When invoked, a dialog with an editor for a Perl code
	      snippet is displayed. The Perl code entered by user is
	      then evaluated for every node of the tree in their
	      natural ordering starting from the current node.  The
	      evaluation stops at first node for which the Perl code
	      returns true (i.e. a defined non-zero value) and this
	      node is activated.
	    </para>
	    <para>
	      The Perl code conforms to the very same rules as a
	      macro, i.e. in brief, the variables <literal moreinfo="none">$this</literal> and <literal moreinfo="none">$root</literal> refer to the active node
	      and root of the tree respectively.  If <literal moreinfo="none">$n</literal> refers to some node, then
	      <literal moreinfo="none">$n-&gt;{attr}</literal> is
	      value of <literal moreinfo="none">attr</literal>
	      attribute for the node <literal moreinfo="none">$n</literal>.  The parent-node of
	      <literal moreinfo="none">$n</literal> is accessed via <literal moreinfo="none">$n-&gt;parent</literal>, child-nodes of
	      <literal moreinfo="none">$n</literal> as <literal moreinfo="none">$n-&gt;childnodes</literal> (returns a
	      list), etc. Macros from the current context may be
	      called as Perl subroutines. See <xref linkend="macros"/>
	      for details.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Perl-Search Next</guimenuitem> (<keycombo moreinfo="none" action="simul">
	      <keycap moreinfo="none">Alt</keycap>
	      <keycap moreinfo="none">Shift</keycap>
	      <keycap moreinfo="none">H</keycap></keycombo>)</term>
	  <listitem>
	    <para>
	      Searches the next node satisfying the Perl-expression
	      specified in a previous usage of the command
	      <guimenuitem moreinfo="none">Perl-Search</guimenuitem>.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Swap nodes (values only)</guimenuitem>
	      (<keycombo moreinfo="none" action="simul">
	      <keycap moreinfo="none">Ctrl</keycap>
	      <keycap moreinfo="none">PageUp</keycap></keycombo>)</term> 
	  <listitem>
	    <para>
	      Makes the active node exchange its attributes with its
	      parent-node which effectively swaps the two nodes.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Prev node linearly</guimenuitem>
	      (<keycombo moreinfo="none" action="simul">
	      <keycap moreinfo="none">Ctrl</keycap>
	      <keycap moreinfo="none">&lt;</keycap></keycombo>)</term> 
	  <listitem>
	    <para>
	      Activate the previous node in the horizontal linear ordering
	      of the tree (i.e. usually the node corresponding to the
	      previous token or word in a sentence).
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Next node linearly</guimenuitem>
	      (<keycombo moreinfo="none" action="simul">
	      <keycap moreinfo="none">Ctrl</keycap>
	      <keycap moreinfo="none">&gt;</keycap></keycombo>)</term> 
	  <listitem>
	    <para>
	      Activate the next node in the horizontal linear ordering
	      of the tree (i.e. usually the node corresponding to the
	      next token or word in a sentence).
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><menuchoice moreinfo="none">
	      <guimenu moreinfo="none">View</guimenu>
	      <guimenuitem moreinfo="none">Previous Tree</guimenuitem>
	    </menuchoice>
	    ignore ties
	    (<keycap moreinfo="none">,</keycap> <quote>comma</quote>)</term>
	  <listitem>
	    <para>Displayes the previous tree in the current file.
	      Note that this shorcuts operates on the focused
	      view only, even if button
	      <inlinemediaobject><imageobject><imagedata fileref="pics/lock.png" format="PNG" role="html"/></imageobject><imageobject><imagedata fileref="pics/lock.eps" format="EPS" role="latex"/></imageobject><imageobject><imagedata fileref="pics/lock" format="linespecific"/></imageobject></inlinemediaobject>
	      is pressed and all views are tied
	      (and this is a feature).
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><menuchoice moreinfo="none">
	      <guimenu moreinfo="none">View</guimenu>
	      <guimenuitem moreinfo="none">Next Tree</guimenuitem>
	    </menuchoice>
	    ignore ties
	    (<keycap moreinfo="none">.</keycap> <quote>dot</quote> )</term>
	  <listitem>
	    <para>Displayes the next tree in the current file.
	      Note that this shorcuts operates on the focused
	      view only, even if button
	      <inlinemediaobject><imageobject><imagedata fileref="pics/lock.png" format="PNG" role="html"/></imageobject><imageobject><imagedata fileref="pics/lock.eps" format="EPS" role="latex"/></imageobject><imageobject><imagedata fileref="pics/lock" format="linespecific"/></imageobject></inlinemediaobject>
	      is pressed and all views are tied
	      (and this is a feature).
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><menuchoice moreinfo="none">
	      <guimenu moreinfo="none">View</guimenu>
	      <guimenuitem moreinfo="none">Previous Tree</guimenuitem>
	    </menuchoice>
	    (<keycombo action="simul" moreinfo="none">
	      <keycap moreinfo="none">Ctrl</keycap>
	      <keycap moreinfo="none">,</keycap>   
	    </keycombo>)</term>
	  <listitem>
	    <para>Displayes the previous tree in the
	      current view (or all views, if button
	      <inlinemediaobject><imageobject><imagedata fileref="pics/lock.png" format="PNG" role="html"/></imageobject><imageobject><imagedata fileref="pics/lock.eps" format="EPS" role="latex"/></imageobject><imageobject><imagedata fileref="pics/lock" format="linespecific"/></imageobject></inlinemediaobject>
	      is pressed).
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><menuchoice moreinfo="none">
	      <guimenu moreinfo="none">View</guimenu>
	      <guimenuitem moreinfo="none">Next Tree</guimenuitem>
	    </menuchoice> (<keycombo action="simul" moreinfo="none">
	      <keycap moreinfo="none">Ctrl</keycap>
	      <keycap moreinfo="none">.</keycap>   
	    </keycombo>)</term>
	  <listitem>
	    <para>Displayes the next tree in the
	      current view (or all views, if button
	      <inlinemediaobject><imageobject><imagedata fileref="pics/lock.png" format="PNG" role="html"/></imageobject><imageobject><imagedata fileref="pics/lock.eps" format="EPS" role="latex"/></imageobject><imageobject><imagedata fileref="pics/lock" format="linespecific"/></imageobject></inlinemediaobject>
	      is pressed).
	    </para>
	  </listitem>
	</varlistentry>
      </variablelist>
    </section>
    <section>
      <title><guimenu moreinfo="none">Help</guimenu></title>
      <variablelist>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">About</guimenuitem></term>
	  <listitem>
	    <para>
	      Displays the <guimenuitem moreinfo="none">About</guimenuitem> dialog
	      where the information about version, current file name
	      and format, number of trees, and more is given.
	    </para>
	  </listitem>
	</varlistentry>
      </variablelist>
      <variablelist>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Examine bindings</guimenuitem></term>
	  <listitem>
	    <para>Displays a window where the user may safely test keyboard bindings.
	      Every time a keyboard short-cut is pressed in the dialog, TrEd looks up
	      if some macro is associated with the short-cut and displayes
	      the result. No macros acrually executed.
	    </para>
	  </listitem>
	</varlistentry>
      </variablelist>
      <variablelist>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Reload macros</guimenuitem></term>
	  <listitem>
	    <para>Removes all macro code and variables from memory and
	      reloads all macros. This command is useful when the user
	      modifies the macros in a text editor and wants to check the
	      result without having to restart <application moreinfo="none">TrEd</application>.
	    </para>
	  </listitem>
	</varlistentry>
      </variablelist>
      <variablelist>
	<varlistentry>
	  <term><guimenuitem moreinfo="none">Debugging messages</guimenuitem></term>
	  <listitem>
	    <para>In this submenu the user may turn on and off various sets of 
	      debugging messages printed by <application moreinfo="none">TrEd</application> on
	      the standard or error output (e.g. in a terminal window).
	      The following sets of debugging messages are defined:
	      <guilabel moreinfo="none">tred</guilabel> (messages produced by
	      <application moreinfo="none">TrEd</application>'s GUI),
	      <guilabel moreinfo="none">macro</guilabel>
	      (messages issued by TrEd when a macro is evaluated),
	      <guilabel moreinfo="none">hooks</guilabel>
	      (messages issued by TrEd when a hook is evaluated),
	      <guilabel moreinfo="none">keyboard</guilabel>
	      (messages produced by TrEd when a keyboard short-cut is pressed),
	      <guilabel moreinfo="none">backend</guilabel>
	      (messages produced by I/O backends),
	      <guilabel moreinfo="none">view</guilabel>
	      (messages produced by the displaying engine and errors
	      raised during style-sheet evaluation).
	    </para>
	  </listitem>
	</varlistentry>
      </variablelist>

    </section>
  </section>
  <section id="toolbar">
    <title>Toolbar</title>
    <para>
      Most of the toolbar buttons only provide mouse-oriented
      shortcuts for standard menu-commands. 
    </para>
    <variablelist>
      <varlistentry>
	<term>
	  <inlinemediaobject>
	    <imageobject>
	      <imagedata fileref="pics/fileopen.png" format="PNG" role="html"/>
	    </imageobject>
	    <imageobject>
	      <imagedata fileref="pics/fileopen.eps" format="EPS" role="latex"/>
	    </imageobject>
	    <imageobject>
	      <imagedata fileref="pics/fileopen" format="linespecific"/>
	    </imageobject>
	  </inlinemediaobject>
	</term>
	<listitem>
	  <para>
	    <menuchoice moreinfo="none">
	      <guimenu moreinfo="none">File</guimenu>
	      <guimenuitem moreinfo="none">Open ...</guimenuitem>
	    </menuchoice>
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>
	  <inlinemediaobject>
	    <imageobject>
	      <imagedata fileref="pics/filefloppy.png" format="PNG" role="html"/>
	    </imageobject>
	    <imageobject>
	      <imagedata fileref="pics/filefloppy.eps" format="EPS" role="latex"/>
	    </imageobject>
	    <imageobject>
	      <imagedata fileref="pics/filefloppy" format="linespecific"/>
	    </imageobject>
	  </inlinemediaobject>
	</term>
	<listitem>
	  <para>
	    <menuchoice moreinfo="none">
	      <guimenu moreinfo="none">File</guimenu>
	      <guimenuitem moreinfo="none">Save</guimenuitem>
	    </menuchoice>
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>
	  <inlinemediaobject>
	    <imageobject>
	      <imagedata fileref="pics/reload.png" format="PNG" role="html"/>
	    </imageobject>
	    <imageobject>
	      <imagedata fileref="pics/reload.eps" format="EPS" role="latex"/>
	    </imageobject>
	    <imageobject>
	      <imagedata fileref="pics/reload" format="linespecific"/>
	    </imageobject>
	  </inlinemediaobject>
	</term>
	<listitem>
	  <para>Reload current file from disk.</para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>
	  <inlinemediaobject>
	    <imageobject>
	      <imagedata fileref="pics/redo.png" format="PNG" role="html"/>
	    </imageobject>
	    <imageobject>
	      <imagedata fileref="pics/redo.eps" format="EPS" role="latex"/>
	    </imageobject>
	    <imageobject>
	      <imagedata fileref="pics/redo" format="linespecific"/>
	    </imageobject>
	  </inlinemediaobject>
	</term>
	<listitem>
	  <para>Redo last undone operation on the current tree.</para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>
	  <inlinemediaobject>
	    <imageobject>
	      <imagedata fileref="pics/undo.png" format="PNG" role="html"/>
	    </imageobject>
	    <imageobject>
	      <imagedata fileref="pics/undo.eps" format="EPS" role="latex"/>
	    </imageobject>
	    <imageobject>
	      <imagedata fileref="pics/undo" format="linespecific"/>
	    </imageobject>
	  </inlinemediaobject>
	</term>
	<listitem>
	  <para>Undo last operation on the current
	    tree. (See also <link linkend="maxundo">MaxUndo</link>
	    configuration option.)</para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>
	  <inlinemediaobject>
	    <imageobject>
	      <imagedata fileref="pics/viewmag-.png" format="PNG" role="html"/>
	    </imageobject>
	    <imageobject>
	      <imagedata fileref="pics/viewmag-.eps" format="EPS" role="latex"/>
	    </imageobject>
	    <imageobject>
	      <imagedata fileref="pics/viewmag-" format="linespecific"/>
	    </imageobject>
	  </inlinemediaobject>
	</term>
	<listitem>
	  <para>
	    <menuchoice moreinfo="none">
	      <guimenu moreinfo="none">Node</guimenu>
	      <guimenuitem moreinfo="none">Find Previous</guimenuitem>
	    </menuchoice>
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>
	  <inlinemediaobject>
	    <imageobject>
	      <imagedata fileref="pics/start.png" format="PNG" role="html"/>
	    </imageobject>
	    <imageobject>
	      <imagedata fileref="pics/start.eps" format="EPS" role="latex"/>
	    </imageobject>
	    <imageobject>
	      <imagedata fileref="pics/start" format="linespecific"/>
	    </imageobject>
	  </inlinemediaobject>
	</term>
	<listitem>
	  <para>
	    <menuchoice moreinfo="none">
	      <guimenu moreinfo="none">File</guimenu>
	      <guimenuitem moreinfo="none">Previous File</guimenuitem>
	    </menuchoice>
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>
	  <inlinemediaobject>
	    <imageobject>
	      <imagedata fileref="pics/fileprint.png" format="PNG" role="html"/>
	    </imageobject>
	    <imageobject>
	      <imagedata fileref="pics/fileprint.eps" format="EPS" role="latex"/>
	    </imageobject>
	    <imageobject>
	      <imagedata fileref="pics/fileprint" format="linespecific"/>
	    </imageobject>
	  </inlinemediaobject>
	</term>
	<listitem>
	  <para>
	    <menuchoice moreinfo="none">
	      <guimenu moreinfo="none">File</guimenu>
	      <guimenuitem moreinfo="none">Print ...</guimenuitem>
	    </menuchoice>
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>
	  <inlinemediaobject>
	    <imageobject>
	      <imagedata fileref="pics/find.png" format="PNG" role="html"/>
	    </imageobject>
	    <imageobject>
	      <imagedata fileref="pics/find.eps" format="EPS" role="latex"/>
	    </imageobject>
	    <imageobject>
	      <imagedata fileref="pics/find" format="linespecific"/>
	    </imageobject>
	  </inlinemediaobject>
	</term>
	<listitem>
	  <para>
	    <menuchoice moreinfo="none">
	      <guimenu moreinfo="none">Node</guimenu>
	      <guimenuitem moreinfo="none">Find ...</guimenuitem>
	    </menuchoice>
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>
	  <inlinemediaobject>
	    <imageobject>
	      <imagedata fileref="pics/viewmag+.png" format="PNG" role="html"/>
	    </imageobject>
	    <imageobject>
	      <imagedata fileref="pics/viewmag+.eps" format="EPS" role="latex"/>
	    </imageobject>
	    <imageobject>
	      <imagedata fileref="pics/viewmag+" format="linespecific"/>
	    </imageobject>
	  </inlinemediaobject>
	</term>
	<listitem>
	  <para>
	    <menuchoice moreinfo="none">
	      <guimenu moreinfo="none">Node</guimenu>
	      <guimenuitem moreinfo="none">Find Next</guimenuitem>
	    </menuchoice>
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>
	  <inlinemediaobject>
	    <imageobject>
	      <imagedata fileref="pics/finish.png" format="PNG" role="html"/>
	    </imageobject>
	    <imageobject>
	      <imagedata fileref="pics/finish.eps" format="EPS" role="latex"/>
	    </imageobject>
	    <imageobject>
	      <imagedata fileref="pics/finish" format="linespecific"/>
	    </imageobject>
	  </inlinemediaobject>
	</term>
	<listitem>
	  <para>
	  <menuchoice moreinfo="none">
	      <guimenu moreinfo="none">File</guimenu>
	      <guimenuitem moreinfo="none">Next File</guimenuitem>
	    </menuchoice>
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>
	  <inlinemediaobject>
	    <imageobject>
	      <imagedata fileref="pics/1leftarrow.png" format="PNG" role="html"/>
	    </imageobject>
	    <imageobject>
	      <imagedata fileref="pics/1leftarrow.eps" format="EPS" role="latex"/>
	    </imageobject>
	    <imageobject>
	      <imagedata fileref="pics/1leftarrow" format="linespecific"/>
	    </imageobject>
	  </inlinemediaobject>
	</term>
	<listitem>
	  <para>
	  <menuchoice moreinfo="none">
	    <guimenu moreinfo="none">View</guimenu>
	    <guimenuitem moreinfo="none">Previous Tree</guimenuitem>
	  </menuchoice>
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>
	  <inlinemediaobject>
	    <imageobject>
	      <imagedata fileref="pics/1rightarrow.png" format="PNG" role="html"/>
	    </imageobject>
	    <imageobject>
	      <imagedata fileref="pics/1rightarrow.eps" format="EPS" role="latex"/>
	    </imageobject>
	    <imageobject>
	      <imagedata fileref="pics/1rightarrow" format="linespecific"/>
	    </imageobject>
	  </inlinemediaobject>
	</term>
	<listitem>
	  <para>
	  <menuchoice moreinfo="none">
	    <guimenu moreinfo="none">View</guimenu>
	    <guimenuitem moreinfo="none">Next Tree</guimenuitem>
	  </menuchoice>
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>
	  <inlinemediaobject>
	    <imageobject>
	      <imagedata fileref="pics/tick.png" format="PNG" role="html"/>
	    </imageobject>
	    <imageobject>
	      <imagedata fileref="pics/tick.eps" format="EPS" role="latex"/>
	    </imageobject>
	    <imageobject>
	      <imagedata fileref="pics/tick" format="linespecific"/>
	    </imageobject>
	  </inlinemediaobject>
	</term>
	<listitem>
	  <para>
	  <menuchoice moreinfo="none">
	    <guimenu moreinfo="none">View</guimenu>
	    <guimenuitem moreinfo="none">Customize
	      Tree...</guimenuitem>
	  </menuchoice>
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>
	  <inlinemediaobject>
	    <imageobject>
	      <imagedata fileref="pics/contents.png" format="PNG" role="html"/>
	    </imageobject>
	    <imageobject>
	      <imagedata fileref="pics/contents.eps" format="EPS" role="latex"/>
	    </imageobject>
	    <imageobject>
	      <imagedata fileref="pics/contents" format="linespecific"/>
	    </imageobject>
	  </inlinemediaobject>
	</term>
	<listitem>
	  <para>
	  <menuchoice moreinfo="none">
	    <guimenu moreinfo="none">View</guimenu>
	    <guimenuitem moreinfo="none">List
	      of sentences...</guimenuitem>
	  </menuchoice>
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>
	  <inlinemediaobject>
	    <imageobject>
	      <imagedata fileref="pics/view_top_bottom.png" format="PNG" role="html"/>
	    </imageobject>
	    <imageobject>
	      <imagedata fileref="pics/view_top_bottom.eps" format="EPS" role="latex"/>
	    </imageobject>
	    <imageobject>
	      <imagedata fileref="pics/view_top_bottom" format="linespecific"/>
	    </imageobject>
	  </inlinemediaobject>
	</term>
	<listitem>
	  <para>
	  <menuchoice moreinfo="none">
	    <guimenu moreinfo="none">View</guimenu>
	    <guimenuitem moreinfo="none">Split view horizontally</guimenuitem>
	  </menuchoice>
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>
	  <inlinemediaobject>
	    <imageobject>
	      <imagedata fileref="pics/view_left_right.png" format="PNG" role="html"/>
	    </imageobject>
	    <imageobject>
	      <imagedata fileref="pics/view_left_right.eps" format="EPS" role="latex"/>
	    </imageobject>
	    <imageobject>
	      <imagedata fileref="pics/view_left_right" format="linespecific"/>
	    </imageobject>
	  </inlinemediaobject>
	</term>
	<listitem>
	  <para>
	  <menuchoice moreinfo="none">
	    <guimenu moreinfo="none">View</guimenu>
	    <guimenuitem moreinfo="none">Split view vertically</guimenuitem>
	  </menuchoice>
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>
	  <inlinemediaobject>
	    <imageobject>
	      <imagedata fileref="pics/view_remove.png" format="PNG" role="html"/>
	    </imageobject>
	    <imageobject>
	      <imagedata fileref="pics/view_remove.eps" format="EPS" role="latex"/>
	    </imageobject>
	    <imageobject>
	      <imagedata fileref="pics/view_remove" format="linespecific"/>
	    </imageobject>
	  </inlinemediaobject>
	</term>
	<listitem>
	  <para>
	  <menuchoice moreinfo="none">
	    <guimenu moreinfo="none">View</guimenu>
	    <guimenuitem moreinfo="none">Close current view</guimenuitem>
	  </menuchoice>
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term>
	  <inlinemediaobject>
	    <imageobject>
	      <imagedata fileref="pics/lock.png" format="PNG" role="html"/>
	    </imageobject>
	    <imageobject>
	      <imagedata fileref="pics/lock.eps" format="EPS" role="latex"/>
	    </imageobject>
	    <imageobject>
	      <imagedata fileref="pics/lock" format="linespecific"/>
	    </imageobject>
	  </inlinemediaobject>
	</term>
	<listitem>
	  <para>This button has two states. If pressed,
	    all displayed views are tied together, so that
	    pressing <inlinemediaobject><imageobject><imagedata fileref="pics/1leftarrow.png" format="PNG" role="html"/></imageobject><imageobject><imagedata fileref="pics/1leftarrow.eps" format="EPS" role="latex"/></imageobject><imageobject><imagedata fileref="pics/1leftarrow" format="linespecific"/></imageobject></inlinemediaobject> or
	    <inlinemediaobject><imageobject><imagedata fileref="pics/1rightarrow.png" format="PNG" role="html"/></imageobject><imageobject><imagedata fileref="pics/1rightarrow.eps" format="EPS" role="latex"/></imageobject><imageobject><imagedata fileref="pics/1rightarrow" format="linespecific"/></imageobject></inlinemediaobject> buttons
	    as well as invoking
	    <menuchoice moreinfo="none"><guimenu moreinfo="none">View</guimenu><guisubmenu moreinfo="none">Previous tree</guisubmenu></menuchoice> or
	    <menuchoice moreinfo="none"><guimenu moreinfo="none">View</guimenu><guisubmenu moreinfo="none">Next tree</guisubmenu></menuchoice>
	    applies to all displayed views.
	  </para>
	</listitem>
      </varlistentry>
    </variablelist>
  </section>
  <section id="mouse-and-keyboard">
    <title>Basic tree editing using mouse and keyboard</title>
    <para>
      <application moreinfo="none">TrEd</application> can be
      controlled both using keyboard and mouse. Most keyboard short-cuts relate
      to the <firstterm>active node</firstterm>, which
      plays a similar role to that of a cursor in a text
      editor. Almost all of the basic tree editing operations (such as navigation
      the active node along the tree, cut-paste operations on the
      tree, editing node content, etc.) can be achieved both
      using keyboard and mouse bindings. Custom bindings and commands
      may be added using macros (see <xref linkend="macros"/>).
      Here is a brief overview of the basic editing operations:
    </para>
    <section>
    <title>Mouse Control</title>
    <itemizedlist>
      <listitem>
	  <para>Clicking left or right mouse button on a node activates it.</para></listitem>
      <listitem>
	  <para>Double clicking left mouse button on a node invokes
	    <menuchoice moreinfo="none">
	    <guimenu moreinfo="none">Node</guimenu>
	    <guimenuitem moreinfo="none">Edit Attribues</guimenuitem></menuchoice> command.</para></listitem>
	<listitem>
	  <para>Double clicking left mouse button on the text of 
	    a node's attribute opens a prompt for editing the value of
	    this attribute.
	  </para>
      </listitem>
      <listitem>
	  <para>
	    Dragging a node with left mouse button and dropping
	    it on another node cuts the dragged node and its subtree
	    and pastes it on the target node.	
	  </para>
      </listitem>
      <listitem>
	  <para>
	    Dragging and dropping a node with right mouse button has the same
	    effect as above, but this time, if the tree is too large to fit the window, the
	    window scrolls forward the direction of dragging so that when
	    the dragged node reaches an edge of the window it meets
	    the edge of the tree in that direction at the same time.
	  </para>
      </listitem>
      <listitem>
	  <para>
	    Pressing the middle button and moving the mouse pointer while
	    the button is pressed has the
	    same <quote>scrolling effect</quote> described above, but without
	    actually dragging any node.
	  </para>
	</listitem>
      </itemizedlist>
    </section>
    <section>
      <title>Keyboard Shortcuts</title>
      <para>Cursor keys may be used
	to activate another node in the structure. Use
	<keycap moreinfo="none">left</keycap>/<keycap moreinfo="none">right</keycap> to activate the
	nearest left/right brother-node of the active node and
	<keycap moreinfo="none">up</keycap>/<keycap moreinfo="none">down</keycap> to activate the active
	node's ancestor (parent)/its leftmost son.  
      </para>
      <para>
	Use <keycombo moreinfo="none" action="simul"> <keycap moreinfo="none">Shift</keycap>
	  <keycap moreinfo="none">left</keycap> </keycombo>/<keycombo moreinfo="none" action="simul">
	  <keycap moreinfo="none">Shift</keycap> <keycap moreinfo="none">right</keycap> </keycombo> to
	  activate the nearest node on the left/right of the active
	  node within the active node's level.
      </para>
      <para>
	<keycap moreinfo="none">Tab</keycap> and
	<keycombo moreinfo="none" action="simul">
	  <keycap moreinfo="none">Shift</keycap>
	  <keycap moreinfo="none">Tab</keycap>
	</keycombo> keys activate the
	next/previous node on the way along the tree structure.
      </para>
      <para>
      <keycap moreinfo="none">Enter</keycap> runs the <menuchoice moreinfo="none">
	  <guimenu moreinfo="none">Node</guimenu>
	  <guimenuitem moreinfo="none">Edit Node ...</guimenuitem></menuchoice> command.
    </para>
    <para>
      To edit the tree structure with keyboard only, use the shortcuts
      bound to the <link linkend="usercommands">User-defined menu
      commands</link>. Most important of those are:
      </para>
      <variablelist>
	<varlistentry>
	<term><keycombo moreinfo="none" action="simul">
	    <keycap moreinfo="none">Ctrl</keycap>
	    <keycap moreinfo="none">Insert</keycap>
	    </keycombo> (<guimenuitem moreinfo="none">Cut Subtree</guimenuitem>)</term>
	  <listitem>
	    <para>      
	      Cuts the whole subtree of the active node and stores it in an
	      iternal clipboard. It may be then pasted as a subtree of any
	      of the remaining nodes with the <guimenuitem moreinfo="none">Paste Subtree</guimenuitem>
	      command.
	    </para>    
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term>
	    <keycombo moreinfo="none" action="simul">
	      <keycap moreinfo="none">Shift</keycap>
	      <keycap moreinfo="none">Insert</keycap>
	    </keycombo> (<guimenuitem moreinfo="none">Paste Subtree</guimenuitem>)</term>
	  <listitem>
	    <para>
	    Pastes the tree saved in an internal clipboard during the
	    last call of the <guimenuitem moreinfo="none">Cut Subtree</guimenuitem>
	    command as a subtree of the active node.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><keycombo moreinfo="none" action="simul">
	      <keycap moreinfo="none">Alt</keycap>
	      <keycap moreinfo="none">G</keycap></keycombo> (<guimenuitem moreinfo="none">Go to...</guimenuitem>)</term>
	  <listitem>
	    <para>Promts user to enter an ordinal number of a tree and displays
	      the tree.</para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><keycap moreinfo="none">,</keycap> <quote>comma</quote> (<menuchoice moreinfo="none">
	      <guimenu moreinfo="none">View</guimenu>
	      <guimenuitem moreinfo="none">Previous Tree</guimenuitem>
	    </menuchoice>)</term>
	  <listitem>
	    <para>Displayes the previous tree in the current file.
	      Note that this shorcuts operates on the focused
	      view only, even if button <inlinemediaobject><imageobject><imagedata fileref="pics/lock.png" format="PNG" role="html"/></imageobject><imageobject><imagedata fileref="pics/lock.eps" format="EPS" role="latex"/></imageobject><imageobject><imagedata fileref="pics/lock" format="linespecific"/></imageobject></inlinemediaobject> is pressed and all views are tied.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><keycap moreinfo="none">.</keycap> <quote>dot</quote> (<menuchoice moreinfo="none">
	      <guimenu moreinfo="none">View</guimenu>
	      <guimenuitem moreinfo="none">Next Tree</guimenuitem>
	    </menuchoice>)</term>
	  <listitem>
	    <para>Displayes the next tree in the current file.
	      Note that this shorcuts operates on the focused
	      view only, even if button <inlinemediaobject><imageobject><imagedata fileref="pics/lock.png" format="PNG" role="html"/></imageobject><imageobject><imagedata fileref="pics/lock.eps" format="EPS" role="latex"/></imageobject><imageobject><imagedata fileref="pics/lock" format="linespecific"/></imageobject></inlinemediaobject> is pressed and all views are tied.
	    </para>
	  </listitem>
	</varlistentry>
      </variablelist>
    </section>
  </section>
  <section id="editnode">
    <title>Editing node attributes</title>
    <para>
      Double-clicking any attribute value displayed in the tree shows
      a simple value editor, where the value of the attribute can be
      changed (note however that some contexts disable editing certain
      or all attributes - in that case, the value editor presentes the
      attribute value as read-only).
    </para>
    <para>
      Usually not all attributes are displayed in the tree.  In that
      case it is necessary to use the <guilabel moreinfo="none">Edit
      Node</guilabel> dialog, which can be invoked either by
      double-clicking on the desired node in the tree, by activating the
      node and pressing <keycap moreinfo="none">Enter</keycap>, or by
      activating the node and selecting <menuchoice moreinfo="none">
	<guimenu moreinfo="none">Node</guimenu>
	<guimenuitem moreinfo="none">Edit Node ...</guimenuitem>
      </menuchoice> from the menu.
    </para>
    <para>
      The <guilabel moreinfo="none">Edit Node</guilabel> dialog shows all attributes
      defined for the type of the node or for the file and their
      corresponding values at the selected node.
      Depending on the type of the file, the dialog may have one
      of two possible interfaces, here refered to as the
      <firstterm>old interface</firstterm>
      (see <xref linkend="fig-old-editnode"/>)
      and the <firstterm>new interface</firstterm>
      (see <xref linkend="fig-new-editnode"/>).
    </para>    
    <para>
      Displays the 
      dialog box <guilabel moreinfo="none">Edit Node</guilabel>,
      listing all attributes defined for the type of the node or
      for the file and their corresponding values at the active node.
      Depending on the type of the file, the dialog may have one
      of two possible interfaces, here refered to as the
      <firstterm>old interface</firstterm>
      (see <xref linkend="fig-old-editnode"/>)
      and the <firstterm>new interface</firstterm>
      (see <xref linkend="fig-new-editnode"/>).
    </para>
    <para>
      The old interface supports attributes of the following
      types: strings,
      <literal moreinfo="none">|</literal>-separated lists of strings,
      enumerated values, and <literal moreinfo="none">|</literal>-separated
      lists of enumerated values. In the old interface,
      only plain string values can be edited directly.
      Any other attribute value can be edited in a dedicated
      sub-dialog, which appears after clicking on the button
      labeled <guibutton moreinfo="none">...</guibutton> beside them.
    </para>
    <figure id="fig-old-editnode" float="0">
      <title>Old Edit Node interface</title>
      <mediaobject>
	<imageobject>
	  <imagedata fileref="pics/edit_node_dialog_old.png" format="PNG" role="html"/>
	</imageobject>
	<imageobject>
	  <imagedata fileref="pics/edit_node_dialog_old.eps" format="EPS" role="latex"/>
	</imageobject>
      </mediaobject>
    </figure>
    <para>The new interface (now default for PML-based files
      and files in FS format) offers support for
      string attributes, enumerated attributes,
      constant attributes,
      lists (either <literal moreinfo="none">|</literal>-separated lists of strings used
      by FS format files or generic ordered or unordered <literal moreinfo="none">Fslib::List</literal>
      lists of arbitrary type and <literal moreinfo="none">Fslib::Alt</literal>
      alternatives used by PML instances), and also for 
      <firstterm>structured attributes</firstterm>
      (i.e. <quote>nesting</quote> of attributes).
    </para>
    <figure id="fig-new-editnode" float="0">
      <title>New Edit Node interface</title>
      <mediaobject>
	<imageobject>
	  <imagedata fileref="pics/edit_node_dialog.png" format="PNG" role="html"/>
	</imageobject>
	<imageobject>
	  <imagedata fileref="pics/edit_node_dialog.eps" format="EPS" role="latex"/>
	</imageobject>
      </mediaobject>
    </figure>
    <para>In this interface, the hierarchy
      of attributes is presented as a collapsible tree.
      The leafs of the tree represent the editable
      (string or enumerated) values. Enumerated values
      can be selected from a combo-box with a search-as-you-type
      functionality. Lists, alternatives and/or their members have additional
      buttons beside their tree-entry for adding
      new members, removing members, and altering the order of members,
      as listed in <xref linkend="tab-editnode"/>.
    </para>
    <table id="tab-editnode">
      <title>Buttons in the new <guilabel moreinfo="none">Edit Node</guilabel>
	interface</title>
      <tgroup cols="3">
	<thead>
	  <row>
	    <entry>Button</entry>
	    <entry>Keyboard shortcut</entry>
	    <entry>Description</entry>
	  </row>
	</thead>
	<tbody>
	  <row>
	    <entry>
	      <mediaobject>
		<imageobject><imagedata fileref="pics/edit_node_plus.png" format="PNG" role="html"/></imageobject>
		<imageobject><imagedata fileref="pics/edit_node_plus.eps" format="EPS" role="latex"/></imageobject>
		<textobject>
		  <phrase><literal moreinfo="none">+</literal></phrase></textobject>
	      </mediaobject>
	    </entry>
	    <entry><keycombo action="simul" moreinfo="none">
		<keysym>Ctrl</keysym>
		<keysym>+</keysym>
	      </keycombo>
	    </entry>
	    <entry>add new member to the list</entry>
	  </row>
	  <row>
	    <entry>
	      <mediaobject>
		<imageobject><imagedata fileref="pics/edit_node_minus.png" format="PNG" role="html"/></imageobject>
		<imageobject><imagedata fileref="pics/edit_node_minus.eps" format="EPS" role="latex"/></imageobject>
		<textobject>
		  <phrase><literal moreinfo="none">-</literal></phrase></textobject>
	      </mediaobject>
	    </entry>
	    <entry><keycombo action="simul" moreinfo="none">
		<keysym>Ctrl</keysym>
		<keysym>-</keysym>
	      </keycombo>
	    </entry>
	    <entry>remove current member from the list</entry>
	  </row>
	  <row>
	    <entry>
	      <mediaobject>
		<imageobject><imagedata fileref="pics/edit_node_up.png" format="PNG" role="html"/></imageobject>
		<imageobject><imagedata fileref="pics/edit_node_up.eps" format="EPS" role="latex"/></imageobject>
		<textobject>
		  <phrase><literal moreinfo="none">up</literal></phrase></textobject>
	      </mediaobject>
	    </entry>
	    <entry><keycombo action="simul" moreinfo="none">
		<keysym>Ctrl</keysym>
		<keysym>up</keysym>
	      </keycombo>
	    </entry>
	    <entry>move current member up in the list</entry>
	  </row>
	  <row>
	    <entry>
	      <mediaobject>
		<imageobject><imagedata fileref="pics/edit_node_down.png" format="PNG" role="html"/></imageobject>
		<imageobject><imagedata fileref="pics/edit_node_down.eps" format="EPS" role="latex"/></imageobject>
		<textobject>
		  <phrase><literal moreinfo="none">down</literal></phrase></textobject>
	      </mediaobject>
	    </entry>
	    <entry><keycombo action="simul" moreinfo="none">
		<keysym>Ctrl</keysym>
		<keysym>down</keysym>
	      </keycombo>
	    </entry>
	    <entry>move current member down in the list</entry>
	  </row>
	  <row>
	    <entry>
	      <mediaobject>
		<imageobject><imagedata fileref="pics/edit_node_star.png" format="PNG" role="html"/></imageobject>
		<imageobject><imagedata fileref="pics/edit_node_star.eps" format="EPS" role="latex"/></imageobject>
		<textobject>
		  <phrase><literal moreinfo="none">*</literal></phrase></textobject>
	      </mediaobject>
	    </entry>
	    <entry><keycombo action="simul" moreinfo="none">
		<keysym>Ctrl</keysym>
		<keysym>*</keysym>
	      </keycombo>
	    </entry>
	    <entry>add new alternative</entry>
	  </row>
	  <row>
	    <entry>
	      <mediaobject>
		<imageobject><imagedata fileref="pics/edit_node_cross.png" format="PNG" role="html"/></imageobject>
		<imageobject><imagedata fileref="pics/edit_node_cross.eps" format="EPS" role="latex"/></imageobject>
		<textobject>
		  <phrase><literal moreinfo="none">x</literal></phrase></textobject>
	      </mediaobject>
	    </entry>
	    <entry><keycombo action="simul" moreinfo="none">
		<keysym>Ctrl</keysym>
		<keysym>/</keysym>
	      </keycombo>
	    </entry>
	    <entry>remove current alternative</entry>
	  </row>
	</tbody>
      </tgroup>
    </table>

  </section>
  <section id="stylesheets">
    <title>Customizing Tree Appearance: Stylesheets</title>
    <section id="stylesheets_intro">
      <title>Introduction to stylesheets</title>
    <para>
      In <application moreinfo="none">TrEd</application>, the way a
      tree is displayed is controlled by so called <firstterm>display
      stylesheets</firstterm>.  Display stylesheets define what text
      is rendered as node and edge and how labels, the way tree edges
      are drawn (much more can be achieved than just straight lines
      connecting a node and its parent node), shape of the nodes,
      coloring, content of a tool-tip (<firstterm>hint</firstterm>)
      shown when mouse pointer lingers over a node, as well as the
      content of text window displayed above the tree.
      All these properties of the visual representation of the tree
      are specified using so called styling <firstterm>patterns</firstterm>.
    </para>
    <para>
      TrEd maintains a list of stylesheets from which stylesheets can
      selected and swithched between.  The easiest way to select a
      stylesheet is to click on the stylesheet menu-button shown on
      the picture <xref linkend="fig_patternset"/> below. This button
      can be found on the right side of the toolbar next to the
      <inlinemediaobject><imageobject><imagedata fileref="pics/wizard.png" format="PNG" role="html"/></imageobject><imageobject><imagedata fileref="pics/wizard.eps" format="EPS" role="latex"/></imageobject><imageobject><imagedata fileref="pics/wizard" format="linespecific"/></imageobject></inlinemediaobject> button.
      Another way to select a stylesheet is using 
      <menuchoice moreinfo="none">
	<guimenu moreinfo="none">View</guimenu>
	<guimenuitem moreinfo="none">Select stylesheet...</guimenuitem>
      </menuchoice>.
    </para>

    <figure float="0" id="fig_patternset">
      <title>Switching between stylesheets</title>
      <mediaobject><imageobject><imagedata fileref="pics/patternset.png" format="PNG" role="html"/></imageobject><imageobject><imagedata fileref="pics/patternset.eps" format="EPS" role="latex" width="13cm"/></imageobject><imageobject><imagedata fileref="pics/patternset" format="linespecific"/></imageobject></mediaobject>
    </figure>

    <para>
      The stylesheet currently selected on the picture and named
      <guilabel moreinfo="none">&lt;From File&gt;</guilabel> is always
      present. This is a rather virtual stylesheet whose content is
      always the styling patterns specified in the currently displayed
      file (some - but not all - file formats such as FS allow storing
      stylesheet information). These file-specific stylesheets are
      rather hard to maintain especially when one is working with
      hunderds of files. It is thus much more convenient to create a
      named stylesheet that can be used for any file at any time.
    </para>
    <para>
      To create a new named stylesheet (based on the current pattern
      settings), select an item labeled <guilabel moreinfo="none">&lt;New From
      Current&gt;</guilabel> from the stylesheet list and fill a name
      into the displayed dialog entry. The new stylesheet
      immediatelly appears as the selected item in the list.
    </para>
    <para>
      While a file-specific stylesheet is stored directly in the FS
      file, named stylesheets are all saved in a file called <filename moreinfo="none">.tred-stylesheets</filename> in user's home
      directory.  This file is updated every time a named stylesheet
      is added removed or edited. Currently selected named stylesheet
      can be completely removed from the list by selecting <guilabel moreinfo="none">&lt;Delete Current&gt;</guilabel> item from the
      pattern-set list.
    </para>
    <para>
      Selected stylesheet can be edited in a stylesheet editor which
      appears when <inlinemediaobject><imageobject><imagedata fileref="pics/wizard.png" format="PNG" role="html"/></imageobject><imageobject><imagedata fileref="pics/wizard.eps" format="EPS" role="latex"/></imageobject><imageobject><imagedata fileref="pics/wizard" format="linespecific"/></imageobject></inlinemediaobject> button is pressed or <menuchoice moreinfo="none">
      <guimenu moreinfo="none">View</guimenu> <guimenuitem moreinfo="none">Edit stylesheet...</guimenuitem></menuchoice>
      menu command issued.
    </para>
    <figure float="0">
      <title>Stylesheet editor</title>
      <mediaobject><imageobject><imagedata fileref="pics/customatt.png" format="PNG" role="html"/></imageobject><imageobject><imagedata fileref="pics/customatt.eps" format="EPS" role="latex" width="13cm"/></imageobject><imageobject><imagedata fileref="pics/customatt" format="linespecific"/></imageobject></mediaobject>
    </figure>
    <para>
      The dialog window contains two main elemens: a list of node
      attributes and an editor of stylesheet paterns. Double-clicking
      an attribute in the list inserts an attribute reference at the
      current cursor position in the pattern editor.
    </para>
    </section>
    <section id="pattern_syntax">
      <title>Stylesheet syntax: the styling patterns</title>
      <para>
	A stylesheet consists of one or more styling patterns. A
	styling pattern begins with a pattern prefix which must occur
	at the very beginning of a line (no whitespace allowed) and is
	followed by a comma. After the comma follows a body of the
	pattern.
      </para>
      <para>
	TrEd recognizes the following pattern prefixes (described in
	detail below): <literal moreinfo="none">node</literal>,
	<literal moreinfo="none">edge</literal>, <literal moreinfo="none">style</literal>, <literal moreinfo="none">text</literal> and <literal moreinfo="none">rootstyle</literal>.
	If any other prefix is used, TrEd ignores the pattern.
      </para>
      <variablelist>
	<varlistentry>
	  <term><literal moreinfo="none">node:</literal></term>
	  <listitem>
	    <para>
	      defines a line of text to be
	      displayed under each node of the tree. A stylesheet may
	      contain one or more <literal moreinfo="none">node:</literal> patterns,
	      in which case the lines are displayed in the tree one
	      under another in the order as they appear in the
	      stylesheet.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><literal moreinfo="none">edge:</literal></term>
	  <listitem>
	  <para>
	    defines a line of text displayed across (or beside)
	    the edge connecting each node with its parent. Of course, this
	    label is not rendered for the root node.
	      Likewise <literal moreinfo="none">node:</literal> patterns, several
	    <literal moreinfo="none">edge:</literal> patterns may be specified.
	      Note however that <literal moreinfo="none">edge:</literal> patterns
	      make the tree look quite wide and it is usually better
	    to avoid them.
	  </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><literal moreinfo="none">style:</literal></term>
	  <listitem>
	    <para>defines a pattern affecting the visual
	      representation of various components of a tree. <literal moreinfo="none">style:</literal> patterns do not result
	      in any text visible on the screen but may contain
	      special tree styling instructions described below. These
	      instructions may dynamically alter the appearance (such
	      as coloring, line thickness, etc) of the nodes, edges
	      and text labels.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><literal moreinfo="none">text:</literal></term>
	  <listitem>
	    <para>defines a portion of the text representing each node
	      in the text window above the tree.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><literal moreinfo="none">rootstyle:</literal></term>
	  <listitem>
	    <para>defines a pattern which behaves quite the same as a
	    <literal moreinfo="none">style:</literal> pattern but is
	    only interpolated once (for the root node), applies to
	    every node of the tree, but the styling instructions
	    defined in this pattern have lower precedence than those
	    of <literal moreinfo="none">style:</literal> patterns.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><literal moreinfo="none">hint:</literal></term>
	  <listitem>
	    <para>
	      defines the content of a tool-tip shown when mouse pointer
	      lingers over a node.  No styling instructions are
	      allowed in the <literal moreinfo="none">hint:</literal> patterns.
	    </para>
	  </listitem>
	</varlistentry>
      </variablelist>
      <para>
	Pattern body consists of a text which is interpreted as follows:
      </para>
    <variablelist>
      <varlistentry>
	<term><literal moreinfo="none">&lt;?<replaceable>code</replaceable>?&gt;</literal></term>
	<listitem>
	  <para>
	    Perl-code expansion. This sequence may encapsulate any Perl code. The code
	    is interpreted in the time of evaluation of the pattern
	    (i.e. just before the line is actually to be displayed)
	    and the result returned by the code replaces
	    the code sequence in the pattern.
	  </para>
	  <para>
	    Note that the returned value may contain other special
	    sequences, but can't contain another <literal moreinfo="none">&lt;?<replaceable>...</replaceable>?&gt;</literal>
	    sequences.
	  </para>
	  <para>
	    The <replaceable>code</replaceable> is subject to very
	      similar rules as macros in TrEd (see <xref
	      linkend="macros"/>). One may refer to any attribute
	      value of the node currently being styled as either
	      <literal
	      moreinfo="none">$${<replaceable>attr</replaceable>}</literal>
	      or <literal
	      moreinfo="none">$this-&gt;{<replaceable>attr</replaceable>}</literal>.
	      The current node object itself can be refered to as <literal
	      moreinfo="none">$this</literal> (so e.g. <literal
	      moreinfo="none">$this-&gt;parent</literal> gives access
	      to its parent).  Regardless
	      of what context is currently selected, the code occuring
	      in the styling patterns is always evaluated within the
	      <literal moreinfo="none">TredMacro</literal> namespace.
	      In order to call a user-defined macro from another
	      namespace, it is therefore necessary to use a complete
	      namespace (package name) prefix. So, a call to a macro
	      named <literal moreinfo="none">bar</literal> from a
	      package (context) <literal moreinfo="none">Foo</literal>
	      should look like <literal
	      moreinfo="none">Foo::bar(<replaceable>arguments...</replaceable>)</literal>.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term><literal moreinfo="none">${<replaceable>attr</replaceable>}</literal></term>
	<listitem>
	  <para>
	      Attribute reference. Any occurence of this substring is
	      replaced by current node's value of attribute named
	      <replaceable>attr</replaceable>.  Using attribute
	      references only makes sense in the
	      <literal moreinfo="none">node:</literal>, <literal moreinfo="none">edge:</literal>,
	      <literal moreinfo="none">text:</literal> and <literal moreinfo="none">hint:</literal>
	      patterns. In the labels rendered from
	      <literal moreinfo="none">node:</literal>, <literal moreinfo="none">edge:</literal>
	      patterns, this reference is actually linked with the
	      corresponding node's attribute, so double-clicking on the
	      displayed value in the tree shows a dialog where the
	      attribute value can be edited.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term><literal moreinfo="none">${<replaceable>attr</replaceable>=<replaceable>value</replaceable>}</literal></term>
	<listitem>
	  <para>
	      This is a special form of an attribute reference, which
	      is only useful in <literal moreinfo="none">node:</literal>,
	      <literal moreinfo="none">edge:</literal> patterns.  It always renders as
	      <replaceable>value</replaceable>, but still retains the
	      reference to the attribute
	      <replaceable>attr</replaceable> of the corresponding
	      node, so that double-clicking on the displayed
	      <replaceable>value</replaceable> in the tree shows a
	      dialog where the attribute
	      <replaceable>attr</replaceable> can be edited.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term><literal moreinfo="none">#{<replaceable>color</replaceable>}</literal></term>
	<listitem>
	  <para>
	    This sequence of characters may be used to change the
	    color of any possible following text generated by the
	    pattern. The <replaceable>color</replaceable> may be
	    either an english name of a color,
	    such as <literal moreinfo="none">black</literal>, <literal moreinfo="none">red</literal> or
	    <literal moreinfo="none">darkblue</literal>, or one of
	      user defined colors <literal moreinfo="none">custom<replaceable>XXX</replaceable></literal>
	    (that can be defined in the configuration file using 
	    <literal moreinfo="none">CustomColor<replaceable>XXX</replaceable></literal>
	    configuration option), or
	    an RGB value specified as
	    <literal moreinfo="none">#<replaceable>RRGGBB</replaceable></literal>,
	    where <replaceable>RR</replaceable>,
	    <replaceable>GG</replaceable>,
	    <replaceable>BB</replaceable> are hexadecimal numbers
	      from 00 to FF representing respectively the red, green, and blue
	    components of the color.
	  </para>
	</listitem>
	</varlistentry>
	<varlistentry>
	<term><literal moreinfo="none">#{<replaceable>object</replaceable>-<replaceable>feature</replaceable>:<replaceable>value</replaceable>}</literal></term>
	<listitem>
	  <para>
	    These instructions may affect appearence of
	    all elements of the tree. They should be used within
	    <literal moreinfo="none">style</literal>
	    and <literal moreinfo="none">rootstyle</literal> labeled patterns only, but
	    may be created dynamically utilizing the <literal moreinfo="none">&lt;?
	    ... ?&gt;</literal> perl-code evaluation.
	  </para>
	  <para>See <xref linkend="style-instructions"/> for
	    list of <replaceable>objects</replaceable>,
	    their <replaceable>features</replaceable> and
	    possible <replaceable>values</replaceable>.
	  </para>
	</listitem>
      </varlistentry>
	<varlistentry>
	  <term>any other text</term>
	  <listitem>
	    <para>
	      Any other text occuring within a
	      <literal moreinfo="none">node:</literal>, <literal moreinfo="none">edge:</literal>,
	      <literal moreinfo="none">text:</literal>, or <literal moreinfo="none">hint:</literal>
	      pattern is render as is (using the default font and
	      the default or previously selected color and styling).
	      Plain text occuring in a 
	      <literal moreinfo="none">style:</literal> or
	      <literal moreinfo="none">root-style:</literal>
	      pattern is ignored (note however that this may change
	      in the future versions).
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term>white space</term>
	  <listitem>
	    <para>Leading and trailing white space of a pattern is
	    ignored. To all other occurences of white-space the above
	    rule for any other text applies.
	    </para>
	  </listitem>
	</varlistentry>
    </variablelist>
    <table id="style-instructions">
      <title>Styling instructions</title>
	<tgroup cols="2">
	  <colspec colnum="1" align="left"/>
	  <colspec colnum="2" align="justify"/>
	  <thead>
	  <row>
	    <entry><replaceable>object</replaceable>-<replaceable>feature</replaceable></entry>
	    <entry>Description and a list of possible values</entry>
	  </row>
	</thead>
	<tbody>
	  <row>
	    <entry><literal moreinfo="none">Node-shape</literal></entry>
	    <entry>
	      <para>The shape of the point representing the node in
		the tree. Possible values are <literal moreinfo="none">oval</literal>,
		<literal moreinfo="none">rectangle</literal>, and
		<literal moreinfo="none">polygon</literal>
		(see also <literal moreinfo="none">Node-polygon</literal> below).
	      </para>
	    </entry>
          </row>
	  <row>
	    <entry><literal moreinfo="none">Node-polygon</literal></entry>
	    <entry><para>
		Specifies the relative coordinates for three or
		more points that define a closed polygon. The
		first and last points may be the same;  whether they are
		or not, TrEd will draw the polygon as a closed polygon.
	      </para></entry>
	  </row>
	  <row>
	    <entry><literal moreinfo="none">Node-width</literal></entry>
	    <entry>
	      <para>Width of an oval- or rectangle-shaped node.</para>
	    </entry>
          </row>
	  <row>
	    <entry><literal moreinfo="none">Node-height</literal></entry>
	    <entry>
	      <para>Height of an oval- or rectangle-shaped node.</para>
	    </entry>
          </row>
	  <row>
	    <entry><literal moreinfo="none">Node-currentwidth</literal></entry>
	    <entry>
	      <para>Width of an oval- or rectangle-shaped node
	      when current.</para>
	    </entry>
          </row>
	  <row>
	    <entry><literal moreinfo="none">Node-currentheight</literal></entry>
	    <entry>
	      <para>Height of the node an oval- or
	      rectangle-shaped node when current.</para>
	    </entry>
          </row>
	  <row>
	    <entry><literal moreinfo="none">Node-addwidth</literal></entry>
	    <entry>
	      <para>Increase width of an oval- or rectangle-shaped node
	      by a given amount.</para>
	    </entry>
          </row>
	  <row>
	    <entry><literal moreinfo="none">Node-addheight</literal></entry>
	    <entry>
	      <para>Increase height of an oval- or rectangle-shaped
	      node by a given
	      amount.</para>
	    </entry>
          </row>
	  <row>
	    <entry><literal moreinfo="none">Node-rellevel</literal></entry> <entry><para> Allows altering
		the default vertical position of a subtree. 
		The values are multiples of one default level height.
		Positive values move the subtree down, while negative values
		move the subtree up. </para></entry>
	  </row>
	  <row>
	    <entry><literal moreinfo="none">Node-level</literal></entry> <entry>
	      <para>
		Very similar to <literal moreinfo="none">Node-rellevel</literal>
		above, except that this option affects one node only 
		rather than the whole subtree.
	      </para>
	    </entry>
	  </row>
	  <row>
	    <entry><literal moreinfo="none">Node-addbeforeskip</literal></entry>
            <entry><para>Additional horizontal space before node
		in pixels</para></entry>
	  </row>
	  <row>
	    <entry><literal moreinfo="none">Node-addafterskip</literal></entry>
	    <entry><para>Additional horizontal space after node
		in pixels</para></entry>
          </row>
	  <row>
	    <entry><literal moreinfo="none">Node-disableedgelabelspace</literal></entry>
	    <entry><para>If set the value is <quote><literal moreinfo="none">yes</literal></quote>
		no additional horizontal skip for
		edge labels is added during
		positioning the node.
	      </para></entry>
          </row>
	  <row>
	    <entry><literal moreinfo="none">NodeLabel-valign</literal></entry>
	    <entry><para>This instruction
		may be used only within <literal moreinfo="none">rootstyle</literal>
		patterns.
		It takes one of the following
		values: <quote><literal moreinfo="none">top</literal></quote>,
		<quote><literal moreinfo="none">center</literal></quote>,
		and <quote><literal moreinfo="none">bottom</literal></quote>. 
		This feature specifies which side of the group of
		node labels should be placed towards the node. 
		If <quote><literal moreinfo="none">top</literal></quote> is selected
		(which is the default value), node labels appear
		below the node. If
		<quote><literal moreinfo="none">bottom</literal></quote>
		is selected, node labels are displayed
		above the node.	If the value of
		<quote><literal moreinfo="none">center</literal></quote>
		is used, node labels are displayed
		across the node.	
	      </para></entry>
          </row>
	  <row>
	    <entry><literal moreinfo="none">NodeLabel-halign</literal></entry>
	    <entry><para>One of the following values
		may be used: <quote><literal moreinfo="none">left</literal></quote>,
		<quote><literal moreinfo="none">center</literal></quote>,
		and <quote><literal moreinfo="none">right</literal></quote>. 
		This feature specifies which side of the group of
		node labels should be placed towards the node. 
		E.g, if <quote><literal moreinfo="none">right</literal></quote> is selected
		(which is the default value), node labels appear
		left of the node.
	      </para></entry>
          </row>
	  <row>
	    <entry><literal moreinfo="none">NodeLabel-yadj</literal></entry>
	    <entry><para>Adjust vertical position of node labels
		by extra amount of pixels.
	      </para></entry>
          </row>
	  <row>
	    <entry><literal moreinfo="none">NodeLabel-dodrawbox</literal></entry>
	    <entry><para>If <menuchoice moreinfo="none">
		  <guimenu moreinfo="none">View</guimenu>
		  <guimenuitem moreinfo="none">Draw boxes around labels</guimenuitem>
		</menuchoice>
		is not selected and this instruction
		is set to
		<quote><literal moreinfo="none">yes</literal></quote> for a given node ,
		box is still drawn around the node's labels.
	      </para></entry>
          </row>
	  <row>
	    <entry><literal moreinfo="none">NodeLabel-nodrawbox</literal></entry>
	    <entry><para>
		If <menuchoice moreinfo="none">
		  <guimenu moreinfo="none">View</guimenu>
		  <guimenuitem moreinfo="none">Draw boxes around labels</guimenuitem>
		</menuchoice>
		is selected and this instruction
		 is set to
		<quote><literal moreinfo="none">yes</literal></quote> for a given node,
		no box is drawn around the node's labels.
	      </para></entry>
          </row>
	  <row>
	    <entry><literal moreinfo="none">EdgeLabel-yadj</literal></entry>
	    <entry><para>Adjust vertical position of edge labels
		by extra amount of pixels.
		The horizontal position is adjusted automatically.
	      </para></entry>
          </row>
	  <row>
	    <entry><literal moreinfo="none">EdgeLabel-coords</literal></entry> 
	    <entry><para> This option
		can be used to specify custom (non-standard) positioning
		of the edge label by specifying the exact point to which
		the edge label is anchored.  The format of this option is
		similar to <literal moreinfo="none">Line-coords</literal>, except that
		only one pair of coordinates (X,Y) is allowed. See <link linkend="Line-coords">Line-coords</link> for more
		information.
	      </para>
	    </entry>
	  </row>
	  <row>
	    <entry><literal moreinfo="none">EdgeLabel-halign</literal></entry>
	    <entry><para>One of 
		the values <quote><literal moreinfo="none">right</literal></quote>,
		<quote><literal moreinfo="none">center</literal></quote>,
		and <quote><literal moreinfo="none">left</literal></quote>
		may be used to specify which side of the edge label
		should be oriented towards the edge.
	      </para></entry>
          </row>
	  <row>
	    <entry><literal moreinfo="none">EdgeLabel-valign</literal></entry>
	    <entry><para>One of 
		the values <quote><literal moreinfo="none">top</literal></quote>,
		<quote><literal moreinfo="none">center</literal></quote>,
		and <quote><literal moreinfo="none">bottom</literal></quote>
		may be used to specify which side of the edge label
		should be oriented towards the edge.
	      </para></entry>
          </row>
	  <row>
	    <entry><literal moreinfo="none">EdgeLabel-dodrawbox</literal></entry>
	    <entry><para>If <menuchoice moreinfo="none">
		  <guimenu moreinfo="none">View</guimenu>
		  <guimenuitem moreinfo="none">Draw boxes around edge
		    labels</guimenuitem>
		</menuchoice>
		  is not selected and this instruction
		is set to
		<quote><literal moreinfo="none">yes</literal></quote> for a given node ,
		box is still drawn around the node's edge labels.
	      </para></entry>
          </row>
	  <row>
	    <entry><literal moreinfo="none">EdgeLabel-nodrawbox</literal></entry>
	    <entry><para>If <menuchoice moreinfo="none">
		  <guimenu moreinfo="none">View</guimenu>
		  <guimenuitem moreinfo="none">Draw boxes around edge
		    labels</guimenuitem>
		</menuchoice>
		is selected and this instruction
		is set to
		<quote><literal moreinfo="none">yes</literal></quote> for a given node,
		no box is drawn around the node's edge labels.</para></entry>
          </row>
	  <row>
	    <entry><literal moreinfo="none">Oval-dash</literal></entry>
	    <entry><para>Dash pattern for the outline
	      of the point representing the node of the tree.
	      A dash pattern is either a sequence of arbitrary
		of the following characters <quote>.,-_</quote>
		where space can be used
		to enlarge the space between other line elements, and can
		not occur as the first position in the string, or
		a comma-separated list of integer numbers
		specifying the lengths of dashes and spaces between them. 
	      </para></entry>
          </row>
	  <row>
	    <entry><literal moreinfo="none">Oval-activedash</literal></entry>
	    <entry><para>Dash pattern for the outline
	      of the point when mouse is over the point. See
	      description of <literal moreinfo="none">Oval-dash</literal>
		for more information on dash patterns.
	      </para></entry>
          </row>
	  <row>
	    <entry><literal moreinfo="none">Oval-dashoffset</literal></entry>
	    <entry><para>The starting offset (in pixels)
		into the pattern provided by the
		<literal moreinfo="none">Oval-dash</literal> instruction.		
	      </para></entry>
          </row>
	  <row>
	    <entry><literal moreinfo="none">Oval-fill</literal></entry>
	    <entry><para>The color that fills the
		node.
	      </para></entry>
          </row>
	  <row>
	    <entry><literal moreinfo="none">Oval-activefill</literal></entry>
	    <entry><para>The color to fill the node
	      when mouse is over it.</para></entry>
          </row>
	  <row>
	    <entry><literal moreinfo="none">Oval-outline</literal></entry>
	    <entry><para>The color of the outline
		of the node.
	      </para></entry>
          </row>
	  <row>
	    <entry><literal moreinfo="none">Oval-activeoutline</literal></entry>
	    <entry><para>The color of the outline
		of the node when mouse is over it.
	      </para>
	    </entry>
          </row>
	  <row>
	    <entry><literal moreinfo="none">Oval-width</literal></entry>
	    <entry><para>Width of the outline
		of the node.</para></entry>
          </row>
	  <row>
	    <entry><literal moreinfo="none">Oval-activewidth</literal></entry>
	    <entry><para>Width of the outline
		of the node when mouse is over it.</para></entry>
          </row>
	  <row id="Line-coords">
	    <entry><literal moreinfo="none">Line-coords</literal></entry>
	    <entry><para>
		This, very complex, option allows to setup
		one or more lines leading from the node. Unless this
		option is set, only a line (edge) starting at the
		node and leading to its parent is drawn.
	      </para>
	      <para>
		This option may consist of one or more 
		tuples of coordinates separated with
		<literal moreinfo="none">&amp;</literal>
		of the form <literal moreinfo="none">x1, y1..., xn, yn</literal>,
		where
		x1 through yn give the coordinates for a
		series of two or more points that describe a series of
		connected line segments.
	      </para>
	      <para>
		The coordinates may be either absolute or relative to
		the node, its parent, or if necessary to any node in
		the tree. In fact, usual arithmetic expressions may be
		used to compute coordinates. Use letter
		<literal moreinfo="none">n</literal> to refer to the coordinate of the
		current node on the current axes and letter
		<literal moreinfo="none">p</literal> to refer to the coordinate of the
		parent node of the current node.  Use
		<literal moreinfo="none">xn</literal> and <literal moreinfo="none">yn</literal>, or
		<literal moreinfo="none">xp</literal> and <literal moreinfo="none">yp</literal> to
		refer to a coordinate of the current node or its
		parent (resp.) on an explicit axis.
		</para>
	      <para>		
		Coordinates of other nodes may be queried
		using the following constructions:
		<variablelist>
		  <varlistentry>
		    <term>Simple search</term>
		    <listitem>
		      <para>
			The construction of the form
			<literal moreinfo="none">x[attribute_name = value]</literal>
			or
			<literal moreinfo="none">y[attribute_name = value]</literal>
			may be used to query x-coordinate
			or y-coordinate (respectively)
			of the first node whose attribute
			<literal moreinfo="none">attribute_name</literal>
			has the given <literal moreinfo="none">value</literal>.
		      </para>
		    </listitem>
		  </varlistentry>
		  <varlistentry>
		    <term>Simple perl search</term>
		    <listitem>
		      <para>
			The construction of the form
			<literal moreinfo="none">x[? code ?]</literal>
			or
			<literal moreinfo="none">y[? code ?]</literal>
			may be used to query a
			coordinate 			
			of the first node for which the
			given Perl code returns non-zero
			defined value. Within the code,
			use 
			<literal moreinfo="none">$this</literal> to refer
			to the current node and
			<literal moreinfo="none">$node</literal>
			to the node being tested.
		      </para>
		    </listitem>
		  </varlistentry>
		  <varlistentry>
		    <term>Custom perl search</term>
		    <listitem>
		      <para>
			Sometimes it is not necessary to
			go through the whole tree to find the desired
			node. In such a case, the user may provide
			a code that finds the node
			and returns it.
			This type of query has the form
			<literal moreinfo="none">x[! code !]</literal> or
			<literal moreinfo="none">y[! code !]</literal>,
			where <literal moreinfo="none">code</literal>
			is the user's custom node search algorithm
			written in Perl.
			Within the code, use 
			<literal moreinfo="none">$this</literal> to refer
			to the current node.
		      </para>
		    </listitem>
		  </varlistentry>
		</variablelist>
	      </para>
	    </entry>
          </row>
	  <row>
	    <entry><literal moreinfo="none">Line-arrow</literal></entry>
	    <entry><para>One of the values
		<quote><literal moreinfo="none">first</literal></quote>,
		<quote><literal moreinfo="none">both</literal></quote>,
		<quote><literal moreinfo="none">last</literal></quote>,
		may be used to make arrow to be drawn
		on one or both sides of the edge connecting
		the given node with its parent.
	      </para>
	    </entry>
          </row>
	  <row>
	    <entry><literal moreinfo="none">Line-smooth</literal></entry>
	    <entry><para>Values are 1 or 0.
              It indicates whether or not the line should be drawn as a curve.  If
              so, the line is rendered as a set of parabolic splines: one spline
              is drawn for the first and second line segments, one for the second
              and third, and so on.  Straight-line segments can be generated
              within a curve by duplicating the end-points of the desired line
              segment.
              </para>
	    </entry>
	  </row>
	  <row>
	    <entry><literal moreinfo="none">Line-</literal><replaceable>feature</replaceable></entry>
	    <entry><para>Features
		<literal moreinfo="none">dash</literal>,
		<literal moreinfo="none">activedash</literal>,
		<literal moreinfo="none">fill</literal>,
		<literal moreinfo="none">activefill</literal>,
		<literal moreinfo="none">width</literal>, and
		<literal moreinfo="none">activewidth</literal>
		may be used to style the edge. Their values and
		meaning is similar to those of <literal moreinfo="none">Oval</literal>,
		as described above.
	      </para></entry>
          </row>
	  <row>
	    <entry><literal moreinfo="none">Text<replaceable>&lt;position&gt;</replaceable>-fill</literal></entry>
	    <entry><para>
		This feature may be used to set the color of a certain
		text object. The object is determined by its
		<replaceable>position</replaceable> which may have one
		of the following forms:
		<literal moreinfo="none">[<replaceable>attribute-name</replaceable>]</literal>,
		<literal moreinfo="none">[<replaceable>attribute-name</replaceable>][<replaceable>n</replaceable>]</literal>,
		or
		<literal moreinfo="none">[<replaceable>attribute-name</replaceable>][<replaceable>n</replaceable>][<replaceable>m</replaceable>]</literal>,
		where <replaceable>attribute-name</replaceable>
		is name of an attribute,
		<replaceable>n</replaceable> is the ordinal number of
		pattern which is the source of the text object
		and <replaceable>m</replaceable> is ordinal number
		of the attribute reference (<literal moreinfo="none">${<replaceable>attribute-name</replaceable>}</literal>) within that pattern.
	      </para></entry>
          </row>
	  <row>
	    <entry><literal moreinfo="none">Text<replaceable>&lt;position&gt;</replaceable>-activefill</literal></entry>
	    <entry><para>This feature may be used to set the color of a certain
		text object when mouse is over it.
		The syntax of <replaceable>position</replaceable>
		is as above.
	      </para></entry>
          </row>
	  <row>
	    <entry><literal moreinfo="none">TextBg<replaceable>&lt;position&gt;</replaceable>-<replaceable>feature</replaceable></literal></entry>
	    <entry><para>This instruction may be used to set features
		of an underlying rectangle of certain
		text object.
		The syntax of <replaceable>position</replaceable>
		is as above, except that only the first
		two forms are accepted, because text objects
		appearing on one line have common underlying rectangle.
		The following features are supported:
		<literal moreinfo="none">dash</literal>,
		<literal moreinfo="none">activedash</literal>,
		<literal moreinfo="none">dashoffset</literal>,
		<literal moreinfo="none">fill</literal>,
		<literal moreinfo="none">activefill</literal>,
		<literal moreinfo="none">outline</literal>,
		<literal moreinfo="none">activeoutline</literal>,
		<literal moreinfo="none">width</literal>, and
		<literal moreinfo="none">activewidth</literal>.
	      </para></entry>
          </row>
	  <row>
	    <entry><literal moreinfo="none">TextBox-<replaceable>feature</replaceable></literal></entry>
	    <entry><para>This instruction may be used to set features
		of the frame drawn around the group of node labels.
		The following features are supported:
		<literal moreinfo="none">dash</literal>,
		<literal moreinfo="none">activedash</literal>,
		<literal moreinfo="none">dashoffset</literal>,
		<literal moreinfo="none">fill</literal>,
		<literal moreinfo="none">activefill</literal>,
		<literal moreinfo="none">outline</literal>,
		<literal moreinfo="none">activeoutline</literal>,
		<literal moreinfo="none">width</literal>, and
		<literal moreinfo="none">activewidth</literal>.
	      </para>
	    </entry>
          </row>
	  <row>
	    <entry><literal moreinfo="none">EdgeTextBox-<replaceable>feature</replaceable></literal></entry>
	    <entry><para>This instruction may be used to set features
		of the frame drawn around the group of node's edge
		labels. The list of supported features is the same as
		that of <literal moreinfo="none">TextBox</literal>.
	      </para>
	    </entry>
          </row>
	</tbody>
      </tgroup>
    </table>
    </section>
  </section>
  <section id="printing">
    <title>Printing Trees</title>
    <para>
      <application moreinfo="none">TrEd</application> is
      able to render trees to PostScript,
      Encapsulated PostScript (EPS), and Portable
      Document Format (PDF). 
      Should the trees contain non-latin
      (iso-8859-1, iso-8859-2, windows-1250, etc.) characters,
      such as Arabic, the PDF might be the only option,
      because of its support for TrueType fonts.
    </para>
    <para>
      If <ulink url="http://www.imagemagick.org">ImageMagick</ulink>
      toolkit is installed, TrEd can also automatically convert the
      result into one of many bitmap image formats supported by this
      toolkit.</para>
    <para>  While PostScript is the default printing format on
      most Unix/Linux systems (and can be printed using the standard
      <command moreinfo="none">lpr</command> command), Windows users
      may use for example <ulink
      url="http://www.adobe.com/products/acrobat/readermain.html">Adobe
      Acrobat Reader</ulink> to preview and print trees rendered into
      PDF. There are also some free PostScript interpreters for
      Windows (see <ulink
      url="http://www.cs.wisc.edu/~ghost/">GhostView</ulink>).
    </para>
    <figure float="0">
      <title>Print dialog
      </title>
      <mediaobject><imageobject><imagedata fileref="pics/tredprint.png" format="PNG" role="html"/></imageobject><imageobject><imagedata fileref="pics/tredprint.eps" format="EPS" role="latex" width="13cm"/></imageobject><imageobject><imagedata fileref="pics/tredprint" format="linespecific"/></imageobject></mediaobject>
    </figure>
    <para>
      Encapsulated PostScript files (<literal
      moreinfo="none">EPS</literal>) are especially useful for
      preparation of other printed materials e.g. <application
      moreinfo="none">PDF</application> of <application
      moreinfo="none">LaTeX</application> documents. Compared to
      bitmapped images, EPS images have the advantage of being
      scalable.  Most office suits (such as Microsoft Office and
      OpenOffice.org) have at least limited support for EPS.  Similar
      results can be obtained by using <application>PDF</application>
      with <literal>BBox</literal> media size.
    </para>
    <note>
      <para>
	TrEd's ability to render PostScript
	and EPS is limitted to Eastern European character sets.
	For other charsets and unicode (especially when TrEd
	runs on a unicode aware versions of
	<literal moreinfo="none">Perl</literal> and <literal moreinfo="none">Tk</literal>,
	i.e. at least <literal moreinfo="none">Perl 5.8</literal> and
	<literal moreinfo="none">Tk804</literal>), PDF print format is recommended.
      </para>
    </note>
    <para>
      Printing into PDF requires a TrueType font containing at
      least the glyphs used in the tree.  For most languages,
      the usual fonts such as Arial
      (<literal moreinfo="none">arial.ttf</literal>), Times New Roman
      (<literal moreinfo="none">times.ttf</literal>) or Bitstream Vera
      (<literal moreinfo="none">vera.ttf</literal>) are sufficient while other
      languages, such as Arabic, require a fully featured
      Unicode font such as <literal moreinfo="none">Arial Unicode MS</literal>.
      The TrueType font can be specified either directly
      from the Print dialog or by setting <link linkend="ttfont"><literal moreinfo="none">TTFont</literal></link>
      configuration option. If <literal moreinfo="none">TTFont</literal>
      is not given, it defaults to <literal moreinfo="none">Arial</literal>. 
      TrEd searches for TrueType fonts in directories listed in
      <link linkend="ttfontpath"><literal moreinfo="none">TTFontPath</literal></link>
      configuration option. If this option is not explicitly
      specified, TrEd uses directories listed in 
      fontconfig library configuration file
      <literal moreinfo="none">/etc/fonts/fonts.conf</literal> on Unix
      and Windows system font directory on Windows.
      If no usable font is found, PDF printing is disabled.
    </para>
    <para>
      For PostScript printing, <application moreinfo="none">TrEd</application>
      uses a Type1 font.  The file containing the font may be
      specified using the <link linkend="psfontfile"><literal moreinfo="none">PsFontFile</literal></link>
      (and optionally <link linkend="psfontafmfile"><literal moreinfo="none">PsFontAFMFile</literal></link>)
      configuration option.
    </para>
    <itemizedlist>
      <listitem>
	<para>
	  In the <guilabel moreinfo="none">Print</guilabel> dialog you can specify a printing command to
	  be used or (if <guilabel moreinfo="none">Print to file</guilabel> is checked) a filename of the
	  destination file.
	</para>
      </listitem>
      <listitem>
	<para>
	  You can also specify a media-type (paper format)
	  in the <guilabel moreinfo="none">Media</guilabel> roll-out menu, page
	  width and height (in case of <literal moreinfo="none">User</literal>
	  media-type), and horizontal and vertical margins.
	  If the printed tree exceeds specified page
	  boundaries, it is automatically shrunk and
	  (unless <guilabel moreinfo="none">Disable landscape rotation of wide
	    trees</guilabel> is selected) rotated to fit on the
	  page. See <link linkend="psmedia"><literal moreinfo="none">PSMedia</literal></link>
	  configuration option for a list of supported media
	  formats.
	</para>
      </listitem>
      <listitem>
	<para>
	  The output format is specified by
	  selecting one of <guilabel moreinfo="none">Create PostScript</guilabel>,
	  <guilabel moreinfo="none">Create EPS</guilabel>, <guilabel moreinfo="none">Create
	    PDF</guilabel> and  <guilabel moreinfo="none">Convert according to
	    ImageMagick</guilabel> buttons.
	</para>
      </listitem>
      <listitem>
	<para>If <ulink url="http://www.imagemagick.org">ImageMagick</ulink>
	  utilities are installed on the system,
	  then automatic conversion to one of many image formats
	  is supported. To use it, first check the
	  <guilabel moreinfo="none">Convert according to file
	    extension</guilabel> button, then select a desired
	  pixel resolution for conversion to bitmap, and finally
	  edit the output filename extension to that of the
	  desired output file-format such as
	  <filename moreinfo="none">.png</filename> or
	  <filename moreinfo="none">.jpg</filename>.  When converting
	  to a bitmap, <guilabel moreinfo="none">Resolution</guilabel> may be specified to
	  adjust the mapping between PostScript coordinate
	  system units (given in 1/72 inch) to raster pixels.
	</para>
      </listitem>
      <listitem>
	<para>
	  If you also want the <quote>sentence</quote> of the tree
	  (i.e. the usual context of the text window above the tree)
	  to be printed under the tree, check the <guilabel
	  moreinfo="none">Print sentence</guilabel> button.
	</para>
      </listitem>
      <listitem>
	<para>
	  It is possible to print more than one tree (each tree then
	  appears on a separate page).  To do so, a comma-separated
	  list of tree numbers or ranges of tree numbers that
	  correspond to the desired trees in the active file, must be
	  entered into the <guilabel moreinfo="none">Page
	  range</guilabel> field.  The
	  <inlinemediaobject><imageobject><imagedata
	  fileref="pics/1leftarrow.png" format="PNG"
	  role="html"/></imageobject><imageobject><imagedata
	  fileref="pics/1leftarrow.eps" format="EPS"
	  role="latex"/></imageobject><imageobject><imagedata
	  fileref="pics/1leftarrow"
	  format="linespecific"/></imageobject></inlinemediaobject>
	  button is be used to automatically insert a page range
	  corresponding to sentences selected via <link
	  linkend="list_of_sentences"><menuchoice moreinfo="none">
	  <guimenu moreinfo="none">View</guimenu> <guimenuitem
	  moreinfo="none">List of sentences...</guimenuitem>
	  </menuchoice></link>. A different selection based on
	  <quote>sentences</quote> can be made by pressing the button
	  <inlinemediaobject><imageobject><imagedata
	  fileref="pics/contents.png" format="PNG"
	  role="html"/></imageobject><imageobject><imagedata
	  fileref="pics/contents.eps" format="EPS"
	  role="latex"/></imageobject><imageobject><imagedata
	  fileref="pics/contents"
	  format="linespecific"/></imageobject></inlinemediaobject>.
	</para>
      </listitem>
      <listitem>
	<para id="page_range">
	  If entered manually, the page range must be specified
	  according to the following rules: Trees in the file are
	  numbered starting from 1. Ranges are pairs of numbers of the
	  form <quote><literal moreinfo="none">3-20</literal></quote>
	  (which in this case covers all trees starting from the tree
	  no. 3 to no. 20).  If the first number in the range is
	  omitted, 1 is assumed. If the second number in the range is
	  ommited, the number of the last tree in the active file is
	  assumed.  The order of the tree numbers given in the list is
	  strictly reflected in the output file, which also means that
	  ceratin tree can be printed more than once.
	  <note>
	    <title>Example:</title>
	    <para>
	      To print trees from 1 to 5, then trees no. 7, 11, 12 and 5
	      again, use e.g. one of the following lists:
	      <simplelist type="vert">
		<member><literal moreinfo="none">1-5,7,11,12,5</literal></member>
		<member><literal moreinfo="none">1-5,7,11-12,5</literal></member>
		<member><literal moreinfo="none">-5,7,11-12,5</literal></member>
	      </simplelist>
	    </para>
	  </note>
	</para>
      </listitem>
    </itemizedlist>
    <note>
      <para>
	Printing trees can also be automated by writing a suitable
	macro. For this purpose, TrEd API offers the function
	<literal moreinfo="none">Print</literal> (see <xref linkend="defaultmacros"/>). This function however requires
	TrEd GUI, i.e. it cannot be run in <command moreinfo="none">btred</command>.
      </para>
      <example>
	<title>Printing trees from a user-defined macro</title>
	<programlisting format="linespecific">
	  <![CDATA[
# bind key p to CreateImages menu Create bitmap images of all trees
sub CreateImages {
   GotoTree(1);
   my $tree_no = 1;
   my $name = FileName();
   $name =~ s/\..*//; # strip filename suffix
   do {{
      TredMacro::Print(
	 -toFile => 1,
	 -format => 'ImageMagick',
	 -imageMagickResolution => 90,
	 -colors => 1,
	 -sentenceInfo => 1,
	 -filename => "${name}_${tree_no}.png"
       );
      $tree_no++;
   }} while NextTree();
}	  
]]>
	</programlisting>
      </example>
    </note>
  </section>
  

  <section id="filelists">
    <title>Using File-Lists</title>
    <para>
      File-list is simply a named list of file-name patterns or actual
      file names (possibly with extra suffixes attached to them
      specifying certain tree or node by its position in the
      file - see the file-name handling conventions described in <xref
	linkend="commandline"/>). File-lists can be created, modified, saved or deleted in
      a file-list editor accessible via <menuchoice moreinfo="none">
      <guimenu moreinfo="none">File</guimenu> <guimenuitem
      moreinfo="none">File List...</guimenuitem> </menuchoice>
      menu-command.
    </para>
    <para>
      File-lists can serve several purposes, the most common of which
      are searching and comfortable editing series of files.  Each
      view is associated with a file-list. For the active view, we
      call that file-list the current file-list. Name of the
      current-filelist is displayed at the title of the main
      <application moreinfo="none">TrEd</application>'s window.  If
      current file-list contains more than one file, the commands
      <menuchoice moreinfo="none"> <guimenu
      moreinfo="none">File</guimenu> <guimenuitem
      moreinfo="none">Previous File</guimenuitem> </menuchoice> (or
      <inlinemediaobject><imageobject><imagedata
      fileref="pics/start.png" format="PNG"
      role="html"/></imageobject><imageobject><imagedata
      fileref="pics/start.eps" format="EPS"
      role="latex"/></imageobject><imageobject><imagedata
      fileref="pics/start"
      format="linespecific"/></imageobject></inlinemediaobject>
      button) and <menuchoice moreinfo="none"> <guimenu
      moreinfo="none">File</guimenu> <guimenuitem moreinfo="none">Next
      File</guimenuitem>
    </menuchoice>
      (or <inlinemediaobject><imageobject><imagedata fileref="pics/finish.png" format="PNG" role="html"/></imageobject><imageobject><imagedata fileref="pics/finish.eps" format="EPS" role="latex"/></imageobject><imageobject><imagedata fileref="pics/finish" format="linespecific"/></imageobject></inlinemediaobject> button)
      can be used to open previous and next file in the file-list, respectively.
    </para>
    <figure float="0">
      <title>Creating file-lists</title>
      <mediaobject><imageobject><imagedata fileref="pics/filelist.png" format="PNG" role="html"/></imageobject><imageobject><imagedata fileref="pics/filelist.eps" format="EPS" role="latex" width="13cm"/></imageobject><imageobject><imagedata fileref="pics/filelist" format="linespecific"/></imageobject></mediaobject>
    </figure>
    <para>
      The following file-lists are created and managed automatically
      by <application>TrEd</application>:
    </para>
    <variablelist>
      <varlistentry>
	<term><literal moreinfo="none">Default</literal></term>
	<listitem>
	  <para>
	    This file-list contains files opened with <menuchoice>
	    <guimenu>File</guimenu> <guimenuitem>Open
	    ...</guimenuitem> </menuchoice> during the current session
	    up to the moment.
	  </para>
	</listitem>	
      </varlistentry>
      <varlistentry>
	<term><literal moreinfo="none">CmdLine-<replaceable>n</replaceable></literal></term>
	<listitem>
	  <para>
	    This file-list contains files specified either directly on
	    the command line or in file(s) following the command-line
	    option <parameter>-l</parameter>. <replaceable>n</replaceable> is
	    an integer number starting from 1 (files from the
	    <replaceable>n</replaceable>-th file specified in
	    <parameter>-l</parameter> appear in the file-list
	    <literal>CmdLine-<replaceable>n</replaceable></literal>).
	  </para>
	</listitem>	
      </varlistentry>
      <varlistentry>
	<term><literal moreinfo="none">Bookmarks</literal></term>
	<listitem>
	  <para>
	    The <literal moreinfo="none">Bookmarks</literal> file-list
	    conains all bookmarks.
	  </para>
	</listitem>
      </varlistentry>
    </variablelist>
    <para>
      To create a user-defined file-list, open the <guilabel moreinfo="none">Filelist</guilabel> dialog, Type a name
      of the file-list into the <guilabel moreinfo="none">File lists</guilabel> field
      (on the top right side), press <keycap moreinfo="none">Enter</keycap> and
      confirm the creation by pressing the
      <guibutton moreinfo="none">Create</guibutton> button in the
      confirmation dialog which pops up.
      Alternativelly, press the <guibutton moreinfo="none">New</guibutton> button,
      fill the name of the new file-list to the entry in the displayed
      dialog and press <guibutton moreinfo="none">OK</guibutton>.
    </para>
    <para>
      To modify an existing file-list, first choose it from the menu
      that appears when the button on the right of the <guilabel moreinfo="none">File
      lists</guilabel> entry is pressed.  To add some files to the
      chosen file-list, first browse the files in the list on the left
      of the <guilabel moreinfo="none">Filelist</guilabel> dialog. Then select the
      desired files in this list and finally press the
      <guibutton moreinfo="none">Add--&gt;</guibutton>.  If the selection contains a
      directory, user is prompted for a wild-card pattern and all
      files from the directory matching the pattern are added to the
      file-list. This is a very convenient way for adding all files in
      a directory. This has also the advantage that any change made in
      the content of the directory automatically leads to the
      corresponding effect in the file-list.
    </para>
    <para>
      To remove files from the file-list, select the files and
      press the <guibutton moreinfo="none">Remove</guibutton> button.
    </para>
    <para>
      To make certain file-list the current file-list for <application
      moreinfo="none">TrEd</application> double-click on any file in
      the file-list or just select the file and press <guibutton
      moreinfo="none">Show in TrEd</guibutton>. The selected file is
      opened and the file-list is made current.
    </para>
    <note>
      <para>It is possible to switch between several file-lists
	without entering the file-list editor described in this
	section, simply by selecting other file-list from the <guimenu
	moreinfo="none">Session</guimenu> menu.
      </para>
    </note>
    <para>
      The button <guibutton moreinfo="none">Save</guibutton> is used
      to save the chosen file-list to a file, so that it can be either
      automatically or manually opened in the next <application
      moreinfo="none">TrEd</application>'s session. Note that the
      <literal moreinfo="none">Bookmark</literal> file-list is saved
      automatically at the end of every
      <application>TrEd</application> session.
    </para>
    <para>
      The button <guibutton moreinfo="none">Delete</guibutton> makes
      <application>TrEd</application> forget about the selected
      file-list.  Note that deleting a file-list does not delete the
      file it was previously saved to.
    </para>
    <para>The <guibutton moreinfo="none">Load</guibutton> button can
      be used to load a previously saved file-list. Note that all
      saved file-lists that are known to <application
      moreinfo="none">TrEd</application> at the end of a session are
      automatically loaded at the start of the next <application
      moreinfo="none">TrEd</application>'s session.
    </para>
    <para>
      The button <guilabel moreinfo="none">Close</guilabel> closes the
      <guilabel moreinfo="none">Filelist</guilabel> dialog window.
    </para>
  </section>
  <section id="configuration">
    <title>Configuration and customization</title>
    <para>
      The configuration and customization of <application
      moreinfo="none">TrEd</application> is possible through modifying
      its configuration file. At the start of a session, <application
      moreinfo="none">TrEd</application> searches for its
      configuration file on several places and uses the first
      configuraton file found:
    </para>
    <orderedlist continuation="restarts" inheritnum="ignore">
      <listitem>
	<para>
	  First <application moreinfo="none">TrEd</application> looks for a file given with a command-line parameter
	  <parameter moreinfo="none">-c</parameter> (see <xref linkend="commandline"/> for details).
	</para>
      </listitem>
      <listitem><para>    
	If the <varname>HOME</varname> system variable is set (on UNIX/Linux this
	  variable points to user's home directory) <application moreinfo="none">TrEd</application> searches for
	<filename moreinfo="none">.tredrc</filename> (mind the dot
	  here) file in that directory. On Windows,
	  <application>TrEd</application> uses the <filename>Application Data</filename> folder in user's profile.
      </para>
      </listitem>
      <listitem><para>
	  If the <varname>TREDHOME</varname> system variable is set <application moreinfo="none">TrEd</application> searches for
	<filename moreinfo="none">tredrc</filename> file in that directory. 	
      </para></listitem>
      <listitem><para>
	  <application moreinfo="none">TrEd</application> looks for a <filename moreinfo="none">tredrc</filename> file in 
	  the directory where the program file of <application moreinfo="none">TrEd</application> itself is located.
      </para></listitem>
      <listitem>
	<para>
	  <application moreinfo="none">TrEd</application> looks for a
	  <filename moreinfo="none">tredrc</filename> file in directories
	  <filename moreinfo="none">../lib/tred</filename>, <filename moreinfo="none">../lib/tredlib</filename> and
	  <filename moreinfo="none">./tredlib/tredrc</filename> respectively, relative to the
	  directory of the program file of <application moreinfo="none">TrEd</application>.
	</para>
      </listitem>
      <listitem><para>
	  <application moreinfo="none">TrEd</application> looks for a <filename moreinfo="none">tredrc</filename> file in 
	  the <filename moreinfo="none">/usr/share/config/</filename> directory.
	</para></listitem>
    </orderedlist>
    <para>
      If none of these files is found, default values for configuration
      options are used.
    </para>
    <para>
      <application moreinfo="none">TrEd</application>'s configuration
      file is a plain text file with a very simple structure. It can
      be edited either in an external text editor (like <application
      moreinfo="none">vi</application>, <application
      moreinfo="none">Emacs</application> or <application
      moreinfo="none">Notepad</application>) or directly from TrEd in
      a built-in editor (<menuchoice moreinfo="none"> <guimenu
      moreinfo="none">File</guimenu> <guimenuitem moreinfo="none">Edit
      Config</guimenuitem></menuchoice>). In both cases
      there is a way to update the options used by a running session
      of <application moreinfo="none">TrEd</application>: </para>
    <itemizedlist>
      <listitem><para>Use <menuchoice moreinfo="none"> <guimenu
	    moreinfo="none">File</guimenu> <guimenuitem
	    moreinfo="none">Reload Config</guimenuitem></menuchoice>
	    menu command to make TrEd re-read the configuration file
	    from disk.</para></listitem> <listitem><para> In the
	    <application moreinfo="none">TrEd</application>'s built-in
	    configuration editor use the <guibutton
	    moreinfo="none">Save and Apply</guibutton> button to apply
	  changes and save them or <guibutton
	    moreinfo="none">Apply</guibutton> button to apply changes
	  withought saving them. In the latter case, all changes only apply for the 
	  current session and the configuration file is
	  untouched. As the built-in editor re-reads the configuration
	  file every time, all such changes are lost when the editor
	  is closed (although they still apply).
	  The first command also quits the configuration editor.
	</para>
      </listitem>
    </itemizedlist>
    <note>
      <para>
	Some configuration options only take effect after restarting
	<application moreinfo="none">TrEd</application>.
      </para>
    </note>
    <para>Each line in the configuration file
      has the following simple form:</para>
    <literallayout class="normal" format="linespecific"><replaceable>option_name</replaceable> = <replaceable>value</replaceable></literallayout>
    <para>
      There may be any amount of white-space between the option name
      and value but they must be both on the same line. Any characters
      folowing a semi-colon (<literal moreinfo="none">;</literal>) to
      the end of line are treated as a comment and hence ignored.
      It is possible to quote any value using either quotes or
      double-quotes, so that white-space and semi-colons are preserved
      correctly. All option names are case-insensitive. 
    </para>
    <para>
      Available configuration options may be divided into several categories:
    </para>
    <section>
    <title>Colors</title>
      <variablelist>
	<varlistentry id="backgroundcolor">
	  <term><literal moreinfo="none">BackgroundColor</literal></term>
	  <listitem>
	    <para>Background color of the tree-view canvas.</para>
	  </listitem>
	</varlistentry>
	<varlistentry id="backgroundimage">
	  <term><literal moreinfo="none">BackgroundImage</literal></term>
	  <listitem>
	    <para>This option allows specifying a background image
	      for the canvas on which trees are displayed. 
	      At present, only GIF, XBM, XPM, BMP, JPEG, PNG and
	      PPM/PGM files are supported.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="backgroundimagex">
	  <term><literal moreinfo="none">BackgroundImageX</literal></term>
	  <listitem>
	    <para>Horizontal offset of the background image.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="backgroundimagey">
	  <term><literal moreinfo="none">BackgroundImageY</literal></term>
	  <listitem>
	    <para>Vertical offset of the background image.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="highlightwindowcolor">
	  <term><literal moreinfo="none">HighlightWindowColor</literal></term>
	  <listitem>
	    <para>Color of the frame drawn around the focused view.</para>
	  </listitem>
	</varlistentry>
	<varlistentry id="currentnodecolor">
	  <term><literal moreinfo="none">CurrentNodeColor</literal></term>
	  <listitem>
	    <para>Color to draw the active node. Default is red.</para>
	  </listitem>
	</varlistentry>
	<varlistentry id="nearestnodecolor">
	  <term><literal moreinfo="none">NearestNodeColor</literal></term>
	  <listitem>
	    <para>Color to highlight the nearest node to indicate the
	      destination of a possible drop when dragging a node.</para>
	  </listitem>
	</varlistentry>
	<varlistentry id="bwprintnodecolor">
	  <term><literal moreinfo="none">BWPrintNodeColor</literal></term>
	  <listitem>
	    <para>Color used to fill nodes when printing in
	      black-and-white. Defaults to <literal moreinfo="none">white</literal>,
	      which results in nodes with only black outline. 
	      If set to <literal moreinfo="none">black</literal>, nodes are printed
	      as all-black objects without a visible outline.</para>
	  </listitem>
	</varlistentry>
	<varlistentry id="textcolor">
	  <term><literal moreinfo="none">TextColor</literal></term>
	  <listitem>
	    <para>Color used to display text of normal tree attributes.</para>
	  </listitem>
	</varlistentry>
	<varlistentry id="textcolorshadow">
	  <term><literal moreinfo="none">TextColorShadow</literal></term>
	  <listitem>
	    <para>Color used to display text of shadowed tree attributes.</para>
	  </listitem>
	</varlistentry>
	<varlistentry id="textcolorhilite">
	  <term><literal moreinfo="none">TextColorHilite</literal></term>
	  <listitem>
	    <para>Color used to display text of highlighted tree
	      attributes.</para>
	  </listitem>
	</varlistentry>
	<varlistentry id="textcolorxhilite">
	  <term><literal moreinfo="none">TextColorXHilite</literal></term>
	  <listitem>
	    <para>Color used to display text of extra-highlighted tree
	      attributes.
	      See <ulink url="http://quest.ms.mff.cuni.cz/pdt/Corpora/PDT_1.0/Doc/fs.html">FS-format
		description</ulink> to learn about how to specify which attributes
	      are shadowed, highlighted and extra-highlighted.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="customcolor">
	  <term><literal moreinfo="none">CustomColor<replaceable>name</replaceable></literal></term>
	  <listitem>
	    <para>
	      Defines a custom color named
	      <replaceable>name</replaceable>, 
	      which may be refered to in a stylesheet pattern with
	      <literal
	      moreinfo="none">#{custom<replaceable>name</replaceable>}</literal>
	      or queried in a macro with
	      <literal>CustomColor("<replaceable>name</replaceable>")</literal>.
	      For more information see <xref linkend="stylesheets"/>.
	      See also the <link linkend="allowcustomcolors"><literal moreinfo="none">AllowCustomColors</literal></link>
	      option which can be used to enable or disable the actual
	      use of the custom colors.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="activetextcolor">
	  <term><literal moreinfo="none">ActiveTextColor</literal></term>
	  <listitem>
	    <para>
	      Color used to flash the text of an attribute under the mouse-pointer.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="boxcolor">
	  <term><literal moreinfo="none">BoxColor</literal></term>
	  <listitem>
	    <para>
	      Background color of a border drawn around the text of
	      labels if the <menuchoice moreinfo="none">
		<guimenu moreinfo="none">View</guimenu>
		<guimenuitem moreinfo="none">Draw boxes around edges</guimenuitem>
	      </menuchoice> item is checked.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="currentboxcolor">
	  <term><literal moreinfo="none">CurrentBoxColor</literal></term>
	  <listitem>
	    <para>
	      Background color of a border drawn around the text of
	      the active node's labels if the <menuchoice moreinfo="none">
		<guimenu moreinfo="none">View</guimenu>
		<guimenuitem moreinfo="none">Draw boxes around labels</guimenuitem></menuchoice> item is checked.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="hiddenboxcolor">
	  <term><literal moreinfo="none">HiddenBoxColor</literal></term>
	  <listitem>
	    <para>
	      Background color of a border drawn around the text of
	      a hidden node's labels if the <menuchoice moreinfo="none">
		<guimenu moreinfo="none">View</guimenu>
		<guimenuitem moreinfo="none">Draw boxes around labels</guimenuitem></menuchoice> and 
	      <menuchoice moreinfo="none">
		<guimenu moreinfo="none">View</guimenu>
		<guimenuitem moreinfo="none">Show Hidden
		</guimenuitem></menuchoice>
	      items are checked.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="edgeboxcolor">
	  <term><literal moreinfo="none">EdgeBoxColor</literal></term>
	  <listitem>
	    <para>
	      Background color of a border drawn around the text of
	      edge labels if the <menuchoice moreinfo="none">
		<guimenu moreinfo="none">View</guimenu>
		<guimenuitem moreinfo="none">Draw boxes around edge labels</guimenuitem>
	      </menuchoice> item is checked.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="edgecurrentboxcolor">
	  <term><literal moreinfo="none">EdgeCurrentBoxColor</literal></term>
	  <listitem>
	    <para>
	      Background color of a border drawn around the text of
	      the edge label of the active node ( if the <menuchoice moreinfo="none">
		<guimenu moreinfo="none">View</guimenu>
		<guimenuitem moreinfo="none">Draw boxes around edge labels</guimenuitem></menuchoice> item is checked.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="edgehiddenboxcolor">
	  <term><literal moreinfo="none">EdgeHiddenBoxColor</literal></term>
	  <listitem>
	    <para>
	      Background color of a border drawn around the text of
	      a hidden node's edge labels if the <menuchoice moreinfo="none">
		<guimenu moreinfo="none">View</guimenu>
		<guimenuitem moreinfo="none">Draw boxes around edge labels</guimenuitem></menuchoice> and 
	      <menuchoice moreinfo="none">
		<guimenu moreinfo="none">View</guimenu>
		<guimenuitem moreinfo="none">Show Hidden
		</guimenuitem></menuchoice>
	      items are checked.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="linecolor">
	  <term><literal moreinfo="none">LineColor</literal></term>
	  <listitem>
	    <para>Color used to draw the lines connecting dependent nodes in a
	      tree.
	      Default is black.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="hiddenlinecolor">
	  <term><literal moreinfo="none">HiddenLineColor</literal></term>
	  <listitem>
	    <para>Color used to draw the lines connecting hidden
	      nodes with their parents. Default is gray.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="dashhiddenlines">
	  <term><literal moreinfo="none">dashHiddenLines</literal></term>
	  <listitem>
	    <para>Controls is lines connecting hidden nodes with
             their parents are dashed or solid. Allowed values are 0
             (solid) or 1 (dashed). Default is 0.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="linearrow">
	  <term><literal moreinfo="none">LineArrow</literal></term>
	  <listitem>
	    <para>One of the values
	      <quote><literal moreinfo="none">first</literal></quote>,
	      <quote><literal moreinfo="none">both</literal></quote>,
	      <quote><literal moreinfo="none">last</literal></quote>,
	      may be used to make arrows to be drawn by default
	      on one or both sides of the edge connecting
	      the given node with its parent.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="nodecolor">
	  <term><literal moreinfo="none">NodeColor</literal></term>
	  <listitem>
	    <para>Color used to fill an ordinary node of the tree.
	      Default is yellow.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="nodeoutlinecolor">
	  <term><literal moreinfo="none">NodeOutlineColor</literal></term>
	  <listitem>
	    <para>Color used to draw the outline of an ordinary node.
	      Default is black.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="hiddennodecolor">
	  <term><literal moreinfo="none">HiddenNodeColor</literal></term>
	  <listitem>
	    <para>Color used to draw nodes marked as hidden, if shown. Default
	      is black.</para>
	  </listitem>
	</varlistentry>
      </variablelist>
    </section>
    <section>
      <title>Other options affecting tree appearence</title>
      <variablelist>
	<varlistentry id="balancetree">
	  <term><literal moreinfo="none">BalanceTree</literal></term>
	  <listitem>
	    <para>If this option is set to 1, the tree will be
	      auto-balanced, disregarding a node-ordering
	      attribute.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="skiphiddenlevels">
	  <term><literal moreinfo="none">SkipHiddenLevels</literal></term>
	  <listitem>
	    <para>If the <link linkend="get_nodelist_hook"><literal>get_nodelist_hook</literal></link>
	      provides an incomplete list of nodes of the tree, there
	      may be nodes whose parent-node is not on the list.
	      If this option is set to <literal>1</literal>,
	      any such a orphan node <quote>skip levels</quote> and appears
	      as if it was child-node of its nearest ancestor-node that belongs
	      to the list. This option implies
	      <link linkend="skiphiddenparents"><literal>SkipHiddenParents</literal></link>.
	      (Note that this only affects the way a tree is drawn,
	      it does not relate in any way to tree-navigation and
	      tree-traversal functions).
	      Default is <literal>0</literal>.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="skiphiddenparents">
	  <term><literal moreinfo="none">SkipHiddenParents</literal></term>
	  <listitem>
	    <para>If the <link linkend="get_nodelist_hook"><literal>get_nodelist_hook</literal></link>
	      provides an incomplete list of nodes of the tree, there
	      may be nodes whose parent-node is not on the list.
	      If this option is set to <literal>1</literal>,
	      then any lines that would connect such an orphan node with its parent
	      are instead connected to the nearest ancestor of the node that
	      belongs to the list. The orphan node however remains on it's
	      level in the tree (see also <link linkend="skiphiddenlevels"><literal>SkipHiddenLevels</literal></link>).
	      (Note that this only affects the way a tree is drawn,
	      it does not relate in any way to tree-navigation and
	      tree-traversal functions).
	      Default is <literal>0</literal>.
	    </para>
	  </listitem>
	</varlistentry>
	
	<varlistentry id="highlightwindowwidth">
	  <term><literal moreinfo="none">HighlightWindowWidth</literal></term>
	  <listitem>
	    <para>Width of the frame drawn around the focused view.</para>
	  </listitem>
	</varlistentry>
	<varlistentry id="linewidth">
	  <term><literal moreinfo="none">LineWidth</literal></term>
	  <listitem>
	    <para>Width of the lines connecting dependent nodes in a tree.</para>
	  </listitem>
	</varlistentry>
	<varlistentry id="nodewidth">
	  <term><literal moreinfo="none">NodeWidth</literal></term>
	  <listitem>
	    <para>
	      The horizontal diameter of the elipsis representing a node in
	      a tree.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="nodeheight">
	  <term><literal moreinfo="none">NodeHeight</literal></term>
	  <listitem>
	    <para>
	      The vertical diameter of the elipsis representing a node in
	      a tree.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="currentnodewidth">
	  <term><literal moreinfo="none">CurrentNodeWidth</literal></term>
	  <listitem>
	    <para>
	      The horizontal diameter of the elipsis representing the active node in
	      a tree.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="currentnodeheight">
	  <term><literal moreinfo="none">CurrentNodeHeight</literal></term>
	  <listitem>
	    <para>
	      The vertical diameter of the elipsis representing the active node in
	      a tree.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="nodexskip">
	  <term><literal moreinfo="none">NodeXSkip</literal></term>
	  <listitem>
	    <para>The minimal horizontal distance between two nodes in a
	      tree.</para>
	  </listitem>
	</varlistentry>
	<varlistentry id="nodeyskip">
	  <term><literal moreinfo="none">NodeYSkip</literal></term>
	  <listitem>
	    <para>The minimal vertical distance between two nodes in a
	      tree.</para>
	  </listitem>
	</varlistentry>
	<varlistentry id="xmargin">
	  <term><literal moreinfo="none">XMargin</literal></term>
	  <listitem>
	    <para>Horizontal amount of space left around borders of the box
	      surrounding the text of displayed attributes of a node.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="ymargin">
	  <term><literal moreinfo="none">YMargin</literal></term>
	  <listitem>
	    <para>Horizontal amount of space left around borders of the box
	      surrounding the text of displayed attributes of a node.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="basexpos">
	  <term><literal moreinfo="none">BaseXPos</literal></term>
	  <listitem>
	    <para>
	      The horizontal distance of the tree root (zero's node)
	      from the right of the tree view.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="baseypos">
	  <term><literal moreinfo="none">BaseYPos</literal></term>
	  <listitem>
	    <para>
	      The vertical distance of the tree root (zero's node)
	      from the top of the tree view.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="drawboxes">
	  <term><literal moreinfo="none">DrawBoxes</literal></term>
	  <listitem>
	    <para>
	      If this option is set, <application moreinfo="none">TrEd</application> starts with the 
	      <menuchoice moreinfo="none">
		<guimenu moreinfo="none">View</guimenu>
		<guimenuitem moreinfo="none">DrawBoxes</guimenuitem></menuchoice> menu item checked.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="drawedgeboxes">
	  <term><literal moreinfo="none">DrawEdgeBoxes</literal></term>
	  <listitem>
	    <para>
	      If this option is set, 
	      <application moreinfo="none">TrEd</application> starts with the 
	      <menuchoice moreinfo="none">
		<guimenu moreinfo="none">View</guimenu>
		<guimenuitem moreinfo="none">Draw boxes around edge labels</guimenuitem>
	      </menuchoice> menu item checked.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="edgelabelskipabove">
	  <term><literal moreinfo="none">EdgeLabelSkipAbove</literal></term>
	  <listitem>
	    <para>
	      Extra space left above every edge label.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="edgelabelskipbelow">
	  <term><literal moreinfo="none">EdgeLabelSkipBelow</literal></term>
	  <listitem>
	    <para>
	      Extra space left below every edge label.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="useadditionaledgelabelskip">
	  <term><literal moreinfo="none">UseAdditionalEdgeLabelSkip</literal></term>
	  <listitem>
	    <para>
	      This options controls whether the algorighm
	      computing the tree-layout in TrEd should try to
	      add a reasonable horizontal skip for the edge labels,
	      to avoid their overlapping. Note that
	      even with this option on, the algorithm cannot
	      reliably ensure that. Defaults to 1.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="highlightattributes">
	  <term><literal moreinfo="none">HighlightAttributes</literal></term>
	  <listitem>
	    <para>
	      If this option is set, <application moreinfo="none">TrEd</application> starts with the 
	      <menuchoice moreinfo="none">
		<guimenu moreinfo="none">View</guimenu>
		<guimenuitem moreinfo="none">Highlight Attributes</guimenuitem>
	      </menuchoice> menu item checked.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="cleartextbackground">
	  <term><literal moreinfo="none">ClearTextBackground</literal></term>
	  <listitem>
	    <para>
	      Choose if invisible rectangles should be drawn beneath
	      text labels to clear the background for the text.
	      Possible values are <literal moreinfo="none">0</literal> and <literal moreinfo="none">1</literal>.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="allowcustomcolors">
	  <term><literal moreinfo="none">AllowCustomColors</literal></term>
	  <listitem>
	    <para>
	      This option takes one of the values <literal moreinfo="none">0</literal>
	      and <literal moreinfo="none">1</literal>.
	      If set to <literal moreinfo="none">0</literal>, all references to
	      custom colors in attribute patterns are ignored. 
	      It is also the default value.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="showhidden">
	  <term><literal moreinfo="none">ShowHidden</literal></term>
	  <listitem>
	    <para>
	      If this option is set, <application moreinfo="none">TrEd</application> starts with the 
	      <menuchoice moreinfo="none">
		<guimenu moreinfo="none">View</guimenu>
		<guimenuitem moreinfo="none">Show Hidden Nodes</guimenuitem>
	      </menuchoice> menu item checked.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="hintwait">
	  <term><literal moreinfo="none">HintWait</literal></term>
	  <listitem>
	    <para>
	      This option controls time interval
	      that mouse pointer needs to linger over a node 
	      before the hint for the node is displayed. 
	      The value is to be given in
	      milliseconds.  See <xref linkend="stylesheets"/> for more
	      information about defining the content of the hints.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="toolbarhintwait">
	  <term><literal moreinfo="none">ToolbarHintWait</literal></term>
	  <listitem>
	    <para>
	      This option controls time interval
	      that mouse pointer needs to linger over a TrEd toolbar
	      button (or other widget with a tool-tip)
	      before a tool-tip is displayed. 
	      The value is to be given in
	      milliseconds.  See <xref linkend="stylesheets"/> for more
	      information about defining the content of the hints.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="searchmethod">
	  <term><literal moreinfo="none">SearchMethod</literal></term>
	  <listitem>
	    <para>
	      This option lets you define the default method used when
	      searching with the <menuchoice moreinfo="none">
		<guimenu moreinfo="none">Node</guimenu>
		<guimenuitem moreinfo="none">Find</guimenuitem>
	      </menuchoice> command. The default value is
	      <literal moreinfo="none">Exhaustive regular expression</literal>
	      but user may use any of the following values (actually
	      only the first letter suffices):
	      <simplelist type="vert">
		<member><literal moreinfo="none">Regular Expression</literal></member>
		<member><literal moreinfo="none">Wildcards</literal></member>
		<member><literal moreinfo="none">Literal</literal></member>
		<member><literal moreinfo="none">Exhaustive regular expression</literal></member>
	      </simplelist>
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="macrolistorder">
	  <term><literal moreinfo="none">MacroListOrder</literal></term>
	  <listitem>
	    <para>This option defines the default ordering of macros
	      when <menuchoice moreinfo="none">
		<guimenu moreinfo="none">View</guimenu>
		<guimenuitem moreinfo="none">List of Named Macros...</guimenuitem>
	      </menuchoice>
	      menu command is used. Possible values are letters
	      <literal moreinfo="none">M</literal> (sort by macro menu label)
	      and <literal moreinfo="none">K</literal> (sort by keyboard shortcuts
	      assigned to macros). Default value is <literal moreinfo="none">M</literal>.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="maxdisplayedvalues">
	  <term><literal moreinfo="none">MaxDisplayedValues</literal></term>
	  <listitem>
	    <para>
	      This option may be used to tell
	      <application moreinfo="none">TrEd</application>
	      how many fields should fit in one screen of a
	      list when a dialog
	      displaying possible (or already assigned)
	      values for a certain attribute is displayed.
	      (The greater the number is, the taller
	      the dialog grows).
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="maxdisplayedattributes">
	  <term><literal moreinfo="none">MaxDisplayedAttributes</literal></term>
	  <listitem>
	    <para>
	      This option may be used to tell
	      <application moreinfo="none">TrEd</application>
	      how many fields should fit in one screen of the
	      <guilabel moreinfo="none">Edit Node ...</guilabel>
	      and
	      <guilabel moreinfo="none">Find Node by Attributes</guilabel>
	      dialog windows. (The greater the number, the taller
	      the dialogs).
	    </para>
	  </listitem>
	</varlistentry>
      </variablelist>
    </section>
    <section>
      <title>GUI options</title>
      <variablelist>
	<varlistentry id="appname">
	  <term><literal moreinfo="none">AppName</literal></term>
	  <listitem>
	    <para>The window title for the <application moreinfo="none">TrEd</application>'s main window.</para>
	  </listitem>
	</varlistentry>
	<varlistentry id="appicon">
	  <term><literal moreinfo="none">AppIcon</literal></term>
	  <listitem>
	    <para><application moreinfo="none">TrEd</application>'s desktop and window
	      icon (in <literal moreinfo="none">XPM</literal> format).</para>
	  </listitem>
	</varlistentry>
	<varlistentry id="stippleinactivewindows">
	  <term>StippleInactiveWindows</term>
	  <listitem>
	    <para>
	      If set to <literal moreinfo="none">1</literal>, inactive views are
	      covered with a semi-transparent stipple pattern. This
	      may improve orientation if working with more than one
	      view, but also slightly reduces the clarity of trees
	      displayed in the inactive views. This option can also be
	      controlled in run-time using
	      <menuchoice moreinfo="none">
		<guimenu moreinfo="none">View</guimenu>
		<guimenuitem moreinfo="none">Stipple Inactive Views</guimenuitem>
	      </menuchoice>.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="vlineheight">
	  <term><literal moreinfo="none">VLineHeight</literal></term>
	  <listitem>
	    <para>Initial height for the value line in lines. Default
	    value is 2.</para>
	  </listitem>
	</varlistentry>
	<varlistentry id="vlinealign">
	  <term><literal moreinfo="none">VLineAlign</literal></term>
	  <listitem>
	    <para>Specifies alignment for value line. Possible values
	      are <literal moreinfo="none">left</literal>, <literal moreinfo="none">center</literal>, and <literal moreinfo="none">right</literal>.</para>
	  </listitem>
	</varlistentry>
	<varlistentry id="vlinewrap">
	  <term><literal moreinfo="none">VLineWrap</literal></term>
	  <listitem>
	    <para>Specifies value line wrapping. Possible values
	      are <literal moreinfo="none">node</literal> (no wrapping),
	      <literal moreinfo="none">char</literal> (allow wrapping on any character
	      boundary),
	      and <literal moreinfo="none">word</literal> (allow wrapping on word boundary).</para>
	  </listitem>
	</varlistentry>
	<varlistentry id="vlinereverselines">
	  <term><literal moreinfo="none">VLineReverseLines</literal></term>
	  <listitem>
	    <para>Draw wrapped value lines in reverse order (bottom-up).</para>
	  </listitem>
	</varlistentry>
	<varlistentry id="vlineforeground">
	  <term><literal moreinfo="none">VLineForeground</literal></term>
	  <listitem>
	    <para>
	      Foreground color of the value line.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="vlinebackground">
	  <term><literal moreinfo="none">VLineBackground</literal></term>
	  <listitem>
	    <para>
	      Background color of the value line.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="vlinefocusforeground">
	  <term><literal moreinfo="none">VLineFocusForeground</literal></term>
	  <listitem>
	    <para>
	      Foreground color of the highlighted value corresponding to the
	      active node.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="vlinefocusbackground">
	  <term><literal moreinfo="none">VLineFocusBackground</literal></term>
	  <listitem>
	    <para>
	      Background color of the highlighted value corresponding to the
	      active node.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="hintbackground">
	  <term><literal moreinfo="none">HintBackground</literal></term>
	  <listitem>
	    <para>
	      Background color of the hints shown when mouse
	      lingers over a node.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="hintforeground">
	  <term><literal moreinfo="none">HintForeground</literal></term>
	  <listitem>
	    <para>
	      Text color of the hints shown when mouse 
	      lingers over a node.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="toolbarhintbackground">
	  <term><literal moreinfo="none">ToolbarHintBackground</literal></term>
	  <listitem>
	    <para>
	      Background color of the tool-tips shown when mouse
	      lingers over a tool-bar button or one of
	      several other widgets.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="toolbarhintforeground">
	  <term><literal moreinfo="none">ToolbarHintForeground</literal></term>
	  <listitem>
	    <para>
	      Text color of the tool-tips shown when mouse 
	      lingers over a tool-bar button or one of
	      several other widgets.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="buttonsrelief">
	  <term><literal moreinfo="none">ButtonsRelief</literal></term>
	  <listitem>
	    <para>
	      Style of the relief of the GUI buttons. 
	      Possible values for this option are:
	      raised, sunken, flat, ridge, solid, and groove.
	      Default is 'raised'.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="buttonsborder">
	  <term><literal moreinfo="none">ButtonsBorder</literal></term>
	  <listitem>
	    <para>
	      Width of the borders of GUI buttons. Default is 2.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="menubarrelief">
	  <term><literal moreinfo="none">MenubarRelief</literal></term>
	  <listitem>
	    <para>
	      Style of the relief of the GUI menu-bar. Same values as for
	      ButtonsRelief option are possible. Default is 'raised'.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="maxmenulines">
	  <term><literal moreinfo="none">MaxMenuLines</literal></term>
	  <listitem>
	    <para>Maximal number of User-menu lines. If more lines in the menu
	      should appear, a submenu is created as a last item, in which the
	      menu continues.</para>
	  </listitem>
	</varlistentry>
	<varlistentry id="sortattributes">
	  <term><literal moreinfo="none">SortAttributes</literal></term>
	  <listitem>
	    <para>If <literal moreinfo="none">1</literal>, all lists where attribute names
	      or values are displayed are sorted
	      alphabetically. Otherwise the order given in the FS-file
	      header is preserved. Default value for this option is <literal moreinfo="none">1</literal>.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="createmacromenu">
	  <term><literal moreinfo="none">CreateMacroMenu</literal></term>
	  <listitem>
	    <para>
	      If this option is <literal moreinfo="none">1</literal>, <application moreinfo="none">TrEd</application> creates a special menu
	      <guimenu moreinfo="none">Key-macros</guimenu> where all defined macros which are assigned
	      a key are presented also as menu functions.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="strictmotif">
	  <term><literal moreinfo="none">StrictMotif</literal></term>
	  <listitem>
	    <para>
	      If this option is <literal moreinfo="none">1</literal>, strict motifish look and feel is
	      used in TrEd's GUI.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="iconpath">
	  <term><literal moreinfo="none">IconPath</literal></term>
	  <listitem>
	    <para>
	      Colon-separated (on Windows comma-separated) 
	      list of paths for tred to look for icons.
	      Only XPM and PNG icons are supported
	      (it is not recommended to use
	      PNG icons on X11 with present versions of Tk804,
	      due to a severe bug causing occasional crashes).
	      Relative paths relate to 
	      <literal moreinfo="none"><replaceable>libDir</replaceable>/icons</literal>
	      directory.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="lastaction">
	  <term><literal moreinfo="none">LastAction</literal></term>
	  <listitem>
	    <para>
	      This option, automatically updated on exit, contains an
	      URL and position of a last action on a tree.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="geometry">
	  <term><literal moreinfo="none">Geometry</literal></term>
	  <listitem>
	    <para>
	      TrEd's main window geometry 
	      (<literal moreinfo="none">HxW[+-]x[+-]y</literal>,
	      where <literal moreinfo="none">H</literal> is window's height,
	      <literal moreinfo="none">W</literal> is window's width,
	      <literal moreinfo="none">x</literal> is window's horizontal
	      position from the left if positive and
	      from the right if negative, 
	      and <literal moreinfo="none">y</literal>
	      is window's vertical
	      position from the top of the screen if positive and
	      from the bottom of the screen if negative).
	      This option is automatically updated every time
	      TrEd's main window is closed.
	    </para>
	  </listitem>
	</varlistentry>
      </variablelist>
    </section>
    <section>
      <title>Fonts</title>
      <variablelist>
	<varlistentry id="font">
	  <term><literal moreinfo="none">Font</literal></term>
	  <listitem>
	    <para>
	      Font used to display the text of attributes and also in
	      several other places of GUI where the text of attributes is
	      displayed or edited. There are two possible formats of values
	      for this option:
	      <orderedlist continuation="restarts" inheritnum="ignore">
		<listitem><para>Standard X font-spec, with possible wildcards, e.g.:
		    <literal moreinfo="none">-*-helvetica-medium-r-normal-*-12-*-*-*-*-*-iso8859-2</literal>
		  </para></listitem>
		<listitem><para>Font attribute-oriented format, which is a 
		    comma-separated list of pairs of the form
		    <literal moreinfo="none">font-attribute:value</literal>. The attributes are:
		    <literal moreinfo="none">family, size, weight, slant, underline,
		      overstrike</literal>. Family is a font-family name like
		    <literal moreinfo="none">Arial, Helvetica</literal> or <literal moreinfo="none">Times New Roman</literal>.
		    Size is a number providing the font-size in points
		    (i.e. not pixels!). Possible values for <literal moreinfo="none">bold</literal>
		    are <literal moreinfo="none">normal</literal> and <literal moreinfo="none">bold</literal>, possible
		    values for <literal moreinfo="none">slant</literal> are <literal moreinfo="none">roman</literal> and
		    <literal moreinfo="none">italics</literal>. The <literal moreinfo="none">underline</literal> and 
		    <literal moreinfo="none">overstrike</literal> attributes take just boolean
		    values of <literal moreinfo="none">1</literal> and <literal moreinfo="none">0</literal>.
		    If a font, that would match the specified attributes 	    
		    exactly, is not found, the most similar font is used.
		  </para>
		  <note>
		    <title>Example</title>		 
		    <literallayout class="normal" format="linespecific">Font = family:Arial,size:10,weight:bold</literallayout>
		  </note>
		</listitem>
		<listitem><para>On XFT enabled Tk/X11, it is also
		    possible to use font patterns as specified by the
		    <ulink url="http://freedesktop.org/software/fontconfig">fontconfig</ulink>
		    library. These font patterns take the form:
<literallayout format="linespecific" class="normal">&lt;families&gt;-&lt;point sizes&gt;:&lt;name1&gt;=&lt;values1&gt;:&lt;name2&gt;=&lt;values2&gt;...</literallayout>
	      Where <replaceable>names</replaceable> and 
	      <replaceable>values</replaceable>
	      refer to the folowing table:
		  </para>
		    <informaltable>
		      <tgroup cols="3">
			<thead>
			  <row>
			    <entry>Name of a property</entry>
			    <entry>Value type</entry>
			    <entry>Description</entry>
			  </row>
			</thead>
			<tbody>
			  <row><entry><literal>family</literal></entry><entry>String</entry><entry><para>Font family name</para></entry></row>
			  <row><entry><literal>style</literal></entry><entry>String</entry><entry><para>Font style. Overrides weight and slant</para></entry></row>
			  <row><entry><literal>slant</literal></entry><entry>Int</entry><entry><para>Italic, oblique or roman</para></entry></row>
			  <row><entry><literal>weight</literal></entry><entry>Int</entry><entry><para>Light, medium, demibold, bold or black</para></entry></row>
			  <row><entry><literal>size</literal></entry><entry>Double</entry><entry><para>Point size</para></entry></row>
			  <row><entry><literal>aspect</literal></entry><entry>Double</entry><entry><para>Stretches glyphs horizontally before hinting</para></entry></row>
			  <row><entry><literal>pixelsize</literal></entry><entry>Double</entry><entry><para>Pixel size</para></entry></row>
			  <row><entry><literal>spacing</literal></entry><entry>Int</entry><entry><para>Proportional, monospace or charcell</para></entry></row>
			  <row><entry><literal>foundry</literal></entry><entry>String</entry><entry><para>Font foundry name</para></entry></row>
			  <row><entry><literal>antialias</literal></entry><entry>Bool</entry><entry><para>Whether glyphs can be antialiased</para></entry></row>
			  <row><entry><literal>hinting</literal></entry><entry>Bool</entry><entry><para>Whether the rasterizer should use hinting</para></entry></row>
			  <row><entry><literal>verticallayout</literal></entry><entry>Bool</entry><entry><para>Use vertical layout</para></entry></row>
			  <row><entry><literal>autohint</literal></entry><entry>Bool</entry><entry><para>Use autohinter instead of normal hinter</para></entry></row>
			  <row><entry><literal>globaladvance</literal></entry><entry>Bool</entry><entry><para>Use font global advance data</para></entry></row>
			  <row><entry><literal>file</literal></entry><entry>String</entry><entry><para>The filename holding the font</para></entry></row>
			  <row><entry><literal>index</literal></entry><entry>Int</entry><entry><para>The index of the font within the file</para></entry></row>
			  <row><entry><literal>ftface</literal></entry><entry>FT_Face</entry><entry><para>Use the specified FreeType face object</para></entry></row>
			  <row><entry><literal>rasterizer</literal></entry><entry>String</entry><entry><para>Which rasterizer is in use</para></entry></row>
			  <row><entry><literal>outline</literal></entry><entry>Bool</entry><entry><para>Whether the glyphs are outlines</para></entry></row>
			  <row><entry><literal>scalable</literal></entry><entry>Bool</entry><entry><para>Whether glyphs can be scaled</para></entry></row>
			  <row><entry><literal>scale</literal></entry><entry>Double</entry><entry><para>Scale factor for point-&gt;pixel conversions</para></entry></row>
  <row><entry><literal>dpi</literal></entry><entry>Double</entry><entry><para>Target dots per inch</para></entry></row>
			  <row><entry><literal>rgba</literal></entry><entry>Int</entry><entry><para>unknown, rgb, bgr, vrgb, vbgr, none - subpixel geometry</para></entry></row>
			  <row><entry><literal>minspace</literal></entry><entry>Bool</entry><entry><para>Eliminate leading from line spacing</para></entry></row>
			  <row><entry><literal>charset</literal></entry><entry>CharSet</entry><entry><para>Unicode chars encoded by the font</para></entry></row>
			  <row><entry><literal>lang</literal></entry><entry>String</entry><entry><para>List of RFC-3066-style languages this font supports</para></entry></row>
			</tbody>

		      </tgroup>
		    </informaltable>
		</listitem>
	      </orderedlist>	
	    </para>
		  <note>
		    <title>Example</title>		 
		    <literallayout class="normal" format="linespecific">Font = Times-12:bold:slant=italic:antialias=0</literallayout>
		  </note>	  
	  </listitem>
	</varlistentry>      
	<varlistentry id="vlinefont">
	  <term><literal moreinfo="none">VLineFont</literal></term>
	  <listitem>
	    <para>
	      Font used for displaying the text in the value line above
	      tree. The same formats as for Font are allowed for this
	      option. If not specified, Font is used. 
	    </para>
	  </listitem>
	</varlistentry>
      </variablelist>
    </section>
    <section>
      <title>Printing options</title>
      <variablelist>
	<varlistentry id="defaultprintcommand">
	  <term><literal moreinfo="none">DefaultPrintCommand</literal></term>
	  <listitem>
	    <para>
	      Command used to pass the resulting PostScript to
	      the print spool. Default value is <command moreinfo="none">lpr</command>
	      in UNIX systems and <command moreinfo="none">prfile32.exe /-</command>
	      on Windows (<literal moreinfo="none">prfile32.exe</literal> is a
	      freeware Windows printing utility available at <ulink url="http://www.lerup.com/printfile/">http://www.lerup.com/printfile/</ulink>).
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="ttfont">
	  <term><literal moreinfo="none">TTFont</literal></term>
	  <listitem>
	    <para>
	      Name of the TrueType font to be used
	      when printing into Portable Document Format (PDF).
	      Defaults to <literal moreinfo="none">Arial</literal>.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="ttfontpath">
	  <term><literal moreinfo="none">TTFontPath</literal></term>
	  <listitem>
	    <para>
	      A comma-separated list of directories to look into
	      for TrueType fonts.
	      If this option is not explicitly
	      specified, TrEd uses directories listed in 
	      fontconfig library configuration file
	      <literal moreinfo="none">/etc/fonts/fonts.conf</literal> on Unix
	      and Windows system font directory on Windows.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="psfontfile">
	  <term><literal moreinfo="none">PsFontFile</literal></term>
	  <listitem>
	    <para>
	      A pfa-file with a Type1 PostScript font to be used for
	      PostScript or EPS generation.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="psfontafmfile">
	  <term><literal moreinfo="none">PsFontAFMFile</literal></term>
	  <listitem>
	    <para>
	      An afm-file containing the Type1 font metrics to be used for
	      PostScript or EPS generation. It is not necessary to 
	      specify this option if the metrics file name
	      can be derived from the <link linkend="psfontfile"><literal moreinfo="none">PsFontFile</literal></link>
	      by substitution the extension for <literal moreinfo="none">.afm</literal>.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="printcolors">
	  <term><literal moreinfo="none">PrintColors</literal></term>
	  <listitem>
	    <para>
	      If <literal moreinfo="none">0</literal>, <application moreinfo="none">TrEd</application> prints in black and white.
	      If <literal moreinfo="none">1</literal>, <application moreinfo="none">TrEd</application> uses the same colors for printing
	      as it does for displaying the tree on the screen.
	      This option may be overriden by the <guilabel moreinfo="none">Use Colors</guilabel>
	      check-box in the <guilabel moreinfo="none">Print</guilabel> dialog.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="psfontsize">
	  <term><literal moreinfo="none">PsFontSize</literal></term>
	  <listitem>
	    <para>Size of the Postscript font to be substituted 
	      by the font given in PsFontFile in the final PosctScript.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="prtfmtwidth">
	  <term><literal moreinfo="none">PrtFmtWidth</literal></term>
	  <listitem>
	    <para>
	      Width of the paper used for printing. Append one of the
	      characters <literal moreinfo="none">i,c,m</literal> to the number to destinguish the
	      dimension (inches, centimeters, milimeters
	      respectively).
	      This option only applies if <link linkend="psmedia"><literal moreinfo="none">PSMedia</literal></link>
	      is set to <literal moreinfo="none">User</literal> (see below).
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="prtfmtheight">
	  <term><literal moreinfo="none">PrtFmtHeight</literal></term>
	  <listitem>
	    <para>Width of the paper used for printing. Same format as
	    PrtFmtWidth.
	      This option only applies if <link linkend="psmedia"><literal moreinfo="none">PSMedia</literal></link>
	      is set to <literal moreinfo="none">User</literal> (see below).
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="psmedia">
	  <term><literal moreinfo="none">PSMedia</literal></term>
	  <listitem>
	    <para>A PostScript or PDF document media-type used to
	      calculate page width and height. The default value is
	      <literal moreinfo="none">A4</literal>. If this option is set to
	      <literal moreinfo="none">BBox</literal>, then the generated page has the
	      dimensions of a minimal bounding box around the tree.
	      If this options set to <literal moreinfo="none">User</literal>, then
	      the values of <literal moreinfo="none">PrtFmtHeight</literal>
	      and <literal moreinfo="none">PrtFmtWidth</literal> described above
	      are used. The supported media types beside
	      <literal moreinfo="none">User</literal>
	      and <literal moreinfo="none">BBox</literal> are:
	      <literal moreinfo="none">Letter, LetterSmall, Legal, Statement, Tabloid, Ledger,
	Folio, Quarto, 7x9, 9x11, 9x12, 10x13, 10x14,
	Executive, A0, A1, A2, A3, A4, A4Small, A5, A6, A7, A8, A9,
	A10, B0, B1, B2, B3, B4, B5, B6, B7, B8, B9, B10, ISOB0,
	ISOB1, ISOB2, ISOB3, ISOB4, ISOB5, ISOB6, ISOB7, ISOB8, ISOB9,
	ISOB10, C0, C1, C2, C3, C4, C5, C6, C7</literal>.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="psfile">
	  <term><literal moreinfo="none">PSFile</literal></term>
	  <listitem>
	    <para>
	      The default name of the output file when printed to file.
	      This name may be modified in the <guilabel moreinfo="none">Print</guilabel> dialog.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="maximizeprintsize">
	  <term><literal moreinfo="none">MaximizePrintSize</literal></term>
	  <listitem>
	    <para>
	      If this option is on (i.e. <literal moreinfo="none">1</literal>), <application moreinfo="none">TrEd</application> tryes to draw the
	      tree as big as to fill the whole paper. Default is <literal moreinfo="none">0</literal> here.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="prthmargin">
	  <term><literal moreinfo="none">PrtHMargin</literal></term>
	  <listitem>
	    <para>
	      Specifies the default 
	      horizontal print margin. Default is <literal moreinfo="none">2c</literal>
	      (c = centimeters).
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="prtvmargin">
	  <term><literal moreinfo="none">PrtVMargin</literal></term>
	  <listitem>
	    <para>
	      Specifies the default 
	      vertical print margin.
	      Default is <literal moreinfo="none">3c</literal>
	      (c = centimeters).
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="imagemagickconvert">
	  <term><literal moreinfo="none">ImageMagickConvert</literal></term>
	  <listitem>
	    <para>
	      Path to ImageMagick's <command moreinfo="none">convert</command> command
	      which is used to convert resulting EPS to various image
	      formats. The default value is <literal moreinfo="none">convert</literal>
	      which means TrEd expects the command to be installed in
	      some directory in <varname>PATH</varname>.
	    </para>
	  </listitem>
	</varlistentry>
      </variablelist>
    </section>
    <section>
      <title>I/O related options</title>
      <variablelist>
	<varlistentry id="iobackends">
	  <term><literal moreinfo="none">IOBackends</literal></term>
	  <listitem>
	    <para>This option can be used to provide additional
	      (user-defined) I/O backends (see <xref
	      linkend="backends"/>). It consists of a comma separated
	      list of Perl module names implementing the
	      backends. <application>TrEd</application> will try to
	      open a file using the backends defined here before trying
	      any of default I/O backends.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="resourcepath">
	  <term><literal moreinfo="none">ResourcePath</literal></term>
	  <listitem>
	    <para>This option can contain a (colon-separated on UNIX,
	      comma-separated on Windows) list of directories
	      where <application>TrEd</application>, it's
	      I/O backends and macros should look for additional resources
	      they might need (such as DTDs, XML/PML schemata, XSLT stylesheets, etc.).</para>
	  </listitem>
	</varlistentry>
	<varlistentry id="autosave">
	  <term><literal moreinfo="none">AutoSave</literal></term>
	  <listitem>
	    <para>
	      Time interval in minutes in which TrEd creates
              auto-save file. AutoSave=0 disables auto-saving.
	      Defaults to 5.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="lockfiles">
	  <term><literal moreinfo="none">LockFiles</literal></term>
	  <listitem>
	    <para>
	      When a file is open, TrEd creates
	      a lock file to prevent other TrEd instances
	      accessing the same file.
	      If set to 0, this option disables this behaviour.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="reloadpreservespatterns">
	  <term><literal moreinfo="none">ReloadPreservesPatterns</literal></term>
	  <listitem>
	    <para>
	      This option may be set to 0 to force the Reload function
	      to use the file's attribute pattern setting rather than
	      preserving the current one.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="defaultfileencoding">
	  <term><literal moreinfo="none">defaultFileEncoding</literal></term>
	  <listitem>
	    <para>
	      The encoding used for files opened in TrEd.
	      If TrEd runs on <literal moreinfo="none">Perl 5.8</literal> or higher
	      with <literal moreinfo="none">Tk804</literal> or higher with Unicode
	      support, arbitrary encoding supported by Perl can be
	      used. In all other cases, only 8-bit encodings are
	      supported and it is necessary to setup the display font
	      for correct displaying.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="defaultdisplayencoding">
	  <term><literal moreinfo="none">defaultDisplayEncoding</literal></term>
	  <listitem>
	    <para>This option may be used in TrEd running on
	      non-unicode aware <literal moreinfo="none">Perl</literal> and
	      <literal moreinfo="none">Tk</literal> (see above) if the file encoding
	      differs from the encoding used by the display font. In
	      such case, TrEd supports conversions between
	      <literal moreinfo="none">iso-8859-2</literal> and
	      <literal moreinfo="none">windows-1250</literal> for Eastern European languages
	      and
	      <literal moreinfo="none">iso-8859-6</literal> and
	      <literal moreinfo="none">windows-1256</literal> for Arabic.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="openfilenamecommand">
	  <term><literal moreinfo="none">OpenFileNameCommand</literal></term>
	  <listitem>
	    <para>This option may be used 
	      to provide a custom command for displaying Open File dialogs.
	      In the command specification,
	      <literal moreinfo="none">%t</literal> is replaced with
	      the dialog title, 
	      <literal moreinfo="none">%m</literal> with a list of file-types (patterns),
	      <literal moreinfo="none">%t</literal> with the initial filename
	      (only for save dialogs, see the 
	      <link linkend="savefilenamecommand">SaveFileNameCommand</link>
	      option below), and
	      <literal moreinfo="none">%d</literal> with the initial directory.
	      For example, setting this option to 
	      <literal moreinfo="none">kdialog --title %t --getopenfilename %d %m</literal>
	      in a KDE 3.3.x environment makes TrEd use
	      the default KDE Open File dialog.
	      This option is unused by default.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="savefilenamecommand">
	  <term><literal moreinfo="none">SaveFileNameCommand</literal></term>
	  <listitem>
	    <para>This option may be used 
	      to provide a custom command for displaying Save File dialogs.
	      See the <link linkend="openfilenamecommand">SaveFileNameCommand</link> option above
	      for more detail. For example, setting this option to 
	      <literal moreinfo="none">kdialog --title %t --getopenfilename %d%f %m</literal>
	      in a KDE 3.3.x environment makes TrEd use
	      the default KDE Open File dialog.
	      This option is unused by default.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="sgmls">
	  <term><literal moreinfo="none">sgmls</literal></term>
	  <listitem>
	    <para>This option may be used to point
	      <application moreinfo="none">TrEd</application> to the
	      <command moreinfo="none">nsgmls</command>
	      SGML parser.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="sgmlsopts">
	  <term><literal moreinfo="none">SgmlsOpts</literal></term>
	  <listitem>
	    <para>
	      This option may be used to provide additional parameters
	      to the SGML parser declared in <link linkend="sgmls">Sgmls</link> option. By default,
	      this option is set to <literal moreinfo="none">-i preserve.gen.entities</literal>.
	      These parameters forces James Clark's
	      <command moreinfo="none">nsgmls</command> parser to include a part of
	      CSTS DTD where all global entities are re-declared in such a
	      way that they expand to themselves literally and thus
	      are preserved (as if no expansion was done).
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="cstsparsercommand">
	  <term><literal moreinfo="none">CstsParserCommand</literal></term>
	  <listitem>
	    <para>
	      This option may be used to customize the command used by
	      CSTS backend to invoke SGML parser. The default value is
	      <literal moreinfo="none">%s %o %d %f</literal>. In this string,
	      the <literal moreinfo="none">%s</literal> substring is replaced
	      with the value of <link linkend="sgmls"><literal moreinfo="none">Sgmls</literal></link> option,
	      <literal moreinfo="none">%o</literal> is replaced with the value of
	      <link linkend="sgmlsopts"><literal moreinfo="none">SgmlsOpts</literal></link> option, 
	      <literal moreinfo="none">%d</literal> is replaced with the value of
	      <link linkend="cstsdoctype"><literal moreinfo="none">CSTSDoctype</literal></link> option, and
	      <literal moreinfo="none">%f</literal> is replaced with the filename.
	      The only requirement is that this command returns
	      a valid representation of the CSTS file in <ulink url="http://xml.coverpages.org/WG8-n931a.html#n931-esis">ESIS</ulink>
	      format on standard output.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="cstsparserzcommand">
	  <term><literal moreinfo="none">CstsParserZCommand</literal></term>
	  <listitem>
	    <para>
	      This option may be used to customize the command used by
	      CSTS backend to invoke SGML parser for files compressed
	      with GNU GZip. The default value is <literal moreinfo="none">%z &lt; %f |
	      %s %o %d -</literal>.  In this string, the
	      <literal moreinfo="none">%z</literal> substring is replaced with the
	      value of <link linkend="zcat"><literal moreinfo="none">zcat</literal></link> option.  See <link linkend="cstsparsercommand"><literal moreinfo="none">CstsParserCommand</literal></link>
	      for more.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="cstsdoctype">
	  <term><literal moreinfo="none">CSTSDoctype</literal></term>
	  <listitem>
	    <para>
	      This option should point to a file containing CSTS
	      doctype declaration combining both the SGML subset
	      declaration as well as the CSTS DTD. This file
	      is included in the distribution of TrEd and is by default stored
	      in TrEd's library directory as
	      <filename moreinfo="none">csts.doctype</filename>.
	      Setting this option overrides this default.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="gzip">
	  <term><literal moreinfo="none">gzip</literal></term>
	  <listitem>
	    <para>This option may be used to point
	      <application moreinfo="none">TrEd</application> to a
	      GNU <command moreinfo="none">gzip</command>
	      command, which is used for transparent
	      saving files commpressed by GNU <command moreinfo="none">gzip</command>.
	      The default value is <literal moreinfo="none">/bin/gzip -c</literal>
	      if <filename moreinfo="none">/bin/gzip</filename> exists and is
	      executable. Otherwise the value is undefined and
	      <application moreinfo="none">TrEd</application> does not support
	      transparent saving GNU-zipped files.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="gzipopts">
	  <term><literal moreinfo="none">gzipopts</literal></term>
	  <listitem>
	    <para>This option may provide additional
	      command-line arguments for the <command>gzip</command> command.
	    </para>
	  </listitem>	  
	</varlistentry>
	<varlistentry id="zcat">
	  <term><literal moreinfo="none">zcat</literal></term>
	  <listitem>
	    <para>This option may be used to point
	      <application moreinfo="none">TrEd</application> to a
	      GNU <command moreinfo="none">zcat</command>	      
	      command, which is used for transparent opening
	      files commpressed by GNU <command moreinfo="none">gzip</command>.
	      (These files are recognized by the
	      <filename moreinfo="none">.gz</filename>
	      suffix.) The default value is <literal moreinfo="none">/bin/zcat</literal>
	      if <filename moreinfo="none">/bin/zcat</filename> exists and is
	      executable. Otherwise the value of
	      <literal moreinfo="none">gzip</literal> option is used.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="zcatopts">
	  <term><literal moreinfo="none">zcatopts</literal></term>
	  <listitem>
	    <para>This option may provide additional
	      command-line arguments for the <command>zcat</command> command.
	    </para>
	  </listitem>	  
	</varlistentry>
	<varlistentry id="ssh">
	  <term><literal moreinfo="none">ssh</literal></term>
	  <listitem>
	    <para>This option can be used to point
	      <application moreinfo="none">TrEd</application> to
	      <command moreinfo="none">ssh</command> command,
	      which (depending on setup) may be used 
	      for transparent secure remote file-transfer.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="sshopts">
	  <term><literal moreinfo="none">sshopts</literal></term>
	  <listitem>
	    <para>This option may provide additional
	      command-line arguments for the <command>ssh</command> command.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="curl">
	  <term><literal moreinfo="none">curl</literal></term>
	  <listitem>
	    <para>This option can be used to point
	      <application moreinfo="none">TrEd</application> to
	      the program <command moreinfo="none">curl</command>,
	      which (depending on setup) may be used for transparent file-transfer over
	      ftp and http.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="curlopts">
	  <term><literal moreinfo="none">curlopts</literal></term>
	  <listitem>
	    <para>This option may provide additional
	      command-line arguments for the <command>curl</command> command.
	    </para>
	  </listitem>
	</varlistentry>
	
	<varlistentry id="kioclient">
	  <term><literal moreinfo="none">kioclient</literal></term>
	  <listitem>
	    <para>This option can be used to point
	      <application moreinfo="none">TrEd</application> to
	      the program <command moreinfo="none">kioclient</command>
	      (part of recent KDE distribution)
	      which (depending on setup) may be used for transparent file-transfer over
	      <literal>ftp://</literal>, <literal>http://</literal>,
	      <literal>fish://</literal> (ssh),
	      and various other protocols.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="kioclientopts">
	  <term><literal moreinfo="none">kioclientopts</literal></term>
	  <listitem>
	    <para>This option may provide additional
	      command-line arguments for the <command>kioclient</command> command.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="nolockprotocols">
	  <term><literal moreinfo="none">NoLockProtocols</literal></term>
	  <listitem>
	    <para>This option may provide <ulink url="regexps.html">regular expression</ulink>
	      matching protocols for which lock-files should never be
	      created. By default, it's value is set to
	      <literal>^(https?|zip|tar)$</literal>.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="rejectprotocols">
	  <term><literal moreinfo="none">RejectProtocols</literal></term>
	  <listitem>
	    <para>This option may provide <ulink url="regexps.html">regular expression</ulink>
	      matching protocols from which <application>TrEd</application>
	      should never attempted to fetch files. .
	    </para>
	  </listitem>
	</varlistentry>
      </variablelist>
      
    </section>
    <section>
      <title>Miscelaneous options</title>
      <variablelist>
	<varlistentry id="libdir">
	  <term><literal moreinfo="none">LibDir</literal></term>
	  <listitem>
	    <para>
	      This option forces <application moreinfo="none">TrEd</application> to search for its library
	      files in the specified directory.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="perllib">
	  <term><literal moreinfo="none">PerlLib</literal></term>
	  <listitem>
	    <para>
	      This option may contain a colon-separated (on Windows
	      comma-separated) list of additional directories where Perl modules
	      are located (this has similar effect as setting the
	      environment variable <varname>PERLLIB</varname>).
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="macrofile">
	  <term><literal moreinfo="none">MacroFile</literal></term>
	  <listitem>
	    <para>
	      Path to a file with macros for TrEd.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="defaultmacrofile">
	  <term><literal moreinfo="none">DefaultMacroFile</literal></term>
	  <listitem>
	    <para>
	      Path to a file with the default set of macros for TrEd.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="maxundo">
	  <term><literal moreinfo="none">MaxUndo</literal></term>
	  <listitem>
	    <para>
	      Maximum number of operations stored by Undo/Redo functions.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="noconvertwarning">
	  <term><literal moreinfo="none">NoConvertWarning</literal></term>
	  <listitem>
	    <para>
	      When a ImageMagick printing extension is used
	      on Windows or with a black-listed version of ImageMagick,
	      a warning dialog pops-up. This option can be set to 1 to
	      disable this behaviour.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="reversenodeorder">
	  <term><literal moreinfo="none">ReverseNodeOrder</literal></term>
	  <listitem>
	    <para>
	      Draw nodes (and value line values) in reverse order.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="uselocales">
	  <term><literal moreinfo="none">UseLocales</literal></term>
	  <listitem>
	    <para>
	      If <literal moreinfo="none">1</literal> is set here, 
	      <application moreinfo="none">TrEd</application> 
	      uses locales. This is especially useful in macros 
	      e.g. for sorting. <literal moreinfo="none">LC_CTYPE</literal> 
	      locale settings may also affect keyboard input and other
	      charset-related stuff in the GUI.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="useczechlocales">
	  <term><literal moreinfo="none">UseCzechLocales</literal></term>
	  <listitem>
	    <para>
	      If <literal moreinfo="none">1</literal> is set here,
	      <application moreinfo="none">TrEd</application> uses
	      Czech (cs_CZ) locales. This option is present for rather
	      historical reasons.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="displaynonasciilefttoright">
	  <term><literal moreinfo="none">displayNonAsciiLeftToRight</literal></term>
	  <listitem>
	    <para>
	      This option adds a poor-man's bidi-support.
	      It reverses all non ASCII-strings before displaying.
	      This option is not intended for Arabic, since
	      TrEd already contains better arab-remixing
	      algorigthms contributed by Ota Smrz.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="defaultmacroencoding">
	  <term><literal moreinfo="none">defaultMacroEncoding</literal></term>
	  <listitem>
	    <para>
	      The default encoding used when parsing TrEd macros.
	      This option only takes effect for
	      <literal moreinfo="none">Perl 5.8</literal> or higher.
	      Default macro encoding can be overriden
	      in the macro itself as described in 
	      <xref linkend="macroencodings"/>. Defaults to UTF-8.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry id="displaystatusline">
	  <term><literal moreinfo="none">displayStatusLine</literal></term>
	  <listitem>
	    <para>
	      Turn on/off displaying status line. Default is on.
	      Currently, status line content can only be controlled
	      from macros, via <link linkend="get_status_line_hook"><literal moreinfo="none">get_status_line_hook</literal></link>.
	    </para>
	  </listitem>
	</varlistentry>
      </variablelist>
    </section>
    <section>
      <title>Debugging options</title>
      <variablelist>
	<varlistentry id="backenddebug">
	  <term><literal moreinfo="none">backenddebug</literal></term>
	  <listitem>
	    <para>Print debugging information for I/O backends.</para>
	  </listitem>
	</varlistentry>
	<varlistentry id="hookdebug">
	  <term><literal moreinfo="none">hookdebug</literal></term>
	  <listitem>
	    <para>Print debugging information when hooks are called.</para>
	  </listitem>
	</varlistentry>
	<varlistentry id="keyboarddebug">
	  <term><literal moreinfo="none">keyboarddebug</literal></term>
	  <listitem>
	    <para>Print debugging on keyboard events.</para>
	  </listitem>
	</varlistentry>
	<varlistentry id="macrodebug">
	  <term><literal moreinfo="none">macrodebug</literal></term>
	  <listitem>
	    <para>Print debugging when macros are invoked.</para>
	  </listitem>
	</varlistentry>
	<varlistentry id="treddebug">
	  <term><literal moreinfo="none">treddebug</literal></term>
	  <listitem>
	    <para>Print various debugging information not covered
	      by the debugging options listed above.</para>
	  </listitem>
	</varlistentry>
      </variablelist>
    </section>
  </section>
  <section id="commandline">
    <title>Command-line options</title>
    <para>
      The general usage is as follows:
      <cmdsynopsis sepchar=" ">
	<command moreinfo="none">tred</command>
	<arg rep="norepeat" choice="opt">-q</arg>
	<group choice="opt">
	  <arg rep="norepeat" choice="plain">-R</arg>
	  <arg rep="norepeat" choice="plain">-X
	    <replaceable>gov</replaceable>,<replaceable>ord</replaceable></arg>
	</group>
	<arg rep="norepeat" choice="opt">-G</arg>
	<arg rep="norepeat" choice="opt">-Y</arg>
	<arg rep="norepeat" choice="opt">-H</arg>
	<arg rep="norepeat" choice="opt">-c <replaceable>config-file</replaceable></arg>
	<arg rep="norepeat" choice="opt">-m <replaceable>macro-file</replaceable></arg>
	<arg rep="norepeat" choice="opt">-t <replaceable>context</replaceable></arg>
	<arg rep="norepeat" choice="opt">-s <replaceable>stylesheet</replaceable></arg>
	<arg rep="norepeat" choice="opt">-n <replaceable>FS-file-encoding</replaceable></arg>
	<arg rep="norepeat" choice="opt">-p <replaceable>number-of-views</replaceable></arg>
	<arg rep="norepeat" choice="opt">-B <replaceable>backends</replaceable></arg>
	<arg rep="norepeat" choice="opt">-l <replaceable>file-list</replaceable></arg>
	<arg rep="norepeat" choice="opt">-W <replaceable>window-id</replaceable></arg>
	<group rep="repeat">
	  <arg choice="plain"><replaceable>file</replaceable></arg>
	  <arg choice="plain"><replaceable>file</replaceable>##<replaceable>N</replaceable></arg>
	  <arg choice="plain"><replaceable>file</replaceable>##<replaceable>N</replaceable>.<replaceable>M</replaceable></arg>
	</group>
      </cmdsynopsis>
      or
      <cmdsynopsis sepchar=" ">
	<command moreinfo="none">tred</command>
	<group choice="opt" rep="norepeat">
	  <arg choice="plain" rep="norepeat">-u</arg>
	  <arg choice="plain" rep="norepeat">-h</arg>
	</group>
      </cmdsynopsis>
      to obtain short instructions on usage (<parameter moreinfo="none">-u</parameter>)
      or a brief help (<parameter moreinfo="none">-h</parameter>).
    </para>
    <para>
      The optional command-line parameters have the following meaning:
    </para>
    <variablelist>
      <varlistentry>
	<term><parameter moreinfo="none">-m</parameter></term>
	<listitem>
	  <para>This parameter may be used to force <application moreinfo="none">TrEd</application> to use a different 
	    macro file from that given in TrEd's configuration file.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term><parameter moreinfo="none">-c</parameter></term>
	<listitem>
	  <para>This parameter may be used to force <application moreinfo="none">TrEd</application> to use 
	    a certain configuration file.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term><parameter moreinfo="none">-t</parameter></term>
	<listitem>
	  <para>Prefer the given binding context as the initial context
	    for every opened file.
	    This context may be however overriden by some hooks such as
	    <literal moreinfo="none">start_hook</literal>
	    or <literal moreinfo="none">file_opened_hook</literal>.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term><parameter moreinfo="none">-s</parameter></term>
	<listitem>
	  <para>Use given stylesheet as the initial stylesheet for
	    every view.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term><parameter moreinfo="none">-n</parameter></term>
	<listitem>
	  <para>Allows to specify character encoding for the
	    <literal>FS</literal> backend (unlike e.g. XML
	    files, FS files provide no means to 
	    determine their character encoding).
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term><parameter moreinfo="none">-p</parameter></term>
	<listitem>
	  <para>A positive (or negative) integer value specifying the initial
	    number of vertical (or horizontal) views. If this option is 
	    used, TrEd automatically splits the window into that many views
	    and displays the <replaceable>n</replaceable>'th file on the command-line in the
	    <replaceable>n</replaceable>'th view (for
	    <replaceable>n</replaceable> up to the number of views).
	    If no files were specified on the command-line, but
	    <parameter>-l</parameter> was used, then
	    <replaceable>n</replaceable>'th view is associated with
	    <replaceable>n</replaceable>'th file-list specified in <parameter>-l</parameter>.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term><parameter moreinfo="none">-l</parameter></term>
	<listitem>
	  <para>This parameter may contain a comma-separated
	    list of files each containing one or more file-names
	    (one per line). TrEd reads these files and 
	    creates file-lists
	    named <literal>CmdLine-1</literal>,
	    <literal>CmdLine-2</literal>, etc. correspondingly.
	    Note that you may use <literal>-</literal>
	    notation for the standard input, e.g. if
	    called with <literal><command>tred</command> -l-</literal>,
	    <application>TrEd</application> will
	    expect file-names for <literal>CmdLine-1</literal>
	    on the standard input.
	    See also <xref linkend="filelists"/>.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term><parameter moreinfo="none">-q</parameter></term>
	<listitem>
	  <para>Request quiet operation, with as little
	    output from tred, as possible.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term><parameter moreinfo="none">-W</parameter></term>
	<listitem>
	  <para>Under X Window System, embed TrEd's main window into 
	    the window with given <replaceable>window-id</replaceable>.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term><parameter moreinfo="none">-B</parameter></term>
	<listitem>
	  <para>Comma separated list of additional 
	    I/O <replaceable>backends</replaceable> to
	    import.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term><parameter moreinfo="none">-G</parameter></term>
	<listitem>
	  <para>Do not resize TrEd's main window to its last saved
	    geomtery on startup (this option is useful when using
	    <parameter moreinfo="none">-W</parameter> to embed TrEd into other
	    applications).</para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term><parameter moreinfo="none">-Y</parameter></term>
	<listitem>
	  <para>Do not pre-load so called secondary files,
	    i.e. files with additional trees requested by main files (i.e. the
	    files opened by the user). This doesn't apply to
	    external resources loaded directly by I/O backends.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term><parameter moreinfo="none">-R</parameter></term>
	<listitem>
	  <para>
	    This option is specific to the CSTS backend.
	    When parsing CSTS files, try to restore structure from
	    <literal moreinfo="none">&lt;TRg&gt;</literal> tags rather than from
	    <literal moreinfo="none">&lt;g&gt;</literal>.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term><parameter moreinfo="none">-X <replaceable>gov</replaceable>,<replaceable>ord</replaceable></parameter></term>
	<listitem>
	  <para>
	    This option is specific to the CSTS backend.
	    When parsing CSTS files, try to restore structure from tags
	    <literal moreinfo="none">&lt;<replaceable>gov</replaceable>&gt;</literal> and
	    <literal
	      moreinfo="none">&lt;<replaceable>ord</replaceable>&gt;</literal>
	    rather then from
	    <literal moreinfo="none">&lt;<replaceable>g</replaceable>&gt;</literal> and
	    <literal
	      moreinfo="none">&lt;<replaceable>r</replaceable>&gt;</literal>.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term><parameter moreinfo="none">-h</parameter></term>
	<listitem>
	  <para>Prints a brief help and exits.</para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term><parameter moreinfo="none">-u</parameter></term>
	<listitem>
	  <para>Prints a short help on usage and exits.</para>
	</listitem>
      </varlistentry>
    </variablelist>
    <para>
      All other arguments passed to <application moreinfo="none">TrEd</application> on the command line
      are treated as file-names. 
      Unless <parameter>-p</parameter> was used,
      <application moreinfo="none">TrEd</application> opens the first of the
      files and the user may navigate to the next file and back
      using the <menuchoice moreinfo="none">
	<guimenu moreinfo="none">File</guimenu>
	<guimenuitem moreinfo="none">Next File</guimenuitem>
      </menuchoice> and
      <menuchoice moreinfo="none">
	<guimenu moreinfo="none">File</guimenu>
	<guimenuitem moreinfo="none">Previous File</guimenuitem></menuchoice> menu commands.)
    </para>
    <para>
      Every file-name either on the command-line or in a file-list
      may be followed by a suffix specifying a particular tree or node in
      the file. This node is activated when <application>TrEd</application>
      opens the file (if no suffix is given then the root node of the first
      tree in the file is activated). <application>TrEd</application>
      recognizes the following suffix forms:
    </para>
    <variablelist>
      <varlistentry>
	<term><literal moreinfo="none">##<replaceable>N</replaceable></literal></term>
	<listitem>
	  <para>
	    where <replaceable>N</replaceable> is a positive integer number.
	    This suffix specifies the root of the <replaceable>N</replaceable>'th
	    tree in the file.
	  </para>
	</listitem>
      </varlistentry>
      <varlistentry>
	<term><literal moreinfo="none">##<replaceable>N</replaceable>.<replaceable>M</replaceable></literal></term>
	<listitem>
	  <para>
	    where <replaceable>N</replaceable> is a positive integer number
	    and <replaceable>M</replaceable> is a non-negative integer number.
	    This suffix specifies the <replaceable>M</replaceable>'th
	    node of the <replaceable>N</replaceable>'th
	    tree in the file. The ordering of nodes 
	    <replaceable>M</replaceable> refers to is
	    the ordering of the deep-first traversal.
	  </para>
	</listitem>
      </varlistentry>
    </variablelist>
  </section>
  <section id="macros">
    <title>User Macros</title>
    <para>
      This section describes in detail
      <application moreinfo="none">TrEd</application>'s support for user macros
      and is dedicated mainly to programmers.
    </para>
    <para>
      As was already mentioned, <application moreinfo="none">TrEd</application> is
      itself written in Perl and therefore it is natural that also
      user macros are written in the Perl language. The details of the
      Perl language syntax are not described here. You may find
      them in various literature on programming in Perl as well as in
      manual pages of Perl language. A large volume of documentation
      on Perl and many specific Perl modules is collected for example
      by <ulink url="http://www.activestate.com/ASPN/Reference">ActiveState</ulink>.
      In this text, we concentrate on the 
      <application moreinfo="none">TrEd</application>'s macro
      specifics only.
    </para>
    <section>
      <title>A Macro</title>
      <para>
	A macro for <application moreinfo="none">TrEd</application> is simply a Perl
	routine defined using the <literal moreinfo="none">sub
	  <replaceable>name</replaceable> { ... }</literal>
	construct, e.g.:
      </para>
      <programlisting format="linespecific">sub my_first_macro {
 print "Hallo World\n";
}</programlisting>
      <para>
	Macros may be called from other macros in the same way as
	any other sub-routines in Perl, for example:
      </para>
      <programlisting format="linespecific">sub my_first_macro {
	my_second_macro();  # call to another macro
}</programlisting>
      <para>
	In this case, macros may use the usual Perl mechanisms
	to pass any number of argumens to the called macro.
      </para>
      <para>
	To make the macro accessible from
	<application moreinfo="none">TrEd</application>, two more things should be
	done. First, a special <quote>binding directive</quote> should be added,
	so that the macro appears in the
	<guimenu moreinfo="none">User-defined</guimenu> menu and thus may be
	called interactively, second the macro
	must be stored in some file and
	<application moreinfo="none">TrEd</application>
	must be told where to look for the file. This (and more) is
	discussed in the following sections.
      </para>      
    </section>
    <section>
      <title>Macro files</title>
      <para>
	On startup, <application moreinfo="none">TrEd</application>
	looks for two files with macros.
	<orderedlist continuation="restarts" inheritnum="ignore">
	  <listitem>
	    <para>The default set of macros (described in more detail
	      in <xref linkend="defaultmacros"/>)
	      <filename moreinfo="none">tred.def</filename>
	    </para>
	  </listitem>
	  <listitem>
	    <para>The user set of macros <filename moreinfo="none">tred.mac</filename>
	      or any other file given after the
	      <parameter moreinfo="none">-m</parameter> parameter on the command line 
	      or a file specified in the
	      <application moreinfo="none">TrEd</application>'s configuration
	      option <literal moreinfo="none">MacroFile</literal>.	      
	    </para>
	  </listitem>
	</orderedlist>
	Macro programmers are supposed to keep the
	<filename moreinfo="none">tred.def</filename> file unchanged, but are
	encouraged to modify or append the
	<filename moreinfo="none">tred.mac</filename> macro file according to their
	needs. 
      </para>
      <para>
	Other macro files may be included into any
	<filename moreinfo="none">tred.mac</filename> file using one of the following
	<literal moreinfo="none">#include</literal> directives where
	<replaceable>filename</replaceable> is supposed to provide
	a relative or absolute path to the macro file, under the
	terms described below each item:
      </para>
      <variablelist>
	<varlistentry>
	  <term><literal moreinfo="none">#include "<replaceable>filename</replaceable>"</literal></term>
	  <listitem>
	    <para>The <replaceable>filename</replaceable> must be
	      relative to the directory of the file to which it is
	      included.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><literal moreinfo="none">#include &lt;<replaceable>filename</replaceable>&gt;</literal></term>
	  <listitem>
	    <para>The <replaceable>filename</replaceable> must
	      be relative to the TrEd's library directory.</para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><literal moreinfo="none">#include "&lt;<replaceable>wildcard</replaceable>&gt;"</literal></term>
	  <listitem>
	    <para>Expands <replaceable>wildcard</replaceable> 
	      relatively to the directory of the file containing the
	      directive and includes all matching file.</para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><literal moreinfo="none">#include <replaceable>filename</replaceable></literal></term>
	  <listitem>
	    <para>
	      The <replaceable>filename</replaceable> may be
	      both absolute or relative. In the latter case the directories are
	      searched in the following order:
	      <orderedlist continuation="restarts" inheritnum="ignore">
		<listitem>
		  <para>Current directory is searched.</para>
		</listitem>
		<listitem>
		  <para>The directory of the file where the
		    <literal moreinfo="none">#include</literal> directive occured
		    is searched.
		  </para>
		</listitem>
		<listitem>
		  <para><application moreinfo="none">TrEd</application>'s library directory
		    is searched.
		  </para>
		</listitem>
	      </orderedlist>
	    </para>
	  </listitem>
	</varlistentry>
      </variablelist>
      <para>
	If <literal moreinfo="none">#include</literal> fails to find given file,
	it is a fatal error and
	<application moreinfo="none">TrEd</application>/<application moreinfo="none">bTrEd</application>
	immediatelly stops. You may use
	<literal moreinfo="none">#ifinclude</literal> directive, if you wish
	<literal moreinfo="none">TrEd</literal> to continue (without error or warning)
	even if the requested file was not found.
      </para>
    </section>
    <section id="macroencodings">
      <title>Using various character encodings</title>
      <note>
	<para>This section applies only to <application moreinfo="none">TrEd</application>/<application moreinfo="none">bTrEd</application> running under Perl 5.8
	and higher.</para>
      </note>
      <para>
	If non-ASCII characters should occur in macro code, it is
	necessary to indicate the character encoding used.  Otherwise
	<application moreinfo="none">TrEd</application> wouldn't be able to translate the non-ASCII characters
	into an internal Unicode representation.  Failing to indicate
	encoding used in macro code can therefore lead to unexpected
	behaviour of the code and/or fatal run-time errors.
      </para>
      <para>
	By default, <application moreinfo="none">TrEd</application> 
	expects UTF-8 encoded macro code (unless specified
	otherwise using the <link linkend="defaultmacroencoding">
	  <literal moreinfo="none">defaultMacroEncoding</literal> configuration option</link>).
	Any other character encoding must be indicated using
	<literal moreinfo="none">#encoding</literal> directive, followed by name of
	the encoding, such as <literal moreinfo="none">utf-8</literal>,
	<literal moreinfo="none">iso-8859-1</literal>, <literal moreinfo="none">windows-1256</literal>,
	etc. The encoding indicated by an <literal moreinfo="none">#encoding</literal>
	directive applies on the macro file strating from the line following the directive
	to the end of the file or to another <literal moreinfo="none">#encoding</literal>
	directive occurence, whichever happens first. Encoding directive does not
	apply to included macro files.
      </para>
      <example>
	<title>Indicating macro character encoding</title>
	<programlisting format="linespecific">
  (UTF-8 encoded macro code)

#encoding iso-8859-2
  
  (latin-2 encoded macro code)

#encoding utf-8

  (UTF-8 encoded macro code continues)
	</programlisting>
      </example>
    </section>
    <section>
      <title>Conditional macro code</title>
      <para>
	If macro code is spanned across	several files or is shared
	between <application moreinfo="none">TrEd</application> and
	<application moreinfo="none">bTrEd</application>, it may be useful
	to make some parts of the macro code (such as an
	<literal moreinfo="none">#include</literal> directive) conditional.
      </para>
      <para>
	For this purpose <application moreinfo="none">TrEd</application>,
	provides similar mechanisms as standard <literal moreinfo="none">C</literal>
	pre-processors using
	<literal moreinfo="none">#define</literal>,
	<literal moreinfo="none">#undefine</literal>,
	<literal moreinfo="none">#ifdef</literal>,
	<literal moreinfo="none">#ifndef</literal>, and
	<literal moreinfo="none">#endif</literal> directives.
	These directives must appear on the very beginning of line.
	Any code enclosed within
	<literallayout class="normal" format="linespecific">#ifdef	<replaceable>symbol-name</replaceable></literallayout> 
	and <literallayout class="normal" format="linespecific">#endif</literallayout> directives
	is included if and only if
	the symbol <literal moreinfo="none"><replaceable>symbol-name</replaceable></literal>
	was previously defined using a <literal moreinfo="none">#define
	<replaceable>symbol-name</replaceable></literal>
	directive. 
	Any code enclosed within
	<literallayout class="normal" format="linespecific">#ifndef <replaceable>symbol-name</replaceable></literallayout> 
	and <literallayout class="normal" format="linespecific">#endif</literallayout> directives
	is included if and only if
	the symbol <literal moreinfo="none"><replaceable>symbol-name</replaceable></literal>
	is not defined.
	A defined
	symbol can later be undefined 
	with <literal moreinfo="none">#undefine
	<replaceable>symbol-name</replaceable></literal>.
	Unlike <literal moreinfo="none">C</literal> macros,
	symbols in <application moreinfo="none">TrEd</application> have no other
	purpose than this.
      </para>
      <para>
	Except for symbols defined by a <literal moreinfo="none">#define</literal>
	directive, symbol <literal moreinfo="none">TRED</literal> is always initially
	defined in <application moreinfo="none">TrEd</application>, symbol
	<literal moreinfo="none">BTRED</literal> is always initially defined in
	<application moreinfo="none">bTrEd</application>. This may help to simplify
	sharing macro code with specific parts for
	<application moreinfo="none">TrEd</application> and
	<application moreinfo="none">bTrEd</application> between these two
	applications.
      </para>
    </section>
    <section>
      <title>Associating macros with menu entries and keyboard shortcuts</title>
      <para>
	The last set of directives is used for convenient adding
	of macros to <application moreinfo="none">TrEd</application>'s
	<guimenu moreinfo="none">User-defined</guimenu> menu and for
	associating macros with keyboard shortcuts.
      </para>
      <para>
	To connect a macro named <literal moreinfo="none">my_first_macro</literal> with a 
	new menu item labeled <guimenuitem moreinfo="none">My First
	Macro</guimenuitem>
	under the <guimenu moreinfo="none">User-defined</guimenu> menu,
	the following directive should appear in some macro
	file read by <application moreinfo="none">TrEd</application>:
      </para>
      <literallayout class="normal" format="linespecific">#insert <replaceable>my_first_macro</replaceable> as menu <replaceable>My First Macro</replaceable></literallayout>
      <para>
	Actually the words <literal moreinfo="none">as</literal> and
	<literal moreinfo="none">menu</literal> may be omitted, so it is
	possible to write the above directive also as:
      </para>
      <literallayout class="normal" format="linespecific">#insert <replaceable>my_first_macro</replaceable> as <replaceable>My First Macro</replaceable></literallayout>
      <para>or even</para>
      <literallayout class="normal" format="linespecific">#insert <replaceable>my_first_macro</replaceable> <replaceable>My First Macro</replaceable></literallayout>
      <para>
	Association between a macro and a keyboard shortcut is defined
	using the directive <literal moreinfo="none">#bind</literal>.
	For example, to <quote>bind</quote> a macro named
	<literal moreinfo="none">my_first_macro</literal> to say
	<keycombo moreinfo="none" action="simul">
	  <keycap moreinfo="none">Ctrl</keycap>
	  <keycap moreinfo="none">Alt</keycap>
	  <keycap moreinfo="none">Del</keycap>
	</keycombo>
	keyboard shortcut, the following line should appear somewhere
	in the macro file:
      </para>
      <literallayout class="normal" format="linespecific">#bind <replaceable>my_first_macro</replaceable> to key <replaceable>Ctrl+Alt+Del</replaceable></literallayout>
      <para>
	Again, the <literal moreinfo="none">to</literal> and
	<literal moreinfo="none">key</literal> keywords may be omitted.	
      </para>
      <warning>
	<para>
	  Using the particular shortcut chosen here as a funny example
	  is a silly idea indeed, since this very shortcut is typicaly
	  used to restart the system. Remember that only shortcuts
	  that are not interpreted by the operating system or the
	  desktop environment can possibly work as expected.
	</para>
      </warning>
      <para>Both a menu item and a keyboard shortcut can be associated
	with a macro in one step with a directive of the following :
      </para>
      <literallayout class="normal" format="linespecific">#bind <replaceable>my_first_macro</replaceable> to key <replaceable>Ctrl+Alt+Del</replaceable> menu <replaceable>My First Macro</replaceable></literallayout>
      <para>
	If more than one keyboard shortcut or menu item are associated
	with the same macro, any of them may be used to invoke the
	macro. If more than one macro was associated with the same
	keyboard shortcut, then the latest binding is used.  Also, if
	two or more macros with the same name appear in the loaded
	macro files (within the same package), the last one is used,
	but that holds in general for any Perl subroutine.
      </para>
      <literallayout class="normal" format="linespecific">#unbind-key <replaceable>Ctrl+Alt+Del</replaceable></literallayout>
      <literallayout class="normal" format="linespecific">#remove-menu <replaceable>My First Macro</replaceable></literallayout>
      <para>
	The first of the  directives above removes an existing key-bindning from
	current binding context(s). The second one removes an existing menu
	item from the submenu of <guimenu>User-defined</guimenu>
	pertaining to the current binding context.
	These directives is especially useful for disabling certain functionality and bindings of an incuded
	macro file.
      </para>
    </section>
    <section>
      <title>When macro ends</title>
      <para>
	When an interactively invoked macro returns, <application
	  moreinfo="none">TrEd</application> performs the following
	steps:
	<itemizedlist>
	  <listitem>
	    <para>the node referenced in <literal moreinfo="none">$this</literal>
	      is activated in the current view (provided it belongs to
	      the current tree)
	    </para>
	  </listitem>
	  <listitem>
	    <para>
	      all views are redrawn (unless specified otherwise in the
	      variable<literal moreinfo="none">$Redraw</literal>), see
	      below.
	    </para>
	  </listitem>
	  <listitem>
	    <para>
	      unless the value of the variable <literal
	      moreinfo="none">$FileChanged</literal> (see <xref linkend="defaultmacros"/>) is set to 0,
	      the save-status of the current file is turned to <literal
		moreinfo="none">modified</literal>
	      (as indicated by the state of the
		<inlinemediaobject><imageobject><imagedata
		fileref="pics/filefloppy.png" format="PNG"
		role="html"/></imageobject><imageobject><imagedata
		fileref="pics/filefloppy.eps" format="EPS"
		role="latex"/></imageobject><imageobject><imagedata
		fileref="pics/filefloppy"
		format="linespecific"/></imageobject></inlinemediaobject>
		button). 
	    </para>
	  </listitem>
	</itemizedlist>
      </para>
      <para>
	The variable <literal moreinfo="none">$Redraw</literal> may have the following
	values:
	<variablelist>
	  <varlistentry>
	    <term><literal moreinfo="none">file</literal> (the default)</term>
	    <listitem>
	      <para>redraw all windows displaying current file</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term><literal moreinfo="none">tree</literal></term>
	    <listitem>
	      <para>redraw all windows displaying current tree</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term><literal moreinfo="none">win</literal></term>
	    <listitem>
	      <para>redraw current window</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term><literal moreinfo="none">all</literal></term>
	    <listitem>
	      <para>redraw all windows</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term><literal moreinfo="none">tie</literal></term>
	    <listitem>
	      <para>redraw all windows if TrEd windows are tied
		otherwise redraw only the current one</para>
	    </listitem>
	  </varlistentry>
	  <varlistentry>
	    <term><literal moreinfo="none">none</literal></term>
	    <listitem>
	      <para>disables redrawing</para></listitem>
	  </varlistentry>
	</variablelist>
      </para>
      <para>
	Because <application>TrEd</application> has no way to identify
	whether the current file (or in fact any other file) was
	actually modified by the macro, it always assumes it was.  To
	prevent this and indicate that no actual changes which would
	require the user to save the file were done to the current
	file, the macro must explicitly set a special variable named
	<literal moreinfo="none">$FileChanged</literal> to zero.  Even
	better (to prevent accidental collisions between several
	assignments to this variable), instead of directly assigning
	to this variable, call the default macro
	<literal>ChangingFile(0)</literal>.
      </para>
      <para>
	To make things more complicated, it should be noted, that
	<command>btred</command>, the off-line variant of
	TrEd, never saves any processed file unless the variable
	<literal moreinfo="none">$FileChanged</literal> has been explicitely set to
	<literal moreinfo="none">1</literal> or <literal moreinfo="none">-S</literal> command-line
	switch is used. So, conversely, in <command>btred</command>, a macro
	should indicate making a change worth saving by calling <literal>ChangingFile(1)</literal>.
      </para>
      <note>
	<para>If the state of the file was already
	  <emphasis>modified and not saved</emphasis> when a
	  macro was interactively invoked, then any changes to
	  the <literal moreinfo="none">$FileChanged</literal> variable made
	  by the macro are ignored. Macro may however force the
	  file status to return to <emphasis>saved</emphasis>
	  by setting the variable <literal moreinfo="none">$forceFileSaved</literal>
	  to <literal moreinfo="none">1</literal> (typically after an
	  explicit call to <literal>Save()</literal>).
	</para>
      </note>
      <note>
	<para>For historical reasons, there exists an alias for
	  <literal moreinfo="none">$FileChanged</literal> named
	  <literal moreinfo="none">$FileNotSaved</literal>. These variables are
	  identical.
	</para>
      </note>
    </section>
    <section>
      <title>Accessing tree nodes</title> <para>All tree nodes in
      <application moreinfo="none">TrEd</application> are represented
      by <classname>FSNode</classname> Perl objects. These objects are
      basically only hash references where the
      attribute-name/attribute-value information is stored as a
      key/value pair (except that some hash keys are reserved for
      representing the tree structure).  The
      <classname>FSNode</classname> object provides several basic
      methods, most of which are related to accessing its neighbouring nodes
      in the tree.
      </para>
      <para>Macros may refer to nodes using the following
	global variables (declared within the <literal moreinfo="none">TredMacro</literal>
	package, but exported by default to other derived
	packages):
      </para>
      <variablelist>
	<varlistentry>
	  <term><literal moreinfo="none">$this</literal></term>
	  <listitem>
	    <para>Is the active node in the current tree.
	      Macros may use this variable to access the active node,
	      it's attributes, methods etc. They also may assign
	      to this variable to activate a different node.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><literal moreinfo="none">$root</literal></term>
	  <listitem>
	    <para>Is the root of the current tree.  Macros may use
	      this variable to access the root of the tree and (by
	      following the tree edges) to access the whole tree.
	      Assigning to this variable has no visible effect.
	    </para>
	  </listitem>
	</varlistentry>
      </variablelist>
      <section>
	<title>Accessing node attributes</title>
	<para>
	  Let <literal moreinfo="none">$node</literal> be a
	  <classname>FSNode</classname> object, i.e. a node of the
	  tree. Typically, nodes are attribute-value structures, so the
	  attribute named <literal
	  moreinfo="none"><replaceable>attrib</replaceable></literal>
	  is accessible as <literal moreinfo="none">$node-&gt;{<replaceable>attrib</replaceable>}</literal>.
	  Assigning a different value, say <replaceable>$val</replaceable>, to the attribute
	  <literal moreinfo="none"><replaceable>attrib</replaceable></literal> is
	  as simple as this:
	</para>
	<literallayout class="normal"
	format="linespecific">$node-&gt;{<replaceable>attrib</replaceable>}=$val;</literallayout>
	<para>
	  Attribute values may not always be atomic, i.e. numbers or
	  strings (although for most backends this is the case). They
	  may also be AVS structures (represented as Perl hashes),
	  lists (represented as Perl ARRAY references of the
	  <classname>Fslib::List</classname> class) and 
	  alternatives (represented as Perl ARRAY references of
	  the <classname>Fslib::List</classname> class). So let's
	  suppose for a while, that the value of <literal
	  moreinfo="none">$node-&gt;{<replaceable>attrib</replaceable>}</literal>
	  is an AVS structure with attribute
	  <replaceable>level2-attrib</replaceable> and it's value is a
	  list of structures with an attribute
	  <replaceable>level3-attrib</replaceable> whose value (of
	  whatever type it is) we want to get and possibly change.  To
	  access the attribute
	  <replaceable>level3-attrib</replaceable>, we may either use
	  Perl-only syntax and proceed e.g. as follows:
	  <literallayout>$node->{attrib}{level2-attrib}[0]{level3-attrib}</literallayout>
	  Notice, that from the list of structures in
	  <replaceable>level2-attrib</replaceable> we have only
	  selected the first one (in Perl, array indexes start with
	  0).  This approach has a non-obvious drawback: if on some
	  level the value is not defined, Perl
	  <quote>auto-creates</quote> an empty structure on that level
	  (this <quote>auto-creation</quote> continues also for all
	  further levels of the expression). Hence, by querying a
	  value, we have actually made a change. This typically is an
	  undesirable effect. There are two ways to avoid it: first
	  would be to follow the nesting of the Perl structures one
	  level at a time and on every step first check that the value
	  on that level is non-empty. This is however makes the code
	  less readable and unnecessarily complex.  Second method
	  provides the same functionality with a nice syntax using so
	  called <firstterm>attribute-paths</firstterm>.  Attribute
	  path is an expression similar to a directory path or XPath
	  and expresses a path in the nesting of the Perl structures.
	  Using attribute-paths, the expression
	  <programlisting>$node->{<replaceable>attrib</replaceable>}{<replaceable>level2-attrib</replaceable>}[0]{<replaceable>level3-attrib</replaceable>}</programlisting>
	  could be rewritten as
	  <programlisting>$node->attr('<replaceable>attrib</replaceable>/<replaceable>level2-attrib</replaceable>/[1]/<replaceable>level3-attrib</replaceable>')</programlisting>
	  The method <methodname>attr</methodname> resolves
	  attribute-paths safely, avoiding auto-creation of Perl
	  structures on the way. Note, that in the attribute-path,
	  list and alternative members are indexed starting from 1.
	  In fact, if we want to access the 1st element, we may 
	  completely skip the index specification and write:
	  <programlisting>$node->attr(<replaceable>'attrib</replaceable>/<replaceable>level2-attrib</replaceable>/<replaceable>level3-attrib</replaceable>')</programlisting>
	  Sometimes it is necessary to iterate over all list members
	  of some attributes. The macro
	  <literal>ListV</literal>
	  (and its cousin macro <literal>AltV</literal> used for
	  alternatives) can be used to produce a list of all values
	  of a given attribute, e.g.
	  <programlisting>foreach my $member (ListV($node->attr('<replaceable>attrib</replaceable>/<replaceable>level2-attrib</replaceable>'))) {
  # process list member $member
	    print $member->{<replaceable>level3-attrib</replaceable>},"\n";
}</programlisting>
	</para>
	<para>Values of attributes can be changed by pure Perl
	assignments, e.g.
	  <programlisting>$node->{<replaceable>attrib</replaceable>} = <replaceable>new_value</replaceable>;</programlisting>
	  or
	  <programlisting>$node->{<replaceable>attrib</replaceable>}{<replaceable>level2-attrib</replaceable>}[0]{<replaceable>level3-attrib}</replaceable> = <replaceable>new_value</replaceable></programlisting>
	  The previous assign ment may also be achieved using
	  <programlisting>$node->set_attr('<replaceable>attrib</replaceable>/<replaceable>level2-attrib</replaceable>/[1]/<replaceable>level3-attrib</replaceable>',<replaceable>new_value</replaceable>);</programlisting>
	</para>
	<para>The macro <literal>List</literal> can be used to
	  construct a new list value. Several other default macros for
	  dealing with list and alternative values exists (see <xref
	  linkend="defaultmacros"/>).</para>
      </section>
      <section>
	<title>Accessing neighboring nodes</title>
	<para>
	  There is a few methods provided by every
	  <classname>FSNode</classname> reference that can be used
	  to access other nodes in the tree. Each of the methods
	  returns either a <classname>FSNode</classname> reference
	  pointing to the requested node, or zero if 
	  the requested node does not exist. For example, the
	  following code may be used to make the active node's
	  parent node active:
	</para>
	<programlisting format="linespecific">$this = $this-&gt;parent if ($this-&gt;parent);</programlisting>
	<para>
	  The above code states: activate the parent node of the
	  currently active node in case the currently active node
	  has a parent.
	</para>
	<para>
	  The following table describes all available
	  <classname>FSNode</classname> methods:
	</para>
	<table>
	  <title><classname>FSNode</classname> methods</title>
	  <tgroup cols="2">
	    <colspec colnum="1" align="left"/>
	    <colspec colnum="2" align="justify"/>
	    <thead>
	      <row>
		<entry>Method name</entry>
		<entry>Description</entry>
	      </row>
	    </thead>
	    <tbody>
	      <row>
		<entry><literal moreinfo="none">parent</literal></entry>
		<entry>Return node's parent node.</entry>
	      </row>
	      <row>
		<entry><literal moreinfo="none">firstson</literal></entry>
		<entry>Return the first child node of the given node
		  (the first node depending on the given node).</entry>
	      </row>
	      <row>
		<entry><literal moreinfo="none">rbrother</literal></entry>
		<entry>
		  Return the right
		  brother of the given node. However, hence the nodes
		  may be displayed in the order given by the special
		  FS-format numbering attribute <literal moreinfo="none">@N</literal>,
		  the returned node need not necessarily be displayed to
		  the right of the given node. This is because the
		  ordering according to the special numbering attribute
		  does not have to correspond to the deep-first structure
		  ordering of the tree.
		</entry>
	      </row>
	      <row>
		<entry><literal moreinfo="none">lbrother</literal></entry>
		<entry>
		  Return the left
		  brother of the given node. However, as for the 
		  right brother, hence the nodes
		  may be displayed in the order given by the special
		  FS-format numbering attribute <literal moreinfo="none">@N</literal>,
		  the returned node need not necessarily be displayed to
		  the left of the given node. This is because the
		  ordering according to the special numbering attribute
		  does not have to correspond to the deep-first structure
		  ordering of the tree.
		</entry>
	      </row>
	      <row>
		<entry><literal moreinfo="none">following(<replaceable>top</replaceable>?)</literal></entry>
		<entry>
		  Return the next node of the given node in the
		  natural ordering of the tree provided by the
		  tree structure. E.g. if the given node has a child,
		  this child is returned. If the node has no childs
		  but does have a right brother,
		  <classname>FSNode</classname>
		  reference to the right brother is returned.
		  If no child and no right brother exists for the
		  given node, the method looks for a right brother
		  of its nearest ancestor, etc. Starting from the root
		  of the tree and calling this method repeatedly
		  on the returned nodes ensures that all the nodes
		  in the trees are accessed during the procedure.
		  If the optional argument <replaceable>top</replaceable>
		  contains a <classname>FSNode</classname> reference,
		  the searching is limited to the subtree governed by 
		  the node of <replaceable>top</replaceable>.
		</entry>
	      </row>
	      <row>
		<entry><literal moreinfo="none">previous(<replaceable>top</replaceable>?)</literal></entry>
		<entry>
		  Return the previous node of the given node in the
		  deep-first ordering of the tree provided by the tree
		  structure (see the above description of the
		  <literal moreinfo="none">following</literal>
		  method for more detail on the ordering).
		  If the optional argument <replaceable>top</replaceable>
		  contains a <classname>FSNode</classname> reference,
		  the searching is limited to the subtree governed by 
		  the node of <replaceable>top</replaceable>.
		</entry>
	      </row>
	      <row>
		<entry><literal moreinfo="none">children</literal></entry>
		<entry>
		  Return a list of all child-nodes of the given node.
		  The nodes in the list are ordered in their
		  structural order starting from the first son of their parent,
		  each node followed by its right brother.
		</entry>
	      </row>
	    </tbody>
	  </tgroup>
	</table>
      </section>
      <section>
	<title>Accessing other trees</title>
	<para>
	  For this purpose many default macros exist and we recommend
	  read their documentation first (see <xref
	  linkend="defaultmacros"/>). In this section we describe more
	  low-level approach that utilizes one of the most fundamental
	  internal structures used by <application>TrEd</application>,
	  namely the <quote>grouping</quote> structure. This structure
	  may be accessed using the <literal
	  moreinfo="none">$grp</literal> variable.  There is really a
	  lot of things that can be achieved by using this variable in
	  a proper way, but because it is an open gate to
	  <application>TrEd</application> internals, it may also be
	  dangerous. Here, we only pay our attention to a few of the
	  safe features of <literal>$grp</literal>. In most cases,
	  using wrappers over this structure provided by default
	  macros, is still a much safer option.
	</para>
	<para>
	  The current file is accessed via the
	  <literal moreinfo="none">$grp-&gt;{FSFile}</literal> reference. This reference
	  is a pointer to an object of the <classname>FSFile</classname>
	  class. The following methods are provided for the class:
	</para>
	<table>
	  <title><classname>FSFile</classname> class methods</title>
	  <tgroup cols="2">
	    <colspec colnum="1" align="left"/>
	    <colspec colnum="2" align="justify"/>
	    <thead>
	      <row>
		<entry>Method name</entry>
		<entry>Description</entry>
	      </row>
	    </thead>
	    <tbody>
	      <row>
		<entry><literal moreinfo="none">filename</literal></entry>
		<entry>Returns current file's name.</entry>
	      </row>
	      <row>
		<entry><literal moreinfo="none">changeFilename(<replaceable>name</replaceable>)</literal></entry>
		<entry>Change current file's name.</entry>
	      </row>
	      <row>
		<entry><literal moreinfo="none">FS</literal></entry>
		<entry>Return a reference to an associated
		  <classname>FSFormat</classname> object.
		</entry>
	      </row>
	      <row>
		<entry><literal moreinfo="none">trees</literal></entry>
		<entry>Return a list of all trees (i.e.
		  a list of <classname>FSNode</classname>
		  object references pointing to the roots
		  of the trees).
		</entry>
	      </row>
	      <row>
		<entry><literal moreinfo="none">hint</literal></entry>
		<entry>Return the <application moreinfo="none">TrEd</application>'s
		hint pattern associated with the file.</entry>
	      </row>
	      <row>
		<entry><literal moreinfo="none">changeHint(<replaceable>pattern</replaceable>)</literal></entry>
		<entry>Change the <application moreinfo="none">TrEd</application>'s
		  hint pattern associated with the file.
		</entry>
	      </row>
	      <row>
		<entry><literal moreinfo="none">pattern(<replaceable>n</replaceable>)</literal></entry>
		<entry>Return the <replaceable>n</replaceable>'th 
		  attribute pattern associated with the file.</entry>
	      </row>
	      <row>
		<entry><literal moreinfo="none">patterns</literal></entry>
		<entry>Return a list of all attribute patterns
		associated with the file.</entry>
	      </row>
	      <row>
		<entry><literal moreinfo="none">pattern_count</literal></entry>
		<entry>Return the number of display attribute patterns
		associated with the file.</entry>
	      </row>
	      <row>
		<entry><literal moreinfo="none">changePatterns(<replaceable>patterns</replaceable>)</literal></entry>
		<entry>Change the list of  attribute patterns
		  associated with the file.</entry>
	      </row>
	    </tbody>
	  </tgroup>
	</table>
	<para>
	  Actually, some other <classname>FSFile</classname> methods
	  exist, but as they are not intended to be used from the
	  macros directly, there is no reason to describe them here.
	</para>
	<para>
	  The most important of the methods above is the <literal
	  moreinfo="none">FS</literal> method which may be used to
	  access the <classname>FSFormat</classname> class object
	  associated with the given file. Similarly as in the case of
	  <classname>FSFile</classname> class, only the most importand
	  methods of the <classname>FSFormat</classname> class are
	  described here.
	</para>
	<table>
	  <title><classname>FSFormat</classname> class methods</title>
	  <tgroup cols="2">
	    <colspec colnum="1" align="left"/>
	    <colspec colnum="2" align="justify"/>

	    <thead>
	      <row>
		<entry>Method name</entry>
		<entry>Description</entry>
	      </row>
	    </thead>
	    <tbody>
	      <row id="FS.order">
		<entry><literal moreinfo="none">order</literal></entry>
		<entry>Return the name of the special numerical FS attribute
		  responsible for providing the tree order. This
		  attribute is declared in the FS file as <literal moreinfo="none">@N</literal>.
		</entry>
	      </row>
	      <row id="FS.sentord">
		<entry><literal moreinfo="none">sentord</literal></entry>
		<entry>Return the name of the special numerical FS attribute
		  responsible for providing the order of the values
		  to form a <quote>sentence</quote>. This
		  attribute is declared in the FS file as
		  <literal moreinfo="none">@W</literal>.
		</entry>
	      </row>
	      <row id="FS.value">
		<entry><literal moreinfo="none">value</literal></entry>
		<entry>Return the name of the special FS attribute
		  providing a descriptive value of the node used when
		  forming a <quote>sentence</quote>. This
		  attribute is declared in the FS file as
		  <literal moreinfo="none">@V</literal>.</entry>
	      </row>
	      <row>
		<entry><literal moreinfo="none">hide</literal></entry>
		<entry>Return the name of the special FS attribute
		  which can be used to hide several subtrees. This
		  attribute is declared in the FS file as
		  <literal moreinfo="none">@H</literal>; a subtree is
		  hidden if its governing node's value for this
		  attribute is <literal moreinfo="none">'hide'</literal>.</entry>
	      </row>
	      <row>
		<entry><literal moreinfo="none">isHidden(<replaceable>node</replaceable>)</literal></entry>
		<entry>Return true if the given <classname>FSNode</classname>
		<replaceable>node</replaceable> belongs to a hidden subtree.
		</entry>
	      </row>
	      <row>
		<entry><literal moreinfo="none">isList(<replaceable>attr</replaceable>)</literal></entry>
		<entry>Return true if the given attribute is of list
		  type with a strictly defined set of possible
		  values. This type of attributes is declared by
		  the <literal moreinfo="none">@L</literal> header in the FS format.
		</entry>
	      </row>
	      <row>
		<entry><literal moreinfo="none">listValues(<replaceable>attr</replaceable>)</literal></entry>
		<entry>Return a list of all possible values for the
		given attribute <replaceable>attr</replaceable>. Empty
		list is retured in case the attribute is not of the
		list type.
		</entry>
	      </row>
	      <row>
		<entry><literal moreinfo="none">color(<replaceable>attr</replaceable>)</literal></entry>
		<entry>
		  Return one of the <literal moreinfo="none">Shadow</literal>,
		  <literal moreinfo="none">Hilite</literal>,
		  <literal moreinfo="none">XHilite</literal> and
		  <literal moreinfo="none">normal</literal>
		  values, depending on the
		  color specified in the FS file header.
		</entry>
	      </row>
	      <row>
		<entry><literal moreinfo="none">attributes</literal></entry>
		<entry>Return a list containing names of all the
		attributes declared in the FS file header.</entry>
	      </row>
	      <row>
		<entry><literal moreinfo="none">atno(<replaceable>n</replaceable>)</literal></entry>
		<entry>Return name of the
		  <replaceable>n</replaceable>'th
		  attribute.
		</entry>
	      </row>
	      <row>
		<entry><literal moreinfo="none">indexOf(<replaceable>attr</replaceable>)</literal></entry>
		<entry>Return index of the attribute named 
		  <replaceable>attr</replaceable>, according
		  to the order in which attributes are defined in the
		  FS file.
		</entry>
	      </row>
	      <row>
		<entry><literal moreinfo="none">count</literal></entry>
		<entry>Return the number of attributes defined in the FS file.</entry>
	      </row>
	      <row>
		<entry><literal moreinfo="none">exists(<replaceable>attr</replaceable>)</literal></entry>
		<entry>Return true if attribute named
		  <replaceable>attr</replaceable> exists for the FS
		  file. If it is not the case, false (i.e. zero) is returned.
		</entry>
	      </row>
	      <row>
		<entry><literal moreinfo="none">make_sentence(<replaceable>root_node</replaceable>)</literal></entry>
		<entry>Return a string forming a
		  <quote>sentence</quote> for the given node's subtree. 
		  The sentence is formed in the following way:
		  <orderedlist continuation="restarts" inheritnum="ignore">
		    <listitem>
		      <para>
			All the nodes of the
			<replaceable>root_node</replaceable> node's
			subtree and ordered according to their values
			for the special numerical FS sentence ordering
			attribute (see method <link linkend="FS.sentord"><literal moreinfo="none">sentord</literal></link>
			above). The special FS numbering attribute
			(see method <link linkend="FS.order"><literal moreinfo="none">order</literal></link>
			above) is used if no sentence ordering
			attribute is declared in the FS file.
		      </para>
		    </listitem>
		    <listitem>
		      <para>
			For every such node, its descriptive value
			(see
			method <link linkend="FS.order"><literal moreinfo="none">value</literal></link>
			above) is taken.
		      </para>
		    </listitem>
		    <listitem>
		      <para>
			The values obtained in this way and order
			are joined into a single string with fields
			separated by the value of
			<replaceable>separator</replaceable>.  </para>
		    </listitem>
		  </orderedlist>
		</entry>
	      </row>
	    </tbody>
	  </tgroup>
	</table>
	<para>
	  The methods <literal moreinfo="none">sentord</literal>,
	  <literal moreinfo="none">order</literal>,
	  <literal moreinfo="none">value</literal>, and
	  <literal moreinfo="none">hide</literal> described above
	  are useful especially in macros of
	  general purposes, where names of the corresponding
	  attributes are not known in advance. However, one should
	  keep in mind that calling these functions too often
	  may result in considerably worse performence. 
	  The following example which actually re-implements the
	  <literal moreinfo="none">make_sentence</literal> method shows usage
	  of the <classname>FSFormat</classname> object member
	  methods.	  
	</para>
	<informalexample>
	  <programlisting format="linespecific">
sub MakeSentence {
  my ($top,$separator)=@_;   # two parameters

  $separator = ' ' unless defined($separator);
  my @nodes  = ();           # array to store the nodes in
  my $ord    = $grp-&gt;{FSFile}-&gt;FS-&gt;sentord ||
	       $grp-&gt;{FSFile}-&gt;FS-&gt;order;
  my $value  = $grp-&gt;{FSFile}-&gt;FS-&gt;value;

  my $node = $top;
  while ($node) {
    push @nodes, $node;      # collect all nodes in the nodes array
    $node = $node-&gt;following($top);
  }

  # Translation of the following mighty Perl construct to English:
  # 1. sort the collected nodes comparing their values for attribute $ord
  # 2. get their values using a "map" which maps element $_ to $_-&gt;{$value}
  # 3. join the values separating the fields with $separator
  # 4. and finally return the string.

  return join( $separator,
	       map { $_-&gt;{$value} }
	       sort { $a-&gt;{$ord} &lt;=&gt; $b-&gt;{$ord} } @nodes );
}
	  </programlisting>
	</informalexample>
	<para>
	  If the values of <literal moreinfo="none">value</literal>, <literal moreinfo="none">sentord</literal> or
	  possibly <literal moreinfo="none">order</literal> were evaluated each
	  time the Perl <literal moreinfo="none">sort</literal> or
	  <literal moreinfo="none">map</literal> function needs to compare or map
	  nodes, the performance of the code would considerably decrease.
	</para>
      </section>
    </section>
    <section id="defaultmacros">
      <title>Public API: pre-defined macros</title>
      <para>
	The role of a public API available to macros is played by a set of
	macros defined in the <literal moreinfo="none">TredMacro</literal> package
	in the file named <filename moreinfo="none">tred.def</filename>.
	Most of these pre-defined macros are just safe wrappers for 
	<application moreinfo="none">TrEd</application> internal function
	calls. Pre-defined macros and object methods (namely those of
	<literal moreinfo="none">FSNode</literal>, <literal moreinfo="none">FSFile</literal> and
	<literal moreinfo="none">FSFormat</literal>) should be the only access points
	used by a macro to interact with <application moreinfo="none">TrEd</application>. 
	All other ways of creeping into <application moreinfo="none">TrEd</application>'s
	internals are dangerous and should be avoided.
      </para>
      <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="tred_def.xml" xpointer="xpointer(/article/section/section)"/>
    </section>
    <section id="hooks">
      <title>Hooks: automatically executed macros</title>
      <para>
	There is a special set of macros that was not
	mentioned yet. These macros, called hooks, are automatically
	executed by <application moreinfo="none">TrEd</application> on certain
	occasions. By defining such macros a little more of the
	<application moreinfo="none">TrEd</application>'s implicit behaviour may be
	influenced, for example the execution of a planned action may
	be aborted.
      </para>
      <warning>
	<para>Writing hooks correctly is a little bit more difficult than
	  writing simple macros. An incorrectly written hook may result
	  in errorneous behavior of <application moreinfo="none">TrEd</application>,
	  which in some cases may even lead to a crash. When in doubt
	  about where exactly is a particular hook called, with what parameters
	  and what it is expected to do, it is best to peek directly
	  into <filename moreinfo="none">tred</filename> or <filename moreinfo="none">btred</filename>
	  sources. The possibility of doing so is one of the nice
	  advantages of dealing with free software - in the Richard Stallman's
	  sense - the joy of which I feel obliged not to deprive you of.
	</para>
      </warning>
      <para>
	Hooks differ from other macros in the following aspects:
	<orderedlist continuation="restarts" inheritnum="ignore">
	  <listitem>
	    <para>User cannot choose a name for a hook; on the
	      contrary, hook is recognized as a macro having a
	      special name identifying it as being a certain hook.
	    </para>
	  </listitem>
	  <listitem>
	    <para>Sometimes parameters are passed to hooks.</para>
	  </listitem>
	  <listitem>
	    <para>No modifications of the tree or current node
	      are reflected after the hook returns, i.e. the tree is not
	      redrawn, changes to <literal moreinfo="none">$this</literal> variable
	      are not reflected. If necessary, a hook must provide this
	      functionality itself.
	    </para>
	  </listitem>
	  <listitem>
	    <para>
	      Unlike macros, hooks are not expected to modify
	      the tree unless they explicitly state that, typically
	      by calling 
	      <literal moreinfo="none">ChangingFile(1)</literal>.
	    </para>
	  </listitem>
	</orderedlist>
      </para>
      <para>
	There is a special class of hooks that may be used to prevent
	<application moreinfo="none">TrEd</application> from finishing a planned
	action, e.g. enabling the user to modify certain attribute
	value etc. The value returned by a hook of this class is checked and
	the action is aborted in case the value equals to
	<quote><literal moreinfo="none">stop</literal></quote>.
      </para>
      <para>In the following table the hooks which may be used to
	prevent <application moreinfo="none">TrEd</application> from executing a
	certain action are marked by <literal moreinfo="none">yes</literal> in the
	column <quote>Stop</quote>.
      </para>
      <table>
	<title>Hooks</title>
	<tgroup cols="3">
	  <colspec colnum="1" align="left"/>
	  <colspec colnum="2" align="center"/>
	  <colspec colnum="3" align="justify"/>
	  <thead>
	    <row>
	      <entry>Name</entry>
	      <entry>Stop</entry>
	      <entry>Hook event description</entry>
	    </row>
	  </thead>
	  <tbody>
	    <row id="start_hook">
	      <entry><literal moreinfo="none">start_hook</literal></entry>
	      <entry>yes</entry>
	      <entry><para>Executed on start-up, before the main event loop
		is entered.</para></entry>
	    </row>
	    <row id="init_hook">
	      <entry><literal moreinfo="none">init_hook</literal></entry>
	      <entry>yes</entry>
	      <entry><para>Executed on start-up, before the first file specified on
		the command-line is opened (i.e. also before the <literal moreinfo="none">start_hook</literal>).</para></entry>
	    </row>
	    <row id="exit_hook">
	      <entry><literal moreinfo="none">exit_hook</literal></entry>
	      <entry>no</entry>
	      <entry><para>Executed when the main window
		of <application moreinfo="none">TrEd</application> is destroyed,
		before the user is prompted to save the modified files.
	      </para></entry>
	    </row>
	    <row id="event_hook">
	      <entry><literal moreinfo="none">event_hook</literal></entry>
	      <entry>yes</entry>
	      <entry><para>Arguments: <literal role="params" moreinfo="none"><replaceable>Tk-XEvent</replaceable>,<replaceable>Tk-win</replaceable>,<replaceable>shortcuts...</replaceable></literal></para><para>This is a very low-level hook, executed when a non-predefined keyboard shortcut
		was issued. It can be used to block certain keyboard events
		(in which case it should return <literal moreinfo="none">stop</literal>) or 
		to provide <quote>on-the-fly</quote> bindings (by returning
		the name of a macro to be executed).
		The first argument is an Tk::XEvent object which can be used to
		obtain a detailed information of the event. The second argument
		is a Tk::Widget that caught the event and the rest of the
		arguments are keyboard-binding shortcuts computed from the event
		(these are the shortcuts that TrEd would try to look up in the current context
		bindings if this hook returns no macro name).
	      </para></entry>
	    </row>
	    <row id="do_edit_node_hook">
	      <entry><literal moreinfo="none">do_edit_node_hook</literal></entry>
	      <entry>yes</entry>
	      <entry><para>Arguments: <literal role="params" moreinfo="none"><replaceable>node</replaceable></literal></para><para>Executed before the <guilabel moreinfo="none">Edit Node</guilabel>
		dialog is displayed, i.e. when the user
		double-clicks a node, presses <keysym>Enter</keysym> in the
		main window or issues <menuchoice moreinfo="none">
		  <guimenu moreinfo="none">Node</guimenu>
		  <guimenuitem moreinfo="none">Edit Node ...</guimenuitem></menuchoice>.
		If the hook returns <literal moreinfo="none">stop</literal>, the dialog is suppressed.
	      </para></entry>
	    </row>
	    <row id="enable_edit_node_hook">
	      <entry><literal moreinfo="none">enable_edit_node_hook</literal></entry>
	      <entry>yes</entry>
	      <entry><para>Arguments: <literal role="params" moreinfo="none"><replaceable>node</replaceable></literal></para><para>Executed before the <guilabel moreinfo="none">Edit Node</guilabel>
		dialog is displayed, i.e. when the user
		double-clicks a node, presses <keysym>Enter</keysym> in the
		main window or issues <menuchoice moreinfo="none">
		  <guimenu moreinfo="none">Node</guimenu>
		  <guimenuitem moreinfo="none">Edit Node ...</guimenuitem></menuchoice>, but
		after <literal moreinfo="none">do_edit_node_hook</literal> was called (and
		only if it didn't return <literal moreinfo="none">stop</literal>). 
		If this hook returns <literal moreinfo="none">stop</literal>, the dialog is
		displayed, but only with a <guibutton moreinfo="none">Cancel</guibutton>
		button, i.e. making it impossible to confirm and save the edits.
	      </para></entry>
	    </row>
	    <row id="do_edit_attr_hook">
	      <entry><literal moreinfo="none">do_edit_attr_hook</literal></entry>
	      <entry>yes</entry>
	      <entry><para>Arguments: <literal role="params" moreinfo="none"><replaceable>attr</replaceable>,<replaceable>node</replaceable></literal></para><para>
		Executed before a dialog window for editing an
		attribute value is displayed (usually when the 
		user double-clicks the displayed attribute value).
		If <literal moreinfo="none">stop</literal> is returned,
		the dialog is suppressed.
	      </para></entry>
	    </row>
	    <row id="enable_attr_hook">
	      <entry><literal moreinfo="none">enable_attr_hook</literal></entry>
	      <entry>yes</entry>
	      <entry><para>Arguments: <literal role="params" moreinfo="none"><replaceable>attr</replaceable>,<replaceable>type</replaceable></literal></para><para>
		Executed before any text field for an attribute value
		modification or list of possible values
		is created. If the hook returns
		<quote><literal moreinfo="none">stop</literal></quote>,
		the field or list is made read-only. The
		<replaceable>type</replaceable>
		argument may have one of the following values:
		<literal moreinfo="none">ambiguous</literal> (in case
		of multiple values or an attribute with
		a given list of possible values) or
		<literal moreinfo="none">normal</literal>.
		If this hook returns <literal moreinfo="none">stop</literal>, the 
		corresponding edit fields in a displayed dialog are
		disabled (read-only) and if the dialog only displays
		the particular attribute, then the confirmation 
		<guibutton moreinfo="none">OK</guibutton> button is removed from it.
	      </para></entry>
	    </row>
	    <row id="goto_file_hook">
	      <entry><literal moreinfo="none">goto_file_hook</literal></entry>
	      <entry>yes</entry>
	      <entry><para>
		Executed before the next or previous file in the current
		file-list is opened.
	      </para></entry>
	    </row>
	    <!-- row>
	      <entry>goto_tree_hook</entry>
	      <entry>yes</entry>
	      <entry>
		Executed before a different tree is displayed.
	      </entry>
	    </row -->
	    <row id="file_opened_hook">
	      <entry><literal moreinfo="none">file_opened_hook</literal></entry>
	      <entry>no</entry>
	      <entry><para>Executed after a file is opened but before the first
		tree is displayed.
	      </para></entry>
	    </row>
	    <row id="preload_hook">
	      <entry><literal moreinfo="none">preload_hook</literal></entry>
	      <entry>yes</entry>
	      <entry><para>Only used by <application moreinfo="none">btred</application>.
		Executed before a file is preloaded.
	      </para></entry>
	    </row>
	    <row id="file_resumed_hook">
	      <entry><literal moreinfo="none">file_resumed_hook</literal></entry>
	      <entry>no</entry>
	      <entry><para>Executed after an already open (kept) file is resumed.</para></entry>
	    </row>
	    <row id="file_save_hook">
	      <entry><literal moreinfo="none">file_save_hook</literal></entry>
	      <entry>yes</entry>
	      <entry><para>Arguments: <literal role="params" moreinfo="none"><replaceable>output_filename</replaceable></literal></para><para>Executed before TrEd attempts to save a file.</para></entry>
	    </row>
	    <row id="file_close_hook">
	      <entry><literal moreinfo="none">file_close_hook</literal></entry>
	      <entry>no</entry>
	      <entry><para>Executed before TrEd attempts to close a file
		(this hook is called even if the file remains open
		but postponed if the close fails e.g. because
		the file being closed is required by another open file).</para></entry>
	    </row>
	    <row id="file_autosave_hook">
	      <entry><literal moreinfo="none">file_autosave_hook</literal></entry>
	      <entry>yes</entry>
	      <entry><para>Arguments: <literal role="params" moreinfo="none"><replaceable>fsfile</replaceable></literal></para><para>Executed before TrEd attempts to create an auto-save file
		for the given<replaceable>fsfile</replaceable>. Note that
		this is not necessarily the file displayed in the
		active view and accessible via the <literal moreinfo="none">$grp</literal> variable.
	      </para></entry>
	    </row>
	    <row id="get_backends_hook">
	      <entry><literal moreinfo="none">get_backends_hook</literal></entry>
	      <entry>no</entry>
	      <entry><para>Arguments: <literal role="params" moreinfo="none"><replaceable>backends...</replaceable></literal></para><para>Executed before a new file is opened. It receives a list 
		of available I/O backends known by TrEd as arguments. It should
		return a new array-ref consisting of backends that TrEd
		should actually try to use. This may be used both to
		add custom backends to the list or to prevent some
		standard backends from being used (by omitting them in the
		returned array-ref).
	      </para></entry>
	    </row>
	    <row id="allow_switch_context_hook">
	      <entry><literal moreinfo="none">allow_switch_context_hook</literal></entry>
	      <entry>yes</entry>
	      <entry><para>Arguments: <literal role="params" moreinfo="none"><replaceable>previous</replaceable>,<replaceable>next</replaceable></literal></para><para>Executed in the new context, but before the macro 
		context is actually changed (see <xref linkend="contexts"/>)
		and before <literal moreinfo="none">pre_switch_context_hook</literal>
		is called (in the old-context).
		The <replaceable>previous</replaceable> argument
		contains the name of the current context while
		<replaceable>next</replaceable> contains the name of the
		target context.
	      </para></entry>
	    </row>
	    <row id="pre_switch_context_hook">
	      <entry><literal moreinfo="none">pre_switch_context_hook</literal></entry>
	      <entry>yes</entry>
	      <entry><para>Arguments: <literal role="params" moreinfo="none"><replaceable>previous</replaceable>,<replaceable>next</replaceable></literal></para><para>Executed in the old context before the macro 
		context is changed (see <xref linkend="contexts"/>).
		The <replaceable>previous</replaceable> argument
		contains the name of the
		current context while
		<replaceable>next</replaceable> contains the name of the
		target context.
	      </para></entry>
	    </row>
	    <row id="switch_context_hook">
	      <entry><literal moreinfo="none">switch_context_hook</literal></entry>
	      <entry>no</entry>
	      <entry><para>Arguments: <literal role="params" moreinfo="none"><replaceable>previous</replaceable>,<replaceable>current</replaceable></literal></para><para>Executed just after a context is changed (see <xref linkend="contexts"/>).
		The <replaceable>previous</replaceable> argument
		contains the name of the previous context while
		<replaceable>next</replaceable> contains the name of the
		new current context.
	      </para></entry>
	    </row>
	    <row id="pre_switch_stylesheet_hook">
	      <entry><literal moreinfo="none">pre_switch_stylesheet_hook</literal></entry>
	      <entry>yes</entry>
	      <entry><para>Arguments: <literal role="params" moreinfo="none"><replaceable>previous</replaceable>,<replaceable>next</replaceable></literal></para><para>Executed when user attempts to switch the current
		stylesheet from <replaceable>previous</replaceable> to
		<literal moreinfo="none">next</literal>.
	      </para></entry>
	    </row>
	    <row id="switch_stylesheet_hook">
	      <entry><literal moreinfo="none">switch_stylesheet_hook</literal></entry>
	      <entry>no</entry>
	      <entry><para>Arguments: <literal role="params" moreinfo="none"><replaceable>previous</replaceable>,<replaceable>current</replaceable></literal></para><para>Executed after switching stylesheets.
		The fist argument is the previous stylesheet.
		The second argument is the newly selected current stylesheet.
	      </para></entry>
	    </row>
	    <row id="about_file_hook">
	      <entry><literal moreinfo="none">about_file_hook</literal></entry>
	      <entry>no</entry>
	      <entry><para>Arguments: <literal role="params" moreinfo="none"><replaceable>stringref</replaceable></literal></para><para>This hook is executed before the
		<guilabel moreinfo="none">About</guilabel> window is displayed.
		The hook takes one argument: a reference to a scalar
		variable. The hook may populate the referenced
		variable with any information which is then displayed
		as a part of the <guilabel moreinfo="none">About</guilabel> window message.
	      </para></entry>
	    </row>
	    <row id="customize_attrs_hook">
	      <entry><literal moreinfo="none">customize_attrs_hook</literal></entry>
	      <entry>yes</entry>
	      <entry><para>Executed before the dialog for customizing attribute
		patterns is displayed.
	      </para></entry>
	    </row>
	    <row id="sort_attrs_hook">
	      <entry><literal moreinfo="none">sort_attrs_hook</literal></entry>
	      <entry>no</entry>
	      <entry><para>Arguments: <literal role="params" moreinfo="none"><replaceable>attibsref</replaceable></literal></para><para>Executed when attribute names are pre-sorted
		(see <literal moreinfo="none">SortAttributes</literal>
		configuration options). The
		<replaceable>attribsref</replaceable>
		parameter passed to the hook is a reference pointing
		to a list variable. The list is populated with all
		attribute names and the hook may modify the list by
		changing the order of its elements
		or by removing certain elements from the list.
		If then non-zero value is returned by the hook,
		the (possibly modified) list is used for displaying purposes 
		without any further sorting.
	      </para></entry>
	    </row>
	    <row id="after_edit_node_hook">
	      <entry><literal moreinfo="none">after_edit_node_hook</literal></entry>
	      <entry>no</entry>
	      <entry><para>Arguments: <literal role="params" moreinfo="none"><replaceable>node</replaceable>,<replaceable>result</replaceable></literal></para><para>Executed after a node's attribute values were edited
		in the <guilabel moreinfo="none">Edit Node ...</guilabel>
		dialog window. The <replaceable>result</replaceable>
		argument contains <literal moreinfo="none">1</literal> if the user pressed
		<guibutton moreinfo="none">Ok</guibutton> button to close the dialog,
		and it contains <literal moreinfo="none">0</literal> if the user
		closed the dialog with the
	      <guibutton moreinfo="none">Close</guibutton> button.
	      </para></entry> 
	    </row>
	    <row id="after_edit_attr_hook">
	      <entry><literal moreinfo="none">after_edit_attr_hook</literal></entry>
	      <entry>no</entry>
	      <entry><para>Executed after a node's attribute was edited
		in the <guilabel moreinfo="none">Edit Attribute</guilabel>
		dialog window. The <replaceable>result</replaceable>
		argument contains <literal moreinfo="none">1</literal> if the user pressed
		<guibutton moreinfo="none">Ok</guibutton> button to close the dialog,
		and it contains <literal moreinfo="none">0</literal> if the user
		closed the dialog with the
	      <guibutton moreinfo="none">Close</guibutton> button.
	      </para></entry> 
	    </row>
	    <row id="get_value_line_hook">
	      <entry><literal moreinfo="none">get_value_line_hook</literal></entry>
	      <entry>no</entry>
	      <entry><para>Arguments: <literal role="params" moreinfo="none"><replaceable>fsfile</replaceable>,<replaceable>treeNo</replaceable></literal></para><para>Supply custom value-line content based on given
		<replaceable>fsfile</replaceable> and
		<replaceable>treeNo</replaceable>.
		The value returned from the hook may be either 
		a string to appear in the value line on the top
		of TrEd's main window or an array reference
		consisting of a list of array references
		representing individual nodes. In the later case,
		the array references representing individual nodes
		must be of the form
		<literal moreinfo="none">[<replaceable>text</replaceable>,
		  <replaceable>node</replaceable>,<replaceable>options...</replaceable>]</literal>
		where <replaceable>text</replaceable> is a text
		to appear on the value-line,
		<replaceable>node</replaceable>
		is the node represented by the array reference
		and <literal moreinfo="none">options</literal> is arbitrary set 
		of strings. If these strings are of the form
		<literal moreinfo="none">-option =&gt; value</literal>
		where <literal moreinfo="none">option</literal> is
		one of <literal moreinfo="none">foreground</literal>,
		<literal moreinfo="none">background</literal>,
		<literal moreinfo="none">underline</literal>,
		they are used to alter visual appearance
		of the corresponding part of the text displayed on the
		value-line. All other strings are ignored.
	      </para></entry>
	    </row>
	    <row id="highlight_value_line_tag_hook">
	      <entry><literal moreinfo="none">highlight_value_line_tag_hook</literal></entry>
	      <entry>no</entry>
	      <entry><para>Invoked every time a node is selected. The hook should
		return a tag associated with some text in the value
		line. The text is then highlighted in the value line.</para></entry>
	    </row>
	    <row id="get_nodelist_hook">
	      <entry><literal moreinfo="none">get_nodelist_hook</literal></entry>
	      <entry>no</entry> <entry><para>Arguments: <literal role="params" moreinfo="none"><replaceable>fsfile</replaceable>,<replaceable>treeNo</replaceable>,<replaceable>show_hidden</replaceable></literal></para><para>This hook may be used to supply
	      custom node ordering given a fsfile, treeNo and hidden
	      node visibility state.  If used, it should return a
	      two-element array reference with the first element being
	      a array reference to a list of nodes to be displayed (in
	      a left-to-right order) and the second element being a
	      node to be set up as the initial active node.
	      </para></entry>
	    </row>
	    <row id="node_release_hook">
	      <entry><literal moreinfo="none">node_release_hook</literal></entry>
		<entry>yes</entry> <entry><para>Arguments: <literal role="params" moreinfo="none"><replaceable>node</replaceable>,<replaceable>target-node</replaceable>,<replaceable>mod</replaceable></literal></para><para>Called when a node is released
		over another node after a mouse
		drag. <replaceable>mod</replaceable> is a keyboard
		modifier string, such as <literal moreinfo="none">Control</literal>,
		<literal moreinfo="none">Shift</literal>,
		<literal moreinfo="none">Alt</literal> or
		<literal moreinfo="none">Meta</literal>.
		  It can also be empty.  If
		<literal moreinfo="none">mod</literal> is empty, the hook should
		either result 'stop', to disable rehanging
		<replaceable>node</replaceable> on
		<replaceable>target-node</replaceable> or 
		take no action. In all other cases, the hook may
		reorganize the tree in arbitrary way, but
		it should call <literal moreinfo="none">Redraw_FSFile_Tree()</literal>
		and set <literal moreinfo="none">$FileChanged=1</literal> if needed.
	      </para></entry>
	    </row>
	    <row id="node_doubleclick_hook">
	      <entry><literal moreinfo="none">node_doubleclick_hook</literal></entry>
		<entry>no</entry> 
	      <entry><para>Arguments: <literal role="params" moreinfo="none"><replaceable>node</replaceable>,<replaceable>mod</replaceable></literal></para><para>Called when a node is double-clicked
		  while a modifier key was pressed.
		  <replaceable>mod</replaceable> is a keyboard
		modifier string, such as <literal moreinfo="none">Control</literal>,
		<literal moreinfo="none">Shift</literal>,
		<literal moreinfo="none">Alt</literal> or
		<literal moreinfo="none">Meta</literal>.
		  The hook is responsible for calling
		<literal moreinfo="none">Redraw_FSFile_Tree()</literal> or
		similar default macro to redraw the tree as well as for 
		setting <literal moreinfo="none">$FileChanged=1</literal> if needed.
	      </para></entry>
	    </row>
	    <row id="text_doubleclick_hook">
	      <entry><literal moreinfo="none">text_doubleclick_hook</literal></entry>
		<entry>no</entry> 
	      <entry><para>Arguments: <literal role="params" moreinfo="none"><replaceable>node</replaceable>,<replaceable>attr</replaceable>,<replaceable>mod</replaceable></literal></para><para>Called when an attribute in a displayed
		  node or edge label is double-clicked
		  while a modifier key was pressed.
		  <replaceable>mod</replaceable> is a keyboard
		modifier string, such as <literal moreinfo="none">Control</literal>,
		<literal moreinfo="none">Shift</literal>,
		<literal moreinfo="none">Alt</literal> or
		<literal moreinfo="none">Meta</literal>.
		  <replaceable>node</replaceable> is the  FSNode object
		  whose attribute was clicked.
		  <replaceable>attr</replaceable> is name of the
		  attribute which was clicked.
		  The hook is responsible for calling
		<literal moreinfo="none">Redraw_FSFile_Tree()</literal> or
		similar default macro to redraw the tree as well as for 
		setting <literal moreinfo="none">$FileChanged=1</literal> if needed.
	      </para></entry>
	    </row>
	    <row id="node_moved_hook">
	      <entry><literal moreinfo="none">node_moved_hook</literal></entry>
	      <entry>no</entry>
	      <entry><para>Arguments: <literal role="params" moreinfo="none"><replaceable>node</replaceable>,<replaceable>old-parent)</replaceable></literal></para><para>called after a node is moved using a mouse</para></entry>
	    </row>
	    <row id="current_node_change_hook">
	      <entry><literal moreinfo="none">current_node_change_hook</literal></entry>
	      <entry>no</entry>
	      <entry><para>Arguments: <literal role="params" moreinfo="none"><replaceable>current_node</replaceable>,<replaceable>prev_current_node</replaceable></literal></para><para>executed when a new active node is selected.</para></entry>
	    </row>
	    <row id="get_status_line_hook">
	      <entry><literal>get_status_line_hook</literal></entry>
	      <entry>no</entry>
	      <entry><para>Supply status-line content.
		This hook is responsible for providing the content for
		a status-line. The value returned from 
		<literal moreinfo="none">get_status_line_hook</literal> should
		have the form 
		<literal moreinfo="none">[<replaceable>field-definitions</replaceable>,
		  <replaceable>style-definitions</replaceable>,
		  ]</literal>.
		<replaceable>field-definitions</replaceable>
		is an array reference of the form
		<literal moreinfo="none">[<replaceable>text1</replaceable>,<replaceable>tags1</replaceable>,
		  <replaceable>text2</replaceable>,<replaceable>tags2</replaceable>,...
		  ]</literal> specifying
		one or more pieces of textual content of the
		status-line. Each piece of text is followed
		by another array reference, containing a list of
		<literal moreinfo="none">tags</literal> associated with the text.
		Tags may be arbitrary strings.
		<replaceable>style-definitions</replaceable> is 
		an array reference which can map some tags
		to visual appearance attributes. It has a form
		<literal moreinfo="none">[<replaceable>tag1</replaceable>,
		  [<replaceable>option =&gt; value</replaceable>,
	      <replaceable>option =&gt; value</replaceable>, ...],
		  <replaceable>tag2</replaceable>,
		  [<replaceable>option =&gt; value</replaceable>,
		  <replaceable>option =&gt; value</replaceable>, ...], ...
		  ]</literal>
		where <replaceable>option</replaceable> may
		be one of <literal moreinfo="none">-foreground</literal>,
		<literal moreinfo="none">-background</literal> and <literal moreinfo="none">-underline</literal>.
	      </para></entry>
	    </row>
	    <row id="value_line_doubleclick_hook">
	      <entry><literal moreinfo="none">value_line_doubleclick_hook</literal></entry>
	      <entry>no</entry>
	      <entry><para>Arguments: <literal role="params" moreinfo="none"><replaceable>tags...</replaceable></literal></para><para>Called when the user double-clicks the text
		in the value-line, i.e. text field displayed above the tree.
		Arguments are the tags associated with
		the clicked part of the text. Tag may be arbitrary
		strings associated with the text in the
		<literal moreinfo="none">value_line_hook</literal> or
		a serialized form of a node reference
		if the text is associated with a particular node.
		(More specifically,
		the Perl expression <literal moreinfo="none">$tag eq $node</literal> is
		true for one of the tags and the corresponding node,
		where <literal moreinfo="none">$tag</literal> is a simple scalar, i.e. astring.
		Hence, if necessary, the macro has to iterated through the tree
		in order to find the corresponding node.)
	      </para></entry>
	    </row>
	    <row id="status_line_doubleclick_hook">
	      <entry><literal moreinfo="none">status_line_doubleclick_hook</literal></entry>
	      <entry>no</entry>
	      <entry><para>Arguments: <literal role="params" moreinfo="none"><replaceable>tags...</replaceable></literal></para><para>Called when the user double-clicks the status-line.
		Arguments are the tags associated with
		the clicked field (see above). Tag may be arbitrary
		strings and it is up to user's will to
		set up some useful convention for tagging text of
		the status-line.
	      </para></entry>
	    </row>
	    <row id="status_line_click_hook">
	      <entry><literal moreinfo="none">status_line_click_hook</literal></entry>
	      <entry>no</entry>
	      <entry><para>Arguments: <literal role="params" moreinfo="none"><replaceable>tags...</replaceable></literal></para><para>Called when the user clicks the status-line
		with the same arguments as
		<literal moreinfo="none">status_line_doubleclick_hook</literal>
		above.
	      </para></entry>
	    </row>

	    <row id="reload_macros_hook">
	      <entry><literal moreinfo="none">reload_macros_hook</literal></entry>
	      <entry>no</entry>
	      <entry><para>Executed before macros are re-loaded
		(i.e. when the user issues <menuchoice moreinfo="none">
		  <guimenu moreinfo="none">Help</guimenu>
		  <guimenuitem moreinfo="none">Reload macros</guimenuitem>
		</menuchoice>).
		This macro may be used to do clean-up (e.g. cleanly deallocate
		non-perl resources, break circular dependences, etc.) before TrEd sweeps away
		the memory and code currently occupied and used by macros.</para></entry>
	    </row>
	    <row id="macros_reloaded_hook">
	      <entry><literal moreinfo="none">macros_reloaded_hook</literal></entry>
	      <entry>no</entry>
	      <entry><para>Executed after macros has been re-loaded
		(i.e. after the user issued <menuchoice moreinfo="none">
		  <guimenu moreinfo="none">Help</guimenu>
		  <guimenuitem moreinfo="none">Reload macros</guimenuitem>
		</menuchoice>). At the moment of the call to this hook,
		the newly loaded macros are already in effect.
	      </para></entry>
	    </row>
	    <row id="node_click_hook">
	      <entry><literal moreinfo="none">node_click_hook</literal></entry>
	      <entry>no</entry>
	      <entry><para>Arguments: <literal role="params" moreinfo="none"><replaceable>node</replaceable>,<replaceable>modifier</replaceable>,<replaceable>Tk-Event</replaceable></literal></para><para>Executed when the user clicks on a node
		with a mouse button while holding a keyboard modifier
		(one of <keycap moreinfo="none">Shift</keycap>, <keycap moreinfo="none">Control</keycap>,
		<keycap moreinfo="none">Alt</keycap>, <keycap moreinfo="none">Meta</keycap>).
		The first argument is a node the user clicked on.
		The second argument is the keyboard modifier
		to which the suffix <literal moreinfo="none">-2</literal> or
		<literal moreinfo="none">-3</literal> has been appended 
		if the user pressed mouse button <mousebutton moreinfo="none">2</mousebutton>
		or <mousebutton moreinfo="none">3</mousebutton> respectivelly.
		The third argument is the raw Tk-XEvent object
		which can be used to obtain detailed information
		(such as coordinates) of the event.
	      </para></entry>
	    </row>
	    <row id="node_motion_hook">
	      <entry><literal moreinfo="none">node_motion_hook</literal></entry>
	      <entry>no</entry>
	      <entry><para>Arguments: <literal role="params" moreinfo="none"><replaceable>node</replaceable>,<replaceable>modifier</replaceable>,<replaceable>Tk-Event</replaceable></literal></para><para>Executed repeatedly while the user drags 
		a node while holding a keyboard modifier.
		Arguments passed to this hook
		are same as for the <literal moreinfo="none">node_click_hook</literal>.
	      </para></entry>
	    </row>
	    <row id="text_click_hook">
	      <entry><literal moreinfo="none">text_click_hook</literal></entry>
	      <entry>no</entry>
	      <entry><para>Arguments: <literal role="params" moreinfo="none"><replaceable>node</replaceable>,<replaceable>attribute</replaceable>,<replaceable>modifier</replaceable>,<replaceable>Tk-Event</replaceable></literal></para><para>Executed when the user double-clicks on
		a node label linked to a particular node attribute.
		The <replaceable>modifier</replaceable> and 
		<replaceable>Tk-Event</replaceable> arguments are 
		as described in <literal moreinfo="none">node_click_hook</literal> above.
	      </para></entry>
	    </row>
	    <row id="node_style_hook">
	      <entry><literal moreinfo="none">node_style_hook</literal></entry>
	      <entry>no</entry>
	      <entry><para>Arguments: <literal role="params" moreinfo="none"><replaceable>node</replaceable>,<replaceable>syles</replaceable></literal></para><para>This hook is called for every node of a tree every time
		the tree is being drawn. It may be used to provide
		additional styling information on top of
		the information provided by a current stylesheet.
		The first argument is the particular
		node. The second argument is a hash-reference containing
		current styling information provided by defaults 
		and the current stylesheet.
		It consists of key - value pairs, where key is 
		a styled object
		(<literal moreinfo="none">Node</literal>,<literal moreinfo="none">NodeLabel</literal>,
		<literal moreinfo="none">EdgeLabel</literal>, <literal moreinfo="none">Oval</literal>,
		<literal moreinfo="none">Line</literal>, <literal moreinfo="none">Text</literal>,
		<literal moreinfo="none">TextBg</literal>, <literal moreinfo="none">TextBox</literal>)
		and values are array-references consisting
		of feature - value pairs for these objects.
		The hook may alter this hash-reference and thus
		the styling of the particular node. It is recommended
		to take the advantage of the <literal moreinfo="none">AddStyle</literal>
		default macro when altering the content of the
		<replaceable>styles</replaceable> hash-ref.
	      </para></entry>
	    </row>
	    <row id="root_style_hook">
	      <entry><literal moreinfo="none">root_style_hook</literal></entry>
	      <entry>no</entry>
	      <entry><para>Arguments: <literal role="params" moreinfo="none"><replaceable>root-node</replaceable>,<replaceable>syles</replaceable></literal></para><para>This hook is executed once every time
		the tree is being drawn before
		the content of a currently selected stylesheet
		is applied and before <literal moreinfo="none">node_style_hook</literal>
		is called. The first argument is the root-node of
		the tree and <replaceable>styles</replaceable> are
		as in <literal moreinfo="none">node_style_hook</literal> above.
	      </para></entry>
	    </row>
	    <row id="print_tree_filename_hook">
	      <entry><literal moreinfo="none">print_tree_filename_hook</literal></entry>
	      <entry>no</entry>
	      <entry><para>Executed when
		<menuchoice moreinfo="none">
		  <guimenu moreinfo="none">File</guimenu>
		  <guimenuitem moreinfo="none">Print ...</guimenuitem>
		</menuchoice>
		command is invoked in order to obtain a suggestion for
		the target file-name used when printing to file.
	      </para></entry>
	    </row>	    	    
	  </tbody>
	</tgroup>
      </table>
    </section>
    <section id="contexts">
      <title>Using different sets of macros in different situations</title>
      <subtitle>Name-spaces, contexts and binding contexts</subtitle>
      <para>
	<application moreinfo="none">TrEd</application> adopts mechanisms similar
	e.g. to <application moreinfo="none">Emacs</application> major-modes which
	allow the user to safely create several sets of macros with possibly
	coliding key and menu bindings as well as macro names.
	These mechanisms are called <emphasis>contexts</emphasis>, or
	more specifically: name-spaces and binding contexts.
      </para>
      <para>
	To prevent macros from colliding or modifying the internal
	<application moreinfo="none">TrEd</application> variables or functions the
	Perl concept of packages or namespaces is used.  Unless the
	Perl <literal moreinfo="none">package</literal> command is used, each macro
	belongs to a default package (or name-space) called
	<literal moreinfo="none">TredMacro</literal>.  Beside the user-defined macros,
	the pre-defined macros are defined within this package.
      </para>
      <para>
	New package named say <replaceable>MyPackage</replaceable>
	is created using the following command:
	<literallayout class="normal" format="linespecific">package <replaceable>MyPackage</replaceable>;</literallayout>
	To be able to call macros defined in the
	<literal moreinfo="none">TredMacro</literal> package (e.g. the pre-defined
	macros) without having to prefix their names with one of
	<literal moreinfo="none">TredMacro-&gt;</literal> or
	<literal moreinfo="none">TredMacro::</literal> prefixes the following command may
	be used to import the <literal moreinfo="none">TredMacro</literal> name-space
	to the current package's name-space:
	<literallayout class="normal" format="linespecific">import TredMacro;</literallayout>
	Now all the subsequent macro definitions (or global variable
	declarations)
	are created within
	the <replaceable>MyPackage</replaceable> name-space unless
	other <literal moreinfo="none">package</literal> command occurs. 
	Thus the following example defines a macro named
	<replaceable>my_macro</replaceable> in a new name-space
	of the <replaceable>MyPackage</replaceable> package:
      </para>
      <informalexample>
	<programlisting format="linespecific">
package MyPackage;
import TredMacro;

sub my_macro {
  # macro code comes here 
}
</programlisting>
      </informalexample>
      <para>
	To call the <replaceable>my_macro</replaceable>
	of the previous example	from a different package
	than <replaceable>MyPackage</replaceable>,  the full
	package name must be given together with the name of the
	macro:
	<programlisting format="linespecific">
MyPackage::my_macro();   # call to a macro defined in MyPackage
</programlisting>
      </para>
      <para>
	In the interactive work, name-spaces are combined with
	a concept of <emphasis>binding-contexts</emphasis>.
	Only one context can be	active in TrEd at a time. 
	The active context is displayed on and may be selected from a
	menu on the right end of the menu bar.
      </para>
      <para>
	Binding contexts usually correspond to the package names.
	Analogously to the <literal moreinfo="none">package</literal> command, a
	special directive exists for creating or switching a binding
	context, however in this case, more then one binding-contexts
	may be used at once:
	<literallayout class="normal" format="linespecific">#binding-context <replaceable>context_name_1</replaceable> <replaceable>context_name_2</replaceable> ...</literallayout>
	The default binding-context is again named
	<literal moreinfo="none">TredMacro</literal>. To switch to a new context,
	say <literal moreinfo="none">MyContext</literal>, the following directive
	should be used:
	<literallayout class="normal" format="linespecific">#binding-context MyContext</literallayout>
	Now, all the subsequent directives <literal moreinfo="none">#bind</literal>,
	<literal moreinfo="none">#insert</literal>, <literal moreinfo="none">#unbind-key</literal>,
	and <literal moreinfo="none">#remove-menu</literal>
	would apply to this context
	and all the bound macros, when invoked, will be first searched
	in the package named <literal moreinfo="none">MyContext</literal>.
      </para>
      <para>
	A binding context may import
	menu and keyboard bindings from other context(s) using
	<literallayout class="normal" format="linespecific">#key-binding-adopt <replaceable>other_context(s)</replaceable></literallayout>
	and
	<literallayout class="normal" format="linespecific">#menu-binding-adopt <replaceable>other_context(s)</replaceable></literallayout>
	directives.
      </para>
      <para>
	There is a separate submenu created for each binding-context
	in the <guimenuitem moreinfo="none">User-defined</guimenuitem> menu. 
	For contexts with a large number of menu bindings it
	is usually more comfortable to select a macro 
	using <menuchoice moreinfo="none">
	  <guimenuitem moreinfo="none">View</guimenuitem>
	  <guimenuitem moreinfo="none">List of Named Macros</guimenuitem>
	</menuchoice>.</para>
      <para> If a keyboard shortcut
	is pressed, <application moreinfo="none">TrEd</application> first searches for a
	macro bound to the shortcut within the active binding-context
	and if such macro exists, <application moreinfo="none">TrEd</application>
	invokes it. In this case, the macro is supposed to be defined
	or imported in a package of the same name as is the name of
	the active context. If no macro is
	bound to the shortcut within the active binding-context,
	<application moreinfo="none">TrEd</application> tries to find a binding in the
	default <literal moreinfo="none">TredMacro</literal> context. The macro
	is then supposed to be defined within the
	<literal moreinfo="none">TredMacro</literal> package.
	If the search
	fails, no action is taken. The same holds for hooks as well.
      </para>
      <para>The following example shows how to create a set of macros
	which enable <application moreinfo="none">TrEd</application> to automatically
	decide which context to use when a file is opened. It is
	quite similar to the <application moreinfo="none">Emacs</application> concept
	of <quote>auto-modes</quote>, except that content of the file
	is considered here, not the file-name extension. In the
	example, existence of a certain attribute is used
	to decide which context to use. The example is extracted form
	the set of macros written for the annotation of the
	<application moreinfo="none">Prague Dependency Treebank</application>.
	There are two contexts for annotation: for the
	<quote>Analytic</quote>
	and <quote>Tectogrammatic</quote> layers. The
	<quote>tectogrammatic</quote>
	trees may be easily distinguished from the
	<quote>analytical</quote> ones because (among others)
	a special attribute named <literal moreinfo="none">TR</literal> is defined for
	them.
      </para>
      <example>
	<title>Using contexts</title>
	<programlisting format="linespecific">
package TredMacro; # Ensure we are in the default package
                   # (This may not be necessary.)

# we use a hook to set the context
sub file_opened_hook {
  if ($grp-&gt;{FSFile}-&gt;FS-&gt;exists('TR')) {
    SwitchContext('Tectogrammatic'); 
  } else {
    SwitchContext('Analytic');
  }
}

#binding-context Analytic
package Analytic;
import TredMacro;


#bind SubtreeAfunAssign to Ctrl+Shift+F1
sub SubtreeAfunAssign {
   # automatic assignment of some analytical attributes
}

sub ReorderTree {
   # ...
}


# the following binding of ReorderTree will apply to both binding contexts

#binding-context Analytic Tectogrammatic
#bind ReorderTree to Ctrl+R

#binding-context Tectogrammatic
package Tectogrammatic;
import Analytic;   # all macros of the Analytic package (eg. ReorderTree) 
	           # will now be available here directly

#bind SubtreeAfunAssign to Ctrl+Shift+F1
sub SubtreeFuncAssign {
   # automatic assignment of some tectogrammatical attributes
}
</programlisting>
      </example>
    </section>
  </section>
  <section id="backends">
    <title>I/O backends</title>
    <para>This section briefly introduces the existing I/O backends
      and then provides a quick introduction to writing a custom backend.
    </para>
    <section id="iobackend">
      <title>IOBackend</title>
      <para>
	Actually, this is not a I/O backend per se. It is a base class
	underlying most of the other I/O backends. It provides a simple
	abstraction layer over some common low-level tasks, such as pipe-line redirection,
	gzip-compression, URL resolving, as well as fetching and
	uploading files using remote protocols. Due to this backend,
	<application>TrEd</application> transparently handles
	gzip-compression/de-compression of files with <filename>.gz</filename>
	extension as well as remote file transfer over
	<literal>ftp://</literal>,
	<literal>http://</literal>,
	<literal>ssh://</literal> and other protocols. Note however that availability
	of remote file transfer highly depends on a particular setup
	(currently only UNIX systems are fully supported) and may require
	some external tools, such as <link linkend="curl">curl</link>,
	<link linkend="kioclient">kioclient</link>,
	<link linkend="ssh">ssh</link>, 
	<link linkend="gzip">gzip</link>.
      </para>
    </section>
    <section id="fsbackend">
      <title>FSBackend</title>
      <para>
	FSBackends deals with a format called FS (feature structure). FS-format
	was the first format supported by tred, and for a long time also the only one.
	As a result, some of the Perl structures such as <literal>FSNode</literal>,
	<literal>FSFile</literal> used by <application>TrEd</application> as well as the underlying Perl library
	<filename>Fslib.pm</filename> itself bear its name (even though they
	are now equally used to represent data obtained from any other I/O
	backend).
      </para>
      <para>
	FS format provides a simple and effective way for storing trees.
	In this format, each node of the
	tree uses the same set of attributes declared in the FS-file header. 
	FS format supports string values,
	enumerated values and flat lists of these
	(i.e. strings consisting of a <literal>|</literal>-separated list of
	values of the first two types). There is no direct support
	for nested AVS structures, complex lists and alternatives.
      </para>
      <para>
	Recent versions of
	<application>TrEd</application> and <literal>Fslib</literal>
	provide a simple nested-AVS emulation
	(attiribute-value structure) for FS attribute values, meaning the
	following: an attribute whose name contains one
	or more slashes is represented as a (possibly nested) AVS structure where
	each slash represents one level of nesting. Attributes sharing a
	common name-part followed by a slash are thus represented as members of
	the same structure. For example, attirubtes <literal>a</literal>,
	<literal>b/u/x</literal>,
	<literal>b/v/x</literal> and
	<literal>b/v/y</literal> result in the following structure:
<literallayout>
{
  a => <replaceable>value-of-a</replaceable>,
  b => { u => { x => <replaceable>value-of-a/u/x</replaceable> },
         v => { x => <replaceable>value-of-a/v/x</replaceable>,
                y => <replaceable>value-of-a/v/y</replaceable> 
              }
       }

}
</literallayout>
	In case that attributes with names <literal>a</literal>
	<literal>a/b</literal> would both exists, the nested-AVS emulation is
	abandoned and all attributes are represented literally (i.e.
	with slashes in their names).
      </para>
      <note>
	<para>Even with the recently added nested-AVS emulation, FS format is not 
	  in general fully capable of capturing data originating in other backends
	  such as PML.
	</para>
      </note>
      <para>
	FS format is fully described in
	<ulink url="http://ufal.mff.cuni.cz/pdt/Corpora/PDT_1.0/Doc/fs.html">http://ufal.mff.cuni.cz/pdt/Corpora/PDT_1.0/Doc/fs.html</ulink>
      </para>
    </section>
    <section id="storablebackend">
      <title>StorableBackend</title>
      <para>This backend is based on an excelent Perl module
	<literal>Storable</literal>, which can store
	and retrieve almost arbitrary Perl structure in an instant. Because of its
	general	nature, this backend can save and keep intact files
	originating from any other backend. Due to its speed
	with which it saves and retrieves data, it is often
	useful to transfer all data temporarily into this format
	(e.g. using <command>btred</command>) and
	revert to the original format only after all work on the data is done.
      </para>
    </section>
    <section id="csts_sgml_sp_backend">
      <title>CSTS_SGML_SP_Backend</title>
      <para>This backend provides
	support for the CSTS format. CSTS stands for <quote>Czech
	sentence tree structure</quote>. Since it is an application of SGML,
	the backend requires an external sgml parser (namely
	<command><link linkend="sgmls">nsgmls</link></command>) and a
	document type definition (DTD)
	(<filename>csts.doctype</filename>).  This backend represents
	CSTS data as trees with a fixed set of attributes, specific to
	the purpose for which CSTS was created, namely morphological and
	syntactical annotation of Czech texts.
	CSTS has been the primary format of the Prague Dependency
	Treebank 1.0.

      </para>
    </section>
    <section id="ntredbackend">
      <title>NTREDBackend</title> <para>This backend used for
      exchanging of data between <application>TrEd</application> and
	btred servers, or in other words to <quote>peek</quote>
      into the memory of running btred servers.
      This backend only accepts filenames (or we should rather
      say URLs) starting with the <filename>ntred://</filename>
      protocol specification and followed by a real file name.  When
      this backend opens a file, it uses <command>ntred</command>
      client to fetch the file from any currently running btred
      server. If some btred server has a in-memory copy of
      the specified file (possibly edited during previous
      <command>ntred</command> requests), it sends this copy to the
      client and via <literal>NTREDBackend</literal> to
      <application>TrEd</application>. Saving is performed in a
	reversed way, i.e. <command>ntred</command> client
	is used to communicate the (possibly edited) file back
      to the btred server replaces its previous in-memory copy of the
      file with the file obtained in this way.
      </para>
      <para>
	Instead of requesting a whole file from the 
	servers, is also possible (and sometimes faster) to request
	only a single tree. This can be achieved by appending
	a suffix of the form
	<literal>@<replaceable>N</replaceable></literal> to the
	<literal>ntred://</literal> URL, where
	<replaceable>N</replaceable> is the number of the requested
	tree (counting from 1). In that case,
	<application>TrEd</application> obtains a file containing only
	the requested tree. So, such URL as
	<literal>ntred://<replaceable>filename</replaceable>@3##1.4</literal>,
	opens a file containing the 3rd tree in <replaceable>filename</replaceable> (as
	represented in memory of a btred server) and opens that
	file on the 4th node of its first and only tree. URLs of this
	form are produced by the <literal>TredMacro</literal> 
	function <literal>NPosition()</literal> (see <xref
	linkend="defaultmacros"/>).
      </para>
    </section>
    <section id="pmlbackend">
      <title>PMLBackend</title>
      <para>
	This backend provies partial support for a new 
	generic XML-based format called PML (the Prague Markup
	Language), used for capturing rich linguistic annotation.
	This format is the primary format of the Prague Dependency
	Treebank 2.0. Each application of PML is described using a
	special XML file called <firstterm>PML schema</firstterm>. 
	This schema file defines which elements and attributes
	construe the nodes and structure of the tree, 
	it defines value types of node attributes, etc.
      </para>
      <para>
	Updated version of the full PML specification can be found on the
	<ulink url="http://ufal.mff.cuni.cz/pml">PML project</ulink>
	page. Note however that PML is an on-going project, so consider
	it as <quote>work in progress</quote>.
      </para>
      <para>
	Because of the generic nature of PML, the
	<literal>PMLBackend</literal> of <application>TrEd</application>
	is restricted only to those applications of PML which satisfy the
	following criteria:
	<itemizedlist>
	  <listitem>
	    <para>there is exactly one PML sequence or PML element of
	      a list type with PML role <literal>#TREES</literal> and this element appears
	      under the root element.
	    </para>
	  </listitem>
	  <listitem>
	    <para>
	      If the entity with role <literal>#TREES</literal> is a
	      PML sequence, then all its members are elements with 
	      role <literal>#NODE</literal>. If it is a PML element
	      of a list type, then all members of the list
	      are PML structures with role <literal>#NODE</literal>.
	    </para>
	  </listitem>
	  <listitem>
	    <para>
	      Each PML element with role <literal>#NODE</literal> 
	      may contain a sequence of it's child elements.
	      This sequence must have PML role
	      <literal>#CHILDNODES</literal>.
	    </para>
	  </listitem>
	  <listitem>
	    <para>
	      Each PML structure with role <literal>#NODE</literal> 
	      may contain a member of a list type, which construes the list of child-nodes.
	      This member must have PML role <literal>#CHILDNODES</literal>.
	    </para>
	  </listitem>
	</itemizedlist>
      </para>
      <para>
	<application>TrEd</application> represents PML data types
	in a very natural way. PML structures are represented as AVS
	structures, PML lists as <literal>Fslib::List</literal>
	objects and PML alternatives as	<literal>Fslib::Alt</literal>
	objects. Other non-atomic PML types, such as PML elements,
	text data in mixed content, attributes, etc.,
	are represented as AVS with the following four special members:
	<literal>#type</literal> (type of the entity,
	e.g. <literal>element</literal>,
	<literal>text</literal>),
	<literal>#name</literal> (name of the entity)
	<literal>#ns</literal> (XML namespace),
	<literal>#content</literal> (content of the entity).
	Attributes of a PML element are represented as additional members
	of the AVS representing the element.
      </para>
      <para>
	If the PML schema declares a reference to an external resource
	and this declaration bears the attribute
	<literal>readas="dom"</literal>, then
	<literal>PMLBackend</literal>
	loads the corresponding resource for the PML instance
	as a DOM (Document Object Model) tree (using the Perl module
	<literal>XML::LibXML</literal>) and attaches this DOM tree
	to the application data section of the in-memory
	representation of the file.
      </para>
      <para>
	If the PML schema declares a reference to an external resource
	and this declaration bears the attribute
	<literal>readas="trees"</literal>, then
	<literal>PMLBackend</literal> passes the file-name 
	of the corresponding resource to
	<application>TrEd</application>
	and <application>TrEd</application> loads it as an ordinary
	file. This file can be edited and treated as any other file in
	<application>TrEd</application>. In <command>btred</command>,
	this file is opened as a so called
	<firstterm>secondary</firstterm> file, i.e. a file
	which is not implicitly processed by the macro specified by
	user, but as it is loaded in memory, the macro may explicitly
	choose to process it.
      </para>
      <para>
	<literal>PMLBackend</literal> also supports so-called <quote>knitting</quote>
	of PML instances, i.e. replacing certain type of PML
	references with the content of the referenced entities
	occurring in another PML instance.
	Conversely, when a PML instance on which this
	<quote>knitting</quote>
	has been applied, the (possible edited) content 
	replaces the content of the referenced entities
	in its original PML instance.
	Knitting only applies to:
	<orderedlist>
	  <listitem>
	    <para>
	members of PML structures containing a
	PML reference and having PML role <literal>#KNIT</literal>,
	</para>
	  </listitem>
	  <listitem>
	    <para>to members of PML structures containing a list with PML
	role <literal>#KNIT</literal>, with PML references as list
	members.
	    </para>
	  </listitem>
	</orderedlist>
	If such a member is encountered, then a possible trailing
	<literal>.rf</literal> part of its name is removed and its
	content (one or more PML references) is replaced with the
	corresponding entities in the referenced PML
	instance. It is required that all such PML references refer to
	resources specified in the PML schema as
	<literal>readas="dom"</literal>.
      </para>
    </section>
    <section id="trxmlbackend">
      <title>TrXMLBackend</title>
      <para>
	<literal>TrXMLBackend</literal> was intended as a XML
	replacement of the FS format. Unfortunatelly, never fully
	developed and thoroughly tested. This may still happen in the
	future but untill then, it is not recommended for serious
	work.
      </para>
    </section>
    <section id="teixmlbackend">
      <title>TEIXMLBackend</title>
      <para>
	This backend reads and stores trees represented in a specific
	subset of the TEI XML format. This format was (is?) used in
	the <ulink url="http://nl.ijs.si/sdt/">Slovene Treebank
	Project</ulink>.
      </para>
    </section>
    <section>
      <title>Writing a new I/O backend</title>
      <para>
	An I/O backend is a Perl module defining at least the
	following five subroutines (listed in the order in which they
	are typically called by <application>TrEd</application>):
      </para>
      <variablelist>
	<varlistentry>
	  <term><literal><function>test</function>(<replaceable>$filename</replaceable>,<replaceable>$encoding</replaceable>)</literal></term>
	  <listitem>
	    <para>
	      This function should only quickly peek in the given file
	      in order to determine if it is a file suitable by the
	      backend. If this function accepts the file by returns a
	      defined non-zero value (e.g. 1), then the file is
	      processed by this backend. If the file is not suitable
	      for the backend, this function must reject the file
	      by returning 0 or <literal>undef</literal>,
	      so that other backends in the list of backends could
	      try their luck.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><literal><function>open_backend</function>(<replaceable>$filename</replaceable>,<replaceable>$mode</replaceable>,<replaceable>$encoding</replaceable>)</literal></term>
	  <listitem>
	    <para>This function should open and return a filehandle for a given
	      file. If <replaceable>$mode</replaceable> is
	      <literal>r</literal>, then this filehandle should be
	      open for reading, if <replaceable>$mode</replaceable> is
	      <literal>w</literal>, it should be open for writing.
	      The third, <replaceable>$encoding</replaceable>, contains
	      the encoding specified by the user in the <link
	      linkend="defaultfileencoding">defaultFileEncoding</link>
	      configuration option. This information may be ignored if
	      the data format provides another way to determine the
	      encoding. Most backends do not re-implement this
	      function, but simply import (i.e. inherit) it from the
	      base class <classname>IOBackend</classname>.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><literal><function>read</function>(<replaceable>$filehandle</replaceable>,<replaceable>$fsfile</replaceable>)</literal></term>
	  <listitem>
	    <para>
	      This is the key function that implements converting data
	      from the specific data format to the corresponding
	      memory representation in <application>TrEd</application>.
	      This function obtains two arguments: the
	      <replaceable>$filehandle</replaceable> previously
	      obtained by a call to backend's <function>open_backend</function>, 
	      and an empty <classname>FSFile</classname> object (i.e.
	      with no trees). It is supposed to parse the data format,
	      build tree representation of the data (usually using
	      functions such as <literal>FSNode->new()</literal>,
	      and <literal><function>FSlib::Paste</function>(<replaceable>$child</replaceable>,<replaceable>$parent</replaceable>,<replaceable>$fsfile</replaceable>->FS)</literal>
	      and populate the <classname>FSFile</classname>
	      with the resulting trees (e.g. using its
	      <methodname>changeTrees</methodname> method).
	      It should also setup <classname>FSFormat</classname>
	      object associated with the
	      <replaceable>$fsfile</replaceable>
	      (<literal><replaceable>$fsfile</replaceable>->FS</literal>).
	      Any additional information related to the file (but not representable
	      as trees or <classname>FSFormat</classname>) may be attached to the file e.g. using 
	      <literal><replaceable>$fsfile</replaceable>-><methodname>changeMetaData(<replaceable>$key</replaceable>,<replaceable>$value</replaceable>)</methodname></literal>.
	    </para>
	  </listitem>
	</varlistentry>
	<varlistentry>
	  <term><literal><function>write</function>(<replaceable>$filehandle</replaceable>,<replaceable>$fsfile</replaceable>)</literal></term>
	  <listitem>
	    <para>
	      This function somewhat reverses the process of
	      <function>read</function>. By examining the
	      <classname>FSFile</classname> object
	      <replaceable>$fsfile</replaceable>
	      (especially its trees and meta data),
	      it should write the corresponding representation
	      in the specific data format to the given
	      <replaceable>$filehandle</replaceable>.
	    </para>
	  </listitem>
	</varlistentry>	    
	<varlistentry>
	  <term><literal><function>close_backend</function>(<replaceable>$filehandle</replaceable>)</literal></term>
	  <listitem>
	    <para>This function should close a given filehandle
	      created by a previous call to
	      <function>open_backend</function>.  It usually only
	      consists of applying a Perl function
	      <function>close</function> on the filehandle, but if
	      additional cleanup is necessary, it should be done here.
	      Most backends do not re-implement this function, but
	      simply import (i.e. inherit) it from the base class
	      <classname>IOBackend</classname>.
	    </para>
	  </listitem>
	</varlistentry>
      </variablelist>
      <para>
	There are several ways to make <application>TrEd</application>
	know about a user-defined I/O backend, namely:
	<itemizedlist>
	  <listitem>
	    <para>listing addtional backends in the <link linkend="iobackends">IOBackends</link> configuration option,</para>
	  </listitem>
	  <listitem>
	    <para>listing addtional backends after
	      <parameter>-B</parameter> on the command-line (see <xref
	      linkend="commandline"/></para>
	  </listitem>
	  <listitem>
	    <para>defining a 
	      <link linkend="get_backends_hook">get_backends_hook</link></para>
	  </listitem>
	</itemizedlist>
      </para>
    </section>
  </section>
</article>
<!-- Keep this comment at the end of the file
Local variables:
mode: xml
sgml-omittag:no
sgml-shorttag:yes
sgml-namecase-general:nil
sgml-general-insert-case:lower
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:2
sgml-indent-data:t
sgml-parent-document:nil
sgml-exposed-tags:nil
sgml-local-catalogs:("/home/pajas/lib/sgml-tools/dtd/catalog" "/home/pajas/lib/sgml/iso-entities-8879.1986/iso-entities.cat /home/pajas/share/sgml/dtd/docbook/3.1/docbook.cat /home/pajas/share/sgml/stylesheets/docbook/catalog /home/pajas/share/sgml/entities/iso-entities-8879.1986/iso-entities.cat /home/pajas/share/sgml/dtd/jade/dsssl.cat /home/pajas/share/sgml/stylesheets/sgmltools/sgmltools.cat /home/pajas/share/sgml/dtd/sgmltools/catalog")
sgml-local-ecat-files:nil
End:
-->
